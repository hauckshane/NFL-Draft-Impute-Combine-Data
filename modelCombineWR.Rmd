---
title: "WR Model Combine"
output: html_document
date: "2023-04-17"
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```

```{r}
library(tidyverse)
library(glmnet)
```

```{r}
fbref_offense <- read_csv("data/fbref_offense_clean.csv") %>% select(-c(1)) %>%
  mutate(AV = if_else(
    is.na(AV) & !is.na(drafted),
    0,
    AV
  ))
ESPNDraftRankings <- read_csv("data/ESPNDraftRankings_CLEAN.csv") %>% select(-c(1))
wrcollegestats <- read_csv("data/wrcollegestats.csv") %>%
  mutate(across(c(RushAtt:RushTD), ~if_else(is.na(.), 0, .))) %>%
  mutate(TotTD = RecTD + RushTD) %>%
  mutate(classnum = case_when(Class == 'FR' ~ 1,
                                    Class == 'SO' ~ 2, 
                                    Class == 'JR' ~ 3,
                                    Class == 'SR' ~ 4)) %>% 
  group_by(college_stats_link) %>%
  filter(classnum == max(classnum)) %>% 
  distinct(college_stats_link, .keep_all = TRUE) %>%
  ungroup() %>% select(-classnum) %>% na.omit()

fbref_WR <- fbref_offense %>% filter(position == "WR") %>% 
  mutate(player = iconv(player, from = "UTF-8", to = "ASCII//TRANSLIT")) %>%
  mutate(player = tolower(player)) %>%
  mutate(player = gsub("\\.", " ", player))
ESPN_WR <- ESPNDraftRankings %>% filter(POS == "WR") %>% mutate(Name = tolower(Name))

fbrefespn <- left_join(fbref_WR, ESPN_WR, by = c("player" = "Name", "year" = "YEAR")) %>%
  separate(height, into = c("feet", "inch"), sep = "-") %>%
  mutate(height = (as.numeric(feet) * 12) + as.numeric(inch)) %>% select(-feet, -inch) %>% select(c(1:6), height, c(7:25)) %>%
  rename(weight = wt) 

fbrefespnshort <- fbrefespn %>% select(year, player, position, age, AV, school, GRADE, `DRAFTED BY`, `PK(OVR)`, `OVR RANK`) %>%
  filter(!is.na(AV) & !is.na(age))
  
fbref_wrcomb <- left_join(fbref_WR, wrcollegestats, by = c("college_stats_link")) %>%
  separate(height, into = c("feet", "inch"), sep = "-") %>%
  mutate(height = (as.numeric(feet) * 12) + as.numeric(inch)) %>% select(-feet, -inch) %>% rename(weight = wt) %>%
  select(c(1:6), height, c(7:33))

wrs <- left_join(fbref_wrcomb, ESPN_WR, by = c("player" = "Name", "year" = "YEAR")) %>%
  separate(drafted, into = c("Drafted By", "Round", "Pick", "Year2"), sep = "/") %>%
  select(-Year2) %>% mutate(Round = parse_number(Round), Pick = parse_number(Pick)) %>% select(-'DRAFTED BY', -'PK(OVR)', -SCHOOL, -POS)
```


__Fill in Average__
```{r}
fbrefespn %>% summarise(across(c(forty, vertical, broad_jump, three_cone, shuttle), ~ mean(., na.rm = TRUE)))

fillin_average <- fbrefespn %>% mutate(across(c(forty, vertical, broad_jump, three_cone, shuttle), 
                                              ~if_else(is.na(.), mean(., na.rm = TRUE), .))) %>%
  select(year, player, position, AV, forty, vertical, broad_jump, three_cone, shuttle, drafted)
```



__Height, Weight, College Stats__
```{r}
combinecollege <- wrs %>% mutate(classnum = case_when(Class == 'FR' ~ 1,
                                    Class == 'SO' ~ 2, 
                                    Class == 'JR' ~ 3,
                                    Class == 'SR' ~ 4)) %>% 
  group_by(college_stats_link) %>%
  filter(classnum == max(classnum)) %>%
  ungroup() %>%
  select(player, height, weight, forty, vertical, broad_jump, three_cone, shuttle, Conf, c(21:36)) %>%
  mutate(ConfIndicator = as.factor(if_else(Conf == "ACC" | Conf == "Big Ten" |
                                           Conf == "Pac-12" | Conf == "Big 12" |
                                           Conf == "SEC", 1, 0 ))) %>%
  select(-Conf, -Class, -Pos, -FT) %>% distinct(player, .keep_all = TRUE)
```

# Predict forty
```{r}
hwcs_forty <- combinecollege %>% select(-c(vertical, broad_jump, three_cone, shuttle, player)) %>% na.omit()

hwcs_forty_x <- model.matrix(forty ~ ., hwcs_forty)[, -1]
hwcs_forty_y <- hwcs_forty$forty

set.seed(1)
hwcs_forty_train <- sample(1:nrow(hwcs_forty_x), nrow(hwcs_forty_x) / 2)
hwcs_forty_test <- (-hwcs_forty_train)
hwcs_forty_y.test <- hwcs_forty_y[hwcs_forty_test]

grid <- 10^seq(10, -2, length = 100)

hwcs_forty_lasso.mod <- glmnet(hwcs_forty_x[hwcs_forty_train, ], hwcs_forty_y[hwcs_forty_train], alpha = 1,
    lambda = grid)
plot(hwcs_forty_lasso.mod)

set.seed(1)
hwcs_forty_cv.out <- cv.glmnet(hwcs_forty_x[hwcs_forty_train, ], hwcs_forty_y[hwcs_forty_train], alpha = 1)
plot(hwcs_forty_cv.out)
hwcs_forty_bestlam <- hwcs_forty_cv.out$lambda.min
hwcs_forty_lasso.pred <- predict(hwcs_forty_lasso.mod, s = hwcs_forty_bestlam,
    newx = hwcs_forty_x[hwcs_forty_test, ])
mean((hwcs_forty_lasso.pred - hwcs_forty_y.test)^2)

hwcs_forty_out <- glmnet(hwcs_forty_x, hwcs_forty_y, alpha = 1, lambda = grid)
hwcs_forty_lasso.coef <- predict(hwcs_forty_out, type = "coefficients",
    s = hwcs_forty_bestlam)[1:ncol(hwcs_forty), ]
hwcs_forty_lasso.coef
hwcs_forty_lasso.coef[hwcs_forty_lasso.coef != 0]
```

# Predict vertical
```{r}
hwcs_vertical <- combinecollege %>% select(-c(forty, broad_jump, three_cone, shuttle, player)) %>% na.omit()

hwcs_vertical_x <- model.matrix(vertical ~ ., hwcs_vertical)[, -1]
hwcs_vertical_y <- hwcs_vertical$vertical

set.seed(1)
hwcs_vertical_train <- sample(1:nrow(hwcs_vertical_x), nrow(hwcs_vertical_x) / 2)
hwcs_vertical_test <- (-hwcs_vertical_train)
hwcs_vertical_y.test <- hwcs_vertical_y[hwcs_vertical_test]

grid <- 10^seq(10, -2, length = 100)

hwcs_vertical_lasso.mod <- glmnet(hwcs_vertical_x[hwcs_vertical_train, ], hwcs_vertical_y[hwcs_vertical_train], alpha = 1,
    lambda = grid)
plot(hwcs_vertical_lasso.mod)

set.seed(1)
hwcs_vertical_cv.out <- cv.glmnet(hwcs_vertical_x[hwcs_vertical_train, ], hwcs_vertical_y[hwcs_vertical_train], alpha = 1)
plot(hwcs_vertical_cv.out)
hwcs_vertical_bestlam <- hwcs_vertical_cv.out$lambda.min
hwcs_vertical_lasso.pred <- predict(hwcs_vertical_lasso.mod, s = hwcs_vertical_bestlam,
    newx = hwcs_vertical_x[hwcs_vertical_test, ])
mean((hwcs_vertical_lasso.pred - hwcs_vertical_y.test)^2)

hwcs_vertical_out <- glmnet(hwcs_vertical_x, hwcs_vertical_y, alpha = 1, lambda = grid)
hwcs_vertical_lasso.coef <- predict(hwcs_vertical_out, type = "coefficients",
    s = hwcs_vertical_bestlam)[1:ncol(hwcs_vertical), ]
hwcs_vertical_lasso.coef
hwcs_vertical_lasso.coef[hwcs_vertical_lasso.coef != 0]
```

# Predict broad jump
```{r}
hwcs_broad_jump <- combinecollege %>% select(-c(vertical, forty, three_cone, shuttle, player)) %>% na.omit()

hwcs_broad_jump_x <- model.matrix(broad_jump ~ ., hwcs_broad_jump)[, -1]
hwcs_broad_jump_y <- hwcs_broad_jump$broad_jump

set.seed(1)
hwcs_broad_jump_train <- sample(1:nrow(hwcs_broad_jump_x), nrow(hwcs_broad_jump_x) / 2)
hwcs_broad_jump_test <- (-hwcs_broad_jump_train)
hwcs_broad_jump_y.test <- hwcs_broad_jump_y[hwcs_broad_jump_test]

grid <- 10^seq(10, -2, length = 100)

hwcs_broad_jump_lasso.mod <- glmnet(hwcs_broad_jump_x[hwcs_broad_jump_train, ], hwcs_broad_jump_y[hwcs_broad_jump_train], alpha = 1,
    lambda = grid)
plot(hwcs_broad_jump_lasso.mod)

set.seed(1)
hwcs_broad_jump_cv.out <- cv.glmnet(hwcs_broad_jump_x[hwcs_broad_jump_train, ], hwcs_broad_jump_y[hwcs_broad_jump_train], alpha = 1)
plot(hwcs_broad_jump_cv.out)
hwcs_broad_jump_bestlam <- hwcs_broad_jump_cv.out$lambda.min
hwcs_broad_jump_lasso.pred <- predict(hwcs_broad_jump_lasso.mod, s = hwcs_broad_jump_bestlam,
    newx = hwcs_broad_jump_x[hwcs_broad_jump_test, ])
mean((hwcs_broad_jump_lasso.pred - hwcs_broad_jump_y.test)^2)

hwcs_broad_jump_out <- glmnet(hwcs_broad_jump_x, hwcs_broad_jump_y, alpha = 1, lambda = grid)
hwcs_broad_jump_lasso.coef <- predict(hwcs_broad_jump_out, type = "coefficients",
    s = hwcs_broad_jump_bestlam)[1:ncol(hwcs_broad_jump), ]
hwcs_broad_jump_lasso.coef
hwcs_broad_jump_lasso.coef[hwcs_broad_jump_lasso.coef != 0]
```

# Predict three cone
```{r}
hwcs_three_cone <- combinecollege %>% select(-c(vertical, broad_jump, forty, shuttle, player)) %>% na.omit()

hwcs_three_cone_x <- model.matrix(three_cone ~ ., hwcs_three_cone)[, -1]
hwcs_three_cone_y <- hwcs_three_cone$three_cone

set.seed(1)
hwcs_three_cone_train <- sample(1:nrow(hwcs_three_cone_x), nrow(hwcs_three_cone_x) / 2)
hwcs_three_cone_test <- (-hwcs_three_cone_train)
hwcs_three_cone_y.test <- hwcs_three_cone_y[hwcs_three_cone_test]

grid <- 10^seq(10, -2, length = 100)

hwcs_three_cone_lasso.mod <- glmnet(hwcs_three_cone_x[hwcs_three_cone_train, ], hwcs_three_cone_y[hwcs_three_cone_train], alpha = 1,
    lambda = grid)
plot(hwcs_three_cone_lasso.mod)

set.seed(1)
hwcs_three_cone_cv.out <- cv.glmnet(hwcs_three_cone_x[hwcs_three_cone_train, ], hwcs_three_cone_y[hwcs_three_cone_train], alpha = 1)
plot(hwcs_three_cone_cv.out)
hwcs_three_cone_bestlam <- hwcs_three_cone_cv.out$lambda.min
hwcs_three_cone_lasso.pred <- predict(hwcs_three_cone_lasso.mod, s = hwcs_three_cone_bestlam,
    newx = hwcs_three_cone_x[hwcs_three_cone_test, ])
mean((hwcs_three_cone_lasso.pred - hwcs_three_cone_y.test)^2)

hwcs_three_cone_out <- glmnet(hwcs_three_cone_x, hwcs_three_cone_y, alpha = 1, lambda = grid)
hwcs_three_cone_lasso.coef <- predict(hwcs_three_cone_out, type = "coefficients",
    s = hwcs_three_cone_bestlam)[1:ncol(hwcs_three_cone), ]
hwcs_three_cone_lasso.coef
hwcs_three_cone_lasso.coef[hwcs_three_cone_lasso.coef != 0]
```

# Predict shuttle
```{r}
hwcs_shuttle <- combinecollege %>% select(-c(vertical, broad_jump, three_cone, forty, player)) %>% na.omit()

hwcs_shuttle_x <- model.matrix(shuttle ~ ., hwcs_shuttle)[, -1]
hwcs_shuttle_y <- hwcs_shuttle$shuttle

set.seed(1)
hwcs_shuttle_train <- sample(1:nrow(hwcs_shuttle_x), nrow(hwcs_shuttle_x) / 2)
hwcs_shuttle_test <- (-hwcs_shuttle_train)
hwcs_shuttle_y.test <- hwcs_shuttle_y[hwcs_shuttle_test]

grid <- 10^seq(10, -2, length = 100)

hwcs_shuttle_lasso.mod <- glmnet(hwcs_shuttle_x[hwcs_shuttle_train, ], hwcs_shuttle_y[hwcs_shuttle_train], alpha = 1,
    lambda = grid)
plot(hwcs_shuttle_lasso.mod)

set.seed(1)
hwcs_shuttle_cv.out <- cv.glmnet(hwcs_shuttle_x[hwcs_shuttle_train, ], hwcs_shuttle_y[hwcs_shuttle_train], alpha = 1)
plot(hwcs_shuttle_cv.out)
hwcs_shuttle_bestlam <- hwcs_shuttle_cv.out$lambda.min
hwcs_shuttle_lasso.pred <- predict(hwcs_shuttle_lasso.mod, s = hwcs_shuttle_bestlam,
    newx = hwcs_shuttle_x[hwcs_shuttle_test, ])
mean((hwcs_shuttle_lasso.pred - hwcs_shuttle_y.test)^2)

hwcs_shuttle_out <- glmnet(hwcs_shuttle_x, hwcs_shuttle_y, alpha = 1, lambda = grid)
hwcs_shuttle_lasso.coef <- predict(hwcs_shuttle_out, type = "coefficients",
    s = hwcs_shuttle_bestlam)[1:ncol(hwcs_shuttle), ]
hwcs_shuttle_lasso.coef
hwcs_shuttle_lasso.coef[hwcs_shuttle_lasso.coef != 0]
```

```{r}

shuttle_coef_values <- hwcs_shuttle_lasso.coef[hwcs_shuttle_lasso.coef != 0]
shuttle_var_names <- names(shuttle_coef_values)

shuttle_formula_str <- paste0(shuttle_coef_values[1], " + ", paste(paste0(shuttle_coef_values[-1], " * ", shuttle_var_names[-1]), collapse = " + "))


hwcs1 <- combinecollege %>% 
  mutate(shuttle = if_else(is.na(shuttle), !!rlang::parse_expr(shuttle_formula_str), shuttle))

forty_coef_values <- hwcs_forty_lasso.coef[hwcs_forty_lasso.coef != 0]
forty_var_names <- names(forty_coef_values)

forty_formula_str <- paste0(forty_coef_values[1], " + ", paste(paste0(forty_coef_values[-1], " * ", forty_var_names[-1]), collapse = " + "))


hwcs2 <- hwcs1 %>% 
  mutate(ConfIndicator1 = as.numeric(ConfIndicator)) %>%
  mutate(forty = if_else(is.na(forty), !!rlang::parse_expr(forty_formula_str), forty)) %>%
  select(-ConfIndicator1)

vertical_coef_values <- hwcs_vertical_lasso.coef[hwcs_vertical_lasso.coef != 0]
vertical_var_names <- names(vertical_coef_values)

vertical_formula_str <- paste0(vertical_coef_values[1], " + ", paste(paste0(vertical_coef_values[-1], " * ", vertical_var_names[-1]), collapse = " + "))


hwcs3 <- hwcs2 %>% 
  mutate(vertical = if_else(is.na(vertical), !!rlang::parse_expr(vertical_formula_str), vertical))

broad_jump_coef_values <- hwcs_broad_jump_lasso.coef[hwcs_broad_jump_lasso.coef != 0]
broad_jump_var_names <- names(broad_jump_coef_values)

broad_jump_formula_str <- paste0(broad_jump_coef_values[1], " + ", paste(paste0(broad_jump_coef_values[-1], " * ", broad_jump_var_names[-1]), collapse = " + "))


hwcs4 <- hwcs3 %>% 
  mutate(ConfIndicator1 = as.numeric(ConfIndicator)) %>%
  mutate(broad_jump = if_else(is.na(broad_jump), !!rlang::parse_expr(broad_jump_formula_str), broad_jump)) %>%
  select(-ConfIndicator1)

three_cone_coef_values <- hwcs_three_cone_lasso.coef[hwcs_three_cone_lasso.coef != 0]
three_cone_var_names <- names(three_cone_coef_values)

three_cone_formula_str <- paste0(three_cone_coef_values[1], " + ", paste(paste0(three_cone_coef_values[-1], " * ", three_cone_var_names[-1]), collapse = " + "))


hwcs <- hwcs4 %>% 
  mutate(ConfIndicator1 = as.numeric(ConfIndicator)) %>%
  mutate(three_cone = if_else(is.na(three_cone), !!rlang::parse_expr(three_cone_formula_str), three_cone)) %>%
  select(-ConfIndicator1)

```


# Combine Combinations
```{r}
combineonly <- wrs %>% distinct(player, forty, vertical, broad_jump, three_cone, shuttle)
cc1 <- combineonly %>% filter(!is.na(forty) & !is.na(vertical) & !is.na(broad_jump) & !is.na(three_cone) & !is.na(shuttle))
cc2 <- combineonly %>% filter(!is.na(forty) & is.na(vertical) & is.na(broad_jump) & is.na(three_cone) & is.na(shuttle))
cc3 <- combineonly %>% filter(!is.na(forty) & !is.na(vertical) & is.na(broad_jump) & is.na(three_cone) & is.na(shuttle))
cc4 <- combineonly %>% filter(!is.na(forty) & is.na(vertical) & !is.na(broad_jump) & is.na(three_cone) & is.na(shuttle))
cc5 <- combineonly %>% filter(!is.na(forty) & is.na(vertical) & is.na(broad_jump) & !is.na(three_cone) & is.na(shuttle))
cc6 <- combineonly %>% filter(!is.na(forty) & is.na(vertical) & is.na(broad_jump) & is.na(three_cone) & !is.na(shuttle))
cc7 <- combineonly %>% filter(!is.na(forty) & !is.na(vertical) & !is.na(broad_jump) & is.na(three_cone) & is.na(shuttle))
cc8 <- combineonly %>% filter(!is.na(forty) & !is.na(vertical) & is.na(broad_jump) & !is.na(three_cone) & is.na(shuttle))
cc9 <- combineonly %>% filter(!is.na(forty) & !is.na(vertical) & is.na(broad_jump) & is.na(three_cone) & !is.na(shuttle))
cc10 <- combineonly %>% filter(!is.na(forty) & is.na(vertical) & !is.na(broad_jump) & !is.na(three_cone) & is.na(shuttle))
cc11 <- combineonly %>% filter(!is.na(forty) & is.na(vertical) & !is.na(broad_jump) & is.na(three_cone) & !is.na(shuttle))
cc12 <- combineonly %>% filter(!is.na(forty) & is.na(vertical) & is.na(broad_jump) & !is.na(three_cone) & !is.na(shuttle))
cc13 <- combineonly %>% filter(!is.na(forty) & !is.na(vertical) & !is.na(broad_jump) & !is.na(three_cone) & is.na(shuttle))
cc14 <- combineonly %>% filter(!is.na(forty) & !is.na(vertical) & !is.na(broad_jump) & is.na(three_cone) & !is.na(shuttle))
cc15 <- combineonly %>% filter(!is.na(forty) & !is.na(vertical) & is.na(broad_jump) & !is.na(three_cone) & !is.na(shuttle))
cc16 <- combineonly %>% filter(!is.na(forty) & is.na(vertical) & !is.na(broad_jump) & !is.na(three_cone) & !is.na(shuttle))
cc17 <- combineonly %>% filter(is.na(forty) & !is.na(vertical) & is.na(broad_jump) & is.na(three_cone) & is.na(shuttle))
cc18 <- combineonly %>% filter(is.na(forty) & !is.na(vertical) & !is.na(broad_jump) & is.na(three_cone) & is.na(shuttle))
cc19 <- combineonly %>% filter(is.na(forty) & !is.na(vertical) & is.na(broad_jump) & !is.na(three_cone) & is.na(shuttle))
cc20 <- combineonly %>% filter(is.na(forty) & !is.na(vertical) & is.na(broad_jump) & is.na(three_cone) & !is.na(shuttle))
cc21 <- combineonly %>% filter(is.na(forty) & !is.na(vertical) & !is.na(broad_jump) & !is.na(three_cone) & is.na(shuttle))
cc22 <- combineonly %>% filter(is.na(forty) & !is.na(vertical) & !is.na(broad_jump) & is.na(three_cone) & !is.na(shuttle))
cc23 <- combineonly %>% filter(is.na(forty) & !is.na(vertical) & is.na(broad_jump) & !is.na(three_cone) & !is.na(shuttle))
cc24 <- combineonly %>% filter(is.na(forty) & !is.na(vertical) & !is.na(broad_jump) & !is.na(three_cone) & !is.na(shuttle))
cc25 <- combineonly %>% filter(is.na(forty) & is.na(vertical) & !is.na(broad_jump) & is.na(three_cone) & is.na(shuttle))
cc26 <- combineonly %>% filter(is.na(forty) & is.na(vertical) & !is.na(broad_jump) & !is.na(three_cone) & is.na(shuttle))
cc27 <- combineonly %>% filter(is.na(forty) & is.na(vertical) & !is.na(broad_jump) & is.na(three_cone) & !is.na(shuttle))
cc28 <- combineonly %>% filter(is.na(forty) & is.na(vertical) & !is.na(broad_jump) & !is.na(three_cone) & !is.na(shuttle))
cc29 <- combineonly %>% filter(is.na(forty) & is.na(vertical) & is.na(broad_jump) & !is.na(three_cone) & is.na(shuttle))
cc30 <- combineonly %>% filter(is.na(forty) & is.na(vertical) & is.na(broad_jump) & !is.na(three_cone) & !is.na(shuttle))
cc31 <- combineonly %>% filter(is.na(forty) & is.na(vertical) & is.na(broad_jump) & is.na(three_cone) & !is.na(shuttle))
cc32 <- combineonly %>% filter(is.na(forty) & is.na(vertical) & is.na(broad_jump) & is.na(three_cone) & is.na(shuttle))
```

__NFL COMBINE ONLY__

# Use forty to predict
```{r}
forty_2_vertical <- combineonly %>% select(forty, vertical) %>% filter(!is.na(forty) & ! is.na(vertical))


f2v_vertical_x <- model.matrix(vertical ~ ., forty_2_vertical)
f2v_vertical_y <- forty_2_vertical$vertical
f2v_vertical_x 
mean(f2v_vertical_y)

set.seed(2)
f2v_vertical_train <- sample(1:nrow(f2v_vertical_x), .8*nrow(f2v_vertical_x))
f2v_vertical_test <- (-f2v_vertical_train)
f2v_vertical_y.test <- f2v_vertical_y[f2v_vertical_test]

grid <- 10^seq(-5, 5, length = 100)

f2v_vertical_lasso.mod <- glmnet(f2v_vertical_x[f2v_vertical_train, ], f2v_vertical_y[f2v_vertical_train], alpha = 1,
    lambda = grid,intercept = TRUE ,standardize = TRUE)
plot(f2v_vertical_lasso.mod)

set.seed(1)
f2v_vertical_cv.out <- cv.glmnet(f2v_vertical_x[f2v_vertical_train, ], f2v_vertical_y[f2v_vertical_train], alpha = 1)
#plot(f2v_vertical_cv.out)
f2v_vertical_bestlam <- f2v_vertical_cv.out$lambda.min
#f2v_vertical_bestlam <- 1
f2v_vertical_lasso.pred <- predict(f2v_vertical_lasso.mod, s = f2v_vertical_bestlam,
    newx = f2v_vertical_x[f2v_vertical_test, ])
mean((f2v_vertical_lasso.pred - f2v_vertical_y.test)^2)

f2v_vertical_out <- glmnet(f2v_vertical_x, f2v_vertical_y, alpha = 1, lambda = f2v_vertical_bestlam )
coef(f2v_vertical_out)
f2v_vertical_lasso.coef <- predict(f2v_vertical_out, type = "coefficients",
    s = f2v_vertical_bestlam)[1:(ncol(forty_2_vertical)+1), ]
f2v_vertical_lasso.coef
f2v_vertical_lasso.coef[f2v_vertical_lasso.coef != 0]

ggplot(forty_2_vertical[-f2v_vertical_train,] %>% mutate(pred = f2v_vertical_lasso.pred),
       aes(x = pred, vertical)) +
  geom_point()



f2v_vertical_x_scale <- model.matrix(scale(vertical) ~ scale(forty), forty_2_vertical)
f2v_vertical_y_scale <- (forty_2_vertical %>% mutate(vertical = scale(vertical)))$vertical

set.seed(2)
f2v_vertical_train <- sample(1:nrow(f2v_vertical_x_scale), .8*nrow(f2v_vertical_x_scale))
f2v_vertical_test <- (-f2v_vertical_train)
f2v_vertical_y.test_scale <- f2v_vertical_y_scale[f2v_vertical_test]

f2v_vertical_lasso.mod_scale <- glmnet(f2v_vertical_x_scale[f2v_vertical_train, ], f2v_vertical_y_scale[f2v_vertical_train], alpha = 1,
    lambda = grid,intercept = TRUE ,standardize = TRUE)

set.seed(1)
f2v_vertical_cv.out_scale <- cv.glmnet(f2v_vertical_x_scale[f2v_vertical_train, ], f2v_vertical_y_scale[f2v_vertical_train], alpha = 1)
#plot(f2v_vertical_cv.out)
f2v_vertical_bestlam_scale <- f2v_vertical_cv.out_scale$lambda.min
#f2v_vertical_bestlam <- 1
f2v_vertical_lasso.pred_scale <- predict(f2v_vertical_lasso.mod_scale, s = f2v_vertical_bestlam_scale,
    newx = f2v_vertical_x_scale[f2v_vertical_test, ])
mean((f2v_vertical_lasso.pred_scale - f2v_vertical_y.test_scale)^2)
```

```{r}
forty_2_broad_jump <- combineonly %>% select(forty, broad_jump) %>% filter(!is.na(forty) & ! is.na(broad_jump))


f2bj_broad_jump_x <- model.matrix(broad_jump ~ ., forty_2_broad_jump)
f2bj_broad_jump_y <- forty_2_broad_jump$broad_jump
f2bj_broad_jump_x 
mean(f2bj_broad_jump_y)

set.seed(2)
f2bj_broad_jump_train <- sample(1:nrow(f2bj_broad_jump_x), .8*nrow(f2bj_broad_jump_x))
f2bj_broad_jump_test <- (-f2bj_broad_jump_train)
f2bj_broad_jump_y.test <- f2bj_broad_jump_y[f2bj_broad_jump_test]

grid <- 10^seq(-5, 5, length = 100)

f2bj_broad_jump_lasso.mod <- glmnet(f2bj_broad_jump_x[f2bj_broad_jump_train, ], f2bj_broad_jump_y[f2bj_broad_jump_train], alpha = 1,
    lambda = grid,intercept = TRUE ,standardize = TRUE)
plot(f2bj_broad_jump_lasso.mod)

set.seed(1)
f2bj_broad_jump_cv.out <- cv.glmnet(f2bj_broad_jump_x[f2bj_broad_jump_train, ], f2bj_broad_jump_y[f2bj_broad_jump_train], alpha = 1)
#plot(f2bj_broad_jump_cv.out)
f2bj_broad_jump_bestlam <- f2bj_broad_jump_cv.out$lambda.min
#f2bj_broad_jump_bestlam <- 1
f2bj_broad_jump_lasso.pred <- predict(f2bj_broad_jump_lasso.mod, s = f2bj_broad_jump_bestlam,
    newx = f2bj_broad_jump_x[f2bj_broad_jump_test, ])
mean((f2bj_broad_jump_lasso.pred - f2bj_broad_jump_y.test)^2)

f2bj_broad_jump_out <- glmnet(f2bj_broad_jump_x, f2bj_broad_jump_y, alpha = 1, lambda = f2bj_broad_jump_bestlam )
coef(f2bj_broad_jump_out)
f2bj_broad_jump_lasso.coef <- predict(f2bj_broad_jump_out, type = "coefficients",
    s = f2bj_broad_jump_bestlam)[1:(ncol(forty_2_broad_jump)+1), ]
f2bj_broad_jump_lasso.coef
f2bj_broad_jump_lasso.coef[f2bj_broad_jump_lasso.coef != 0]

ggplot(forty_2_broad_jump[-f2bj_broad_jump_train,] %>% mutate(pred = f2bj_broad_jump_lasso.pred),
       aes(x = pred, broad_jump)) +
  geom_point()



f2bj_broad_jump_x_scale <- model.matrix(scale(broad_jump) ~ scale(forty), forty_2_broad_jump)
f2bj_broad_jump_y_scale <- (forty_2_broad_jump %>% mutate(broad_jump = scale(broad_jump)))$broad_jump

set.seed(2)
f2bj_broad_jump_train <- sample(1:nrow(f2bj_broad_jump_x_scale), .8*nrow(f2bj_broad_jump_x_scale))
f2bj_broad_jump_test <- (-f2bj_broad_jump_train)
f2bj_broad_jump_y.test_scale <- f2bj_broad_jump_y_scale[f2bj_broad_jump_test]

f2bj_broad_jump_lasso.mod_scale <- glmnet(f2bj_broad_jump_x_scale[f2bj_broad_jump_train, ], f2bj_broad_jump_y_scale[f2bj_broad_jump_train], alpha = 1,
    lambda = grid,intercept = TRUE ,standardize = TRUE)

set.seed(1)
f2bj_broad_jump_cv.out_scale <- cv.glmnet(f2bj_broad_jump_x_scale[f2bj_broad_jump_train, ], f2bj_broad_jump_y_scale[f2bj_broad_jump_train], alpha = 1)
#plot(f2bj_broad_jump_cv.out)
f2bj_broad_jump_bestlam_scale <- f2bj_broad_jump_cv.out_scale$lambda.min
#f2bj_broad_jump_bestlam <- 1
f2bj_broad_jump_lasso.pred_scale <- predict(f2bj_broad_jump_lasso.mod_scale, s = f2bj_broad_jump_bestlam_scale,
    newx = f2bj_broad_jump_x_scale[f2bj_broad_jump_test, ])
mean((f2bj_broad_jump_lasso.pred_scale - f2bj_broad_jump_y.test_scale)^2)
```

```{r}
forty_2_three_cone <- combineonly %>% select(forty, three_cone) %>% filter(!is.na(forty) & ! is.na(three_cone))


f23c_three_cone_x <- model.matrix(three_cone ~ ., forty_2_three_cone)
f23c_three_cone_y <- forty_2_three_cone$three_cone
f23c_three_cone_x 
mean(f23c_three_cone_y)

set.seed(2)
f23c_three_cone_train <- sample(1:nrow(f23c_three_cone_x), .8*nrow(f23c_three_cone_x))
f23c_three_cone_test <- (-f23c_three_cone_train)
f23c_three_cone_y.test <- f23c_three_cone_y[f23c_three_cone_test]

grid <- 10^seq(-5, 5, length = 100)

f23c_three_cone_lasso.mod <- glmnet(f23c_three_cone_x[f23c_three_cone_train, ], f23c_three_cone_y[f23c_three_cone_train], alpha = 1,
    lambda = grid,intercept = TRUE ,standardize = TRUE)
plot(f23c_three_cone_lasso.mod)

set.seed(1)
f23c_three_cone_cv.out <- cv.glmnet(f23c_three_cone_x[f23c_three_cone_train, ], f23c_three_cone_y[f23c_three_cone_train], alpha = 1)
#plot(f23c_three_cone_cv.out)
f23c_three_cone_bestlam <- f23c_three_cone_cv.out$lambda.min
#f23c_three_cone_bestlam <- 1
f23c_three_cone_lasso.pred <- predict(f23c_three_cone_lasso.mod, s = f23c_three_cone_bestlam,
    newx = f23c_three_cone_x[f23c_three_cone_test, ])
mean((f23c_three_cone_lasso.pred - f23c_three_cone_y.test)^2)

f23c_three_cone_out <- glmnet(f23c_three_cone_x, f23c_three_cone_y, alpha = 1, lambda = f23c_three_cone_bestlam )
coef(f23c_three_cone_out)
f23c_three_cone_lasso.coef <- predict(f23c_three_cone_out, type = "coefficients",
    s = f23c_three_cone_bestlam)[1:(ncol(forty_2_three_cone)+1), ]
f23c_three_cone_lasso.coef
f23c_three_cone_lasso.coef[f23c_three_cone_lasso.coef != 0]

ggplot(forty_2_three_cone[-f23c_three_cone_train,] %>% mutate(pred = f23c_three_cone_lasso.pred),
       aes(x = pred, three_cone)) +
  geom_point()



f23c_three_cone_x_scale <- model.matrix(scale(three_cone) ~ scale(forty), forty_2_three_cone)
f23c_three_cone_y_scale <- (forty_2_three_cone %>% mutate(three_cone = scale(three_cone)))$three_cone

set.seed(2)
f23c_three_cone_train <- sample(1:nrow(f23c_three_cone_x_scale), .8*nrow(f23c_three_cone_x_scale))
f23c_three_cone_test <- (-f23c_three_cone_train)
f23c_three_cone_y.test_scale <- f23c_three_cone_y_scale[f23c_three_cone_test]

f23c_three_cone_lasso.mod_scale <- glmnet(f23c_three_cone_x_scale[f23c_three_cone_train, ], f23c_three_cone_y_scale[f23c_three_cone_train], alpha = 1,
    lambda = grid,intercept = TRUE ,standardize = TRUE)

set.seed(1)
f23c_three_cone_cv.out_scale <- cv.glmnet(f23c_three_cone_x_scale[f23c_three_cone_train, ], f23c_three_cone_y_scale[f23c_three_cone_train], alpha = 1)
#plot(f23c_three_cone_cv.out)
f23c_three_cone_bestlam_scale <- f23c_three_cone_cv.out_scale$lambda.min
#f23c_three_cone_bestlam <- 1
f23c_three_cone_lasso.pred_scale <- predict(f23c_three_cone_lasso.mod_scale, s = f23c_three_cone_bestlam_scale,
    newx = f23c_three_cone_x_scale[f23c_three_cone_test, ])
mean((f23c_three_cone_lasso.pred_scale - f23c_three_cone_y.test_scale)^2)
```

```{r}
forty_2_shuttle <- combineonly %>% select(forty, shuttle) %>% filter(!is.na(forty) & ! is.na(shuttle))


f2s_shuttle_x <- model.matrix(shuttle ~ ., forty_2_shuttle)
f2s_shuttle_y <- forty_2_shuttle$shuttle
f2s_shuttle_x 
mean(f2s_shuttle_y)

set.seed(2)
f2s_shuttle_train <- sample(1:nrow(f2s_shuttle_x), .8*nrow(f2s_shuttle_x))
f2s_shuttle_test <- (-f2s_shuttle_train)
f2s_shuttle_y.test <- f2s_shuttle_y[f2s_shuttle_test]

grid <- 10^seq(-5, 5, length = 100)

f2s_shuttle_lasso.mod <- glmnet(f2s_shuttle_x[f2s_shuttle_train, ], f2s_shuttle_y[f2s_shuttle_train], alpha = 1,
    lambda = grid,intercept = TRUE ,standardize = TRUE)
plot(f2s_shuttle_lasso.mod)

set.seed(1)
f2s_shuttle_cv.out <- cv.glmnet(f2s_shuttle_x[f2s_shuttle_train, ], f2s_shuttle_y[f2s_shuttle_train], alpha = 1)
#plot(f2s_shuttle_cv.out)
f2s_shuttle_bestlam <- f2s_shuttle_cv.out$lambda.min
#f2s_shuttle_bestlam <- 1
f2s_shuttle_lasso.pred <- predict(f2s_shuttle_lasso.mod, s = f2s_shuttle_bestlam,
    newx = f2s_shuttle_x[f2s_shuttle_test, ])
mean((f2s_shuttle_lasso.pred - f2s_shuttle_y.test)^2)

f2s_shuttle_out <- glmnet(f2s_shuttle_x, f2s_shuttle_y, alpha = 1, lambda = f2s_shuttle_bestlam )
coef(f2s_shuttle_out)
f2s_shuttle_lasso.coef <- predict(f2s_shuttle_out, type = "coefficients",
    s = f2s_shuttle_bestlam)[1:(ncol(forty_2_shuttle)+1), ]
f2s_shuttle_lasso.coef
f2s_shuttle_lasso.coef[f2s_shuttle_lasso.coef != 0]

ggplot(forty_2_shuttle[-f2s_shuttle_train,] %>% mutate(pred = f2s_shuttle_lasso.pred),
       aes(x = pred, shuttle)) +
  geom_point()



f2s_shuttle_x_scale <- model.matrix(scale(shuttle) ~ scale(forty), forty_2_shuttle)
f2s_shuttle_y_scale <- (forty_2_shuttle %>% mutate(shuttle = scale(shuttle)))$shuttle

set.seed(2)
f2s_shuttle_train <- sample(1:nrow(f2s_shuttle_x_scale), .8*nrow(f2s_shuttle_x_scale))
f2s_shuttle_test <- (-f2s_shuttle_train)
f2s_shuttle_y.test_scale <- f2s_shuttle_y_scale[f2s_shuttle_test]

f2s_shuttle_lasso.mod_scale <- glmnet(f2s_shuttle_x_scale[f2s_shuttle_train, ], f2s_shuttle_y_scale[f2s_shuttle_train], alpha = 1,
    lambda = grid,intercept = TRUE ,standardize = TRUE)

set.seed(1)
f2s_shuttle_cv.out_scale <- cv.glmnet(f2s_shuttle_x_scale[f2s_shuttle_train, ], f2s_shuttle_y_scale[f2s_shuttle_train], alpha = 1)
#plot(f2s_shuttle_cv.out)
f2s_shuttle_bestlam_scale <- f2s_shuttle_cv.out_scale$lambda.min
#f2s_shuttle_bestlam <- 1
f2s_shuttle_lasso.pred_scale <- predict(f2s_shuttle_lasso.mod_scale, s = f2s_shuttle_bestlam_scale,
    newx = f2s_shuttle_x_scale[f2s_shuttle_test, ])
mean((f2s_shuttle_lasso.pred_scale - f2s_shuttle_y.test_scale)^2)
```

# If player only has forty predict vertical
```{r}
update1 <- combineonly %>% mutate(vertical = if_else(
                           !is.na(forty) & is.na(vertical) & is.na(broad_jump) & is.na(three_cone) & is.na(shuttle),
                           f2v_vertical_lasso.coef[f2v_vertical_lasso.coef != 0][1] +
                             f2v_vertical_lasso.coef[f2v_vertical_lasso.coef != 0][2] * forty,
                           vertical
                         )) 
```

# Use three cone to predict
```{r}
three_cone_2_forty <- combineonly %>% select(three_cone, forty) %>% filter(!is.na(three_cone) & ! is.na(forty))


tc2f_forty_x <- model.matrix(forty ~ ., three_cone_2_forty)
tc2f_forty_y <- three_cone_2_forty$forty
tc2f_forty_x 
mean(tc2f_forty_y)

set.seed(2)
tc2f_forty_train <- sample(1:nrow(tc2f_forty_x), .8*nrow(tc2f_forty_x))
tc2f_forty_test <- (-tc2f_forty_train)
tc2f_forty_y.test <- tc2f_forty_y[tc2f_forty_test]

grid <- 10^seq(-5, 5, length = 100)

tc2f_forty_lasso.mod <- glmnet(tc2f_forty_x[tc2f_forty_train, ], tc2f_forty_y[tc2f_forty_train], alpha = 1,
    lambda = grid,intercept = TRUE ,standardize = TRUE)
plot(tc2f_forty_lasso.mod)

set.seed(1)
tc2f_forty_cv.out <- cv.glmnet(tc2f_forty_x[tc2f_forty_train, ], tc2f_forty_y[tc2f_forty_train], alpha = 1)
#plot(tc2f_forty_cv.out)
tc2f_forty_bestlam <- tc2f_forty_cv.out$lambda.min
#tc2f_forty_bestlam <- 1
tc2f_forty_lasso.pred <- predict(tc2f_forty_lasso.mod, s = tc2f_forty_bestlam,
    newx = tc2f_forty_x[tc2f_forty_test, ])
mean((tc2f_forty_lasso.pred - tc2f_forty_y.test)^2)

tc2f_forty_out <- glmnet(tc2f_forty_x, tc2f_forty_y, alpha = 1, lambda = tc2f_forty_bestlam )
coef(tc2f_forty_out)
tc2f_forty_lasso.coef <- predict(tc2f_forty_out, type = "coefficients",
    s = tc2f_forty_bestlam)[1:(ncol(three_cone_2_forty)+1), ]
tc2f_forty_lasso.coef
tc2f_forty_lasso.coef[tc2f_forty_lasso.coef != 0]

ggplot(three_cone_2_forty[-tc2f_forty_train,] %>% mutate(pred = tc2f_forty_lasso.pred),
       aes(x = pred, forty)) +
  geom_point()



tc2f_forty_x_scale <- model.matrix(scale(forty) ~ scale(three_cone), three_cone_2_forty)
tc2f_forty_y_scale <- (three_cone_2_forty %>% mutate(forty = scale(forty)))$forty

set.seed(2)
tc2f_forty_train <- sample(1:nrow(tc2f_forty_x_scale), .8*nrow(tc2f_forty_x_scale))
tc2f_forty_test <- (-tc2f_forty_train)
tc2f_forty_y.test_scale <- tc2f_forty_y_scale[tc2f_forty_test]

tc2f_forty_lasso.mod_scale <- glmnet(tc2f_forty_x_scale[tc2f_forty_train, ], tc2f_forty_y_scale[tc2f_forty_train], alpha = 1,
    lambda = grid,intercept = TRUE ,standardize = TRUE)

set.seed(1)
tc2f_forty_cv.out_scale <- cv.glmnet(tc2f_forty_x_scale[tc2f_forty_train, ], tc2f_forty_y_scale[tc2f_forty_train], alpha = 1)
#plot(tc2f_forty_cv.out)
tc2f_forty_bestlam_scale <- tc2f_forty_cv.out_scale$lambda.min
#tc2f_forty_bestlam <- 1
tc2f_forty_lasso.pred_scale <- predict(tc2f_forty_lasso.mod_scale, s = tc2f_forty_bestlam_scale,
    newx = tc2f_forty_x_scale[tc2f_forty_test, ])
mean((tc2f_forty_lasso.pred_scale - tc2f_forty_y.test_scale)^2)
```

```{r}
three_cone_2_vertical <- combineonly %>% select(three_cone, vertical) %>% filter(!is.na(three_cone) & ! is.na(vertical))


tc2v_vertical_x <- model.matrix(vertical ~ ., three_cone_2_vertical)
tc2v_vertical_y <- three_cone_2_vertical$vertical
tc2v_vertical_x 
mean(tc2v_vertical_y)

set.seed(2)
tc2v_vertical_train <- sample(1:nrow(tc2v_vertical_x), .8*nrow(tc2v_vertical_x))
tc2v_vertical_test <- (-tc2v_vertical_train)
tc2v_vertical_y.test <- tc2v_vertical_y[tc2v_vertical_test]

grid <- 10^seq(-5, 5, length = 100)

tc2v_vertical_lasso.mod <- glmnet(tc2v_vertical_x[tc2v_vertical_train, ], tc2v_vertical_y[tc2v_vertical_train], alpha = 1,
    lambda = grid,intercept = TRUE ,standardize = TRUE)
plot(tc2v_vertical_lasso.mod)

set.seed(1)
tc2v_vertical_cv.out <- cv.glmnet(tc2v_vertical_x[tc2v_vertical_train, ], tc2v_vertical_y[tc2v_vertical_train], alpha = 1)
#plot(tc2v_vertical_cv.out)
tc2v_vertical_bestlam <- tc2v_vertical_cv.out$lambda.min
#tc2v_vertical_bestlam <- 1
tc2v_vertical_lasso.pred <- predict(tc2v_vertical_lasso.mod, s = tc2v_vertical_bestlam,
    newx = tc2v_vertical_x[tc2v_vertical_test, ])
mean((tc2v_vertical_lasso.pred - tc2v_vertical_y.test)^2)

tc2v_vertical_out <- glmnet(tc2v_vertical_x, tc2v_vertical_y, alpha = 1, lambda = tc2v_vertical_bestlam )
coef(tc2v_vertical_out)
tc2v_vertical_lasso.coef <- predict(tc2v_vertical_out, type = "coefficients",
    s = tc2v_vertical_bestlam)[1:(ncol(three_cone_2_vertical)+1), ]
tc2v_vertical_lasso.coef
tc2v_vertical_lasso.coef[tc2v_vertical_lasso.coef != 0]

ggplot(three_cone_2_vertical[-tc2v_vertical_train,] %>% mutate(pred = tc2v_vertical_lasso.pred),
       aes(x = pred, vertical)) +
  geom_point()



tc2v_vertical_x_scale <- model.matrix(scale(vertical) ~ scale(three_cone), three_cone_2_vertical)
tc2v_vertical_y_scale <- (three_cone_2_vertical %>% mutate(vertical = scale(vertical)))$vertical

set.seed(2)
tc2v_vertical_train <- sample(1:nrow(tc2v_vertical_x_scale), .8*nrow(tc2v_vertical_x_scale))
tc2v_vertical_test <- (-tc2v_vertical_train)
tc2v_vertical_y.test_scale <- tc2v_vertical_y_scale[tc2v_vertical_test]

tc2v_vertical_lasso.mod_scale <- glmnet(tc2v_vertical_x_scale[tc2v_vertical_train, ], tc2v_vertical_y_scale[tc2v_vertical_train], alpha = 1,
    lambda = grid,intercept = TRUE ,standardize = TRUE)

set.seed(1)
tc2v_vertical_cv.out_scale <- cv.glmnet(tc2v_vertical_x_scale[tc2v_vertical_train, ], tc2v_vertical_y_scale[tc2v_vertical_train], alpha = 1)
#plot(tc2v_vertical_cv.out)
tc2v_vertical_bestlam_scale <- tc2v_vertical_cv.out_scale$lambda.min
#tc2v_vertical_bestlam <- 1
tc2v_vertical_lasso.pred_scale <- predict(tc2v_vertical_lasso.mod_scale, s = tc2v_vertical_bestlam_scale,
    newx = tc2v_vertical_x_scale[tc2v_vertical_test, ])
mean((tc2v_vertical_lasso.pred_scale - tc2v_vertical_y.test_scale)^2)
```

```{r}
three_cone_2_broad_jump <- combineonly %>% select(three_cone, broad_jump) %>% filter(!is.na(three_cone) & ! is.na(broad_jump))


tc2bj_broad_jump_x <- model.matrix(broad_jump ~ ., three_cone_2_broad_jump)
tc2bj_broad_jump_y <- three_cone_2_broad_jump$broad_jump
tc2bj_broad_jump_x 
mean(tc2bj_broad_jump_y)

set.seed(2)
tc2bj_broad_jump_train <- sample(1:nrow(tc2bj_broad_jump_x), .8*nrow(tc2bj_broad_jump_x))
tc2bj_broad_jump_test <- (-tc2bj_broad_jump_train)
tc2bj_broad_jump_y.test <- tc2bj_broad_jump_y[tc2bj_broad_jump_test]

grid <- 10^seq(-5, 5, length = 100)

tc2bj_broad_jump_lasso.mod <- glmnet(tc2bj_broad_jump_x[tc2bj_broad_jump_train, ], tc2bj_broad_jump_y[tc2bj_broad_jump_train], alpha = 1,
    lambda = grid,intercept = TRUE ,standardize = TRUE)
plot(tc2bj_broad_jump_lasso.mod)

set.seed(1)
tc2bj_broad_jump_cv.out <- cv.glmnet(tc2bj_broad_jump_x[tc2bj_broad_jump_train, ], tc2bj_broad_jump_y[tc2bj_broad_jump_train], alpha = 1)
#plot(tc2bj_broad_jump_cv.out)
tc2bj_broad_jump_bestlam <- tc2bj_broad_jump_cv.out$lambda.min
#tc2bj_broad_jump_bestlam <- 1
tc2bj_broad_jump_lasso.pred <- predict(tc2bj_broad_jump_lasso.mod, s = tc2bj_broad_jump_bestlam,
    newx = tc2bj_broad_jump_x[tc2bj_broad_jump_test, ])
mean((tc2bj_broad_jump_lasso.pred - tc2bj_broad_jump_y.test)^2)

tc2bj_broad_jump_out <- glmnet(tc2bj_broad_jump_x, tc2bj_broad_jump_y, alpha = 1, lambda = tc2bj_broad_jump_bestlam )
coef(tc2bj_broad_jump_out)
tc2bj_broad_jump_lasso.coef <- predict(tc2bj_broad_jump_out, type = "coefficients",
    s = tc2bj_broad_jump_bestlam)[1:(ncol(three_cone_2_broad_jump)+1), ]
tc2bj_broad_jump_lasso.coef
tc2bj_broad_jump_lasso.coef[tc2bj_broad_jump_lasso.coef != 0]

ggplot(three_cone_2_broad_jump[-tc2bj_broad_jump_train,] %>% mutate(pred = tc2bj_broad_jump_lasso.pred),
       aes(x = pred, broad_jump)) +
  geom_point()



tc2bj_broad_jump_x_scale <- model.matrix(scale(broad_jump) ~ scale(three_cone), three_cone_2_broad_jump)
tc2bj_broad_jump_y_scale <- (three_cone_2_broad_jump %>% mutate(broad_jump = scale(broad_jump)))$broad_jump

set.seed(2)
tc2bj_broad_jump_train <- sample(1:nrow(tc2bj_broad_jump_x_scale), .8*nrow(tc2bj_broad_jump_x_scale))
tc2bj_broad_jump_test <- (-tc2bj_broad_jump_train)
tc2bj_broad_jump_y.test_scale <- tc2bj_broad_jump_y_scale[tc2bj_broad_jump_test]

tc2bj_broad_jump_lasso.mod_scale <- glmnet(tc2bj_broad_jump_x_scale[tc2bj_broad_jump_train, ], tc2bj_broad_jump_y_scale[tc2bj_broad_jump_train], alpha = 1,
    lambda = grid,intercept = TRUE ,standardize = TRUE)

set.seed(1)
tc2bj_broad_jump_cv.out_scale <- cv.glmnet(tc2bj_broad_jump_x_scale[tc2bj_broad_jump_train, ], tc2bj_broad_jump_y_scale[tc2bj_broad_jump_train], alpha = 1)
#plot(tc2bj_broad_jump_cv.out)
tc2bj_broad_jump_bestlam_scale <- tc2bj_broad_jump_cv.out_scale$lambda.min
#tc2bj_broad_jump_bestlam <- 1
tc2bj_broad_jump_lasso.pred_scale <- predict(tc2bj_broad_jump_lasso.mod_scale, s = tc2bj_broad_jump_bestlam_scale,
    newx = tc2bj_broad_jump_x_scale[tc2bj_broad_jump_test, ])
mean((tc2bj_broad_jump_lasso.pred_scale - tc2bj_broad_jump_y.test_scale)^2)
```


```{r}
three_cone_2_shuttle <- combineonly %>% select(three_cone, shuttle) %>% filter(!is.na(three_cone) & ! is.na(shuttle))


tc2s_shuttle_x <- model.matrix(shuttle ~ ., three_cone_2_shuttle)
tc2s_shuttle_y <- three_cone_2_shuttle$shuttle
tc2s_shuttle_x 
mean(tc2s_shuttle_y)

set.seed(2)
tc2s_shuttle_train <- sample(1:nrow(tc2s_shuttle_x), .8*nrow(tc2s_shuttle_x))
tc2s_shuttle_test <- (-tc2s_shuttle_train)
tc2s_shuttle_y.test <- tc2s_shuttle_y[tc2s_shuttle_test]

grid <- 10^seq(-5, 5, length = 100)

tc2s_shuttle_lasso.mod <- glmnet(tc2s_shuttle_x[tc2s_shuttle_train, ], tc2s_shuttle_y[tc2s_shuttle_train], alpha = 1,
    lambda = grid,intercept = TRUE ,standardize = TRUE)
plot(tc2s_shuttle_lasso.mod)

set.seed(1)
tc2s_shuttle_cv.out <- cv.glmnet(tc2s_shuttle_x[tc2s_shuttle_train, ], tc2s_shuttle_y[tc2s_shuttle_train], alpha = 1)
#plot(tc2s_shuttle_cv.out)
tc2s_shuttle_bestlam <- tc2s_shuttle_cv.out$lambda.min
#tc2s_shuttle_bestlam <- 1
tc2s_shuttle_lasso.pred <- predict(tc2s_shuttle_lasso.mod, s = tc2s_shuttle_bestlam,
    newx = tc2s_shuttle_x[tc2s_shuttle_test, ])
mean((tc2s_shuttle_lasso.pred - tc2s_shuttle_y.test)^2)

tc2s_shuttle_out <- glmnet(tc2s_shuttle_x, tc2s_shuttle_y, alpha = 1, lambda = tc2s_shuttle_bestlam )
coef(tc2s_shuttle_out)
tc2s_shuttle_lasso.coef <- predict(tc2s_shuttle_out, type = "coefficients",
    s = tc2s_shuttle_bestlam)[1:(ncol(three_cone_2_shuttle)+1), ]
tc2s_shuttle_lasso.coef
tc2s_shuttle_lasso.coef[tc2s_shuttle_lasso.coef != 0]

ggplot(three_cone_2_shuttle[-tc2s_shuttle_train,] %>% mutate(pred = tc2s_shuttle_lasso.pred),
       aes(x = pred, shuttle)) +
  geom_point()



tc2s_shuttle_x_scale <- model.matrix(scale(shuttle) ~ scale(three_cone), three_cone_2_shuttle)
tc2s_shuttle_y_scale <- (three_cone_2_shuttle %>% mutate(shuttle = scale(shuttle)))$shuttle

set.seed(2)
tc2s_shuttle_train <- sample(1:nrow(tc2s_shuttle_x_scale), .8*nrow(tc2s_shuttle_x_scale))
tc2s_shuttle_test <- (-tc2s_shuttle_train)
tc2s_shuttle_y.test_scale <- tc2s_shuttle_y_scale[tc2s_shuttle_test]

tc2s_shuttle_lasso.mod_scale <- glmnet(tc2s_shuttle_x_scale[tc2s_shuttle_train, ], tc2s_shuttle_y_scale[tc2s_shuttle_train], alpha = 1,
    lambda = grid,intercept = TRUE ,standardize = TRUE)

set.seed(1)
tc2s_shuttle_cv.out_scale <- cv.glmnet(tc2s_shuttle_x_scale[tc2s_shuttle_train, ], tc2s_shuttle_y_scale[tc2s_shuttle_train], alpha = 1)
#plot(tc2s_shuttle_cv.out)
tc2s_shuttle_bestlam_scale <- tc2s_shuttle_cv.out_scale$lambda.min
#tc2s_shuttle_bestlam <- 1
tc2s_shuttle_lasso.pred_scale <- predict(tc2s_shuttle_lasso.mod_scale, s = tc2s_shuttle_bestlam_scale,
    newx = tc2s_shuttle_x_scale[tc2s_shuttle_test, ])
mean((tc2s_shuttle_lasso.pred_scale - tc2s_shuttle_y.test_scale)^2)
```

# If player only has three cone predict shuttle
```{r}
update2 <- update1 %>% mutate(shuttle = if_else(
                           is.na(forty) & is.na(vertical) & is.na(broad_jump) & !is.na(three_cone) & is.na(shuttle),
                           tc2s_shuttle_lasso.coef[tc2s_shuttle_lasso.coef != 0][1] +
                             tc2s_shuttle_lasso.coef[tc2s_shuttle_lasso.coef != 0][2] * three_cone,
                           shuttle
                         )) 
```

# Use forty and vertical to predict
```{r}
forty_vertical_2_broad_jump <- combineonly %>% select(forty, vertical, broad_jump) %>% 
  filter(!is.na(forty) & !is.na(vertical) & !is.na(broad_jump))


fv2bj_broad_jump_x <- model.matrix(broad_jump ~ ., forty_vertical_2_broad_jump)
fv2bj_broad_jump_y <- forty_vertical_2_broad_jump$broad_jump
fv2bj_broad_jump_x 
mean(fv2bj_broad_jump_y)

set.seed(2)
fv2bj_broad_jump_train <- sample(1:nrow(fv2bj_broad_jump_x), .8*nrow(fv2bj_broad_jump_x))
fv2bj_broad_jump_test <- (-fv2bj_broad_jump_train)
fv2bj_broad_jump_y.test <- fv2bj_broad_jump_y[fv2bj_broad_jump_test]

grid <- 10^seq(-5, 5, length = 100)

fv2bj_broad_jump_lasso.mod <- glmnet(fv2bj_broad_jump_x[fv2bj_broad_jump_train, ], fv2bj_broad_jump_y[fv2bj_broad_jump_train], alpha = 1,
    lambda = grid,intercept = TRUE ,standardize = TRUE)
plot(fv2bj_broad_jump_lasso.mod)

set.seed(1)
fv2bj_broad_jump_cv.out <- cv.glmnet(fv2bj_broad_jump_x[fv2bj_broad_jump_train, ], fv2bj_broad_jump_y[fv2bj_broad_jump_train], alpha = 1)
#plot(fv2bj_broad_jump_cv.out)
fv2bj_broad_jump_bestlam <- fv2bj_broad_jump_cv.out$lambda.min
#fv2bj_broad_jump_bestlam <- 1
fv2bj_broad_jump_lasso.pred <- predict(fv2bj_broad_jump_lasso.mod, s = fv2bj_broad_jump_bestlam,
    newx = fv2bj_broad_jump_x[fv2bj_broad_jump_test, ])
mean((fv2bj_broad_jump_lasso.pred - fv2bj_broad_jump_y.test)^2)

fv2bj_broad_jump_out <- glmnet(fv2bj_broad_jump_x, fv2bj_broad_jump_y, alpha = 1, lambda = fv2bj_broad_jump_bestlam )
coef(fv2bj_broad_jump_out)
fv2bj_broad_jump_lasso.coef <- predict(fv2bj_broad_jump_out, type = "coefficients",
    s = fv2bj_broad_jump_bestlam)[1:(ncol(forty_2_broad_jump)+2), ]
fv2bj_broad_jump_lasso.coef
fv2bj_broad_jump_lasso.coef[fv2bj_broad_jump_lasso.coef != 0]

ggplot(forty_vertical_2_broad_jump[-fv2bj_broad_jump_train,] %>% mutate(pred = fv2bj_broad_jump_lasso.pred),
       aes(x = pred, broad_jump)) +
  geom_point()



fv2bj_broad_jump_x_scale <- model.matrix(scale(broad_jump) ~ scale(forty) + scale(vertical), forty_vertical_2_broad_jump)
fv2bj_broad_jump_y_scale <- (forty_vertical_2_broad_jump %>% mutate(broad_jump = scale(broad_jump)))$broad_jump

set.seed(2)
fv2bj_broad_jump_train <- sample(1:nrow(fv2bj_broad_jump_x_scale), .8*nrow(fv2bj_broad_jump_x_scale))
fv2bj_broad_jump_test <- (-fv2bj_broad_jump_train)
fv2bj_broad_jump_y.test_scale <- fv2bj_broad_jump_y_scale[fv2bj_broad_jump_test]

fv2bj_broad_jump_lasso.mod_scale <- glmnet(fv2bj_broad_jump_x_scale[fv2bj_broad_jump_train, ], fv2bj_broad_jump_y_scale[fv2bj_broad_jump_train], alpha = 1,
    lambda = grid,intercept = TRUE ,standardize = TRUE)

set.seed(1)
fv2bj_broad_jump_cv.out_scale <- cv.glmnet(fv2bj_broad_jump_x_scale[fv2bj_broad_jump_train, ], fv2bj_broad_jump_y_scale[fv2bj_broad_jump_train], alpha = 1)
#plot(fv2bj_broad_jump_cv.out)
fv2bj_broad_jump_bestlam_scale <- fv2bj_broad_jump_cv.out_scale$lambda.min
#fv2bj_broad_jump_bestlam <- 1
fv2bj_broad_jump_lasso.pred_scale <- predict(fv2bj_broad_jump_lasso.mod_scale, s = fv2bj_broad_jump_bestlam_scale,
    newx = fv2bj_broad_jump_x_scale[fv2bj_broad_jump_test, ])
mean((fv2bj_broad_jump_lasso.pred_scale - fv2bj_broad_jump_y.test_scale)^2)
```

```{r}
forty_vertical_2_three_cone <- combineonly %>% select(forty, vertical, three_cone) %>% 
  filter(!is.na(forty) & !is.na(vertical) & !is.na(three_cone))


fv23c_three_cone_x <- model.matrix(three_cone ~ ., forty_vertical_2_three_cone)
fv23c_three_cone_y <- forty_vertical_2_three_cone$three_cone
fv23c_three_cone_x 
mean(fv23c_three_cone_y)

set.seed(2)
fv23c_three_cone_train <- sample(1:nrow(fv23c_three_cone_x), .8*nrow(fv23c_three_cone_x))
fv23c_three_cone_test <- (-fv23c_three_cone_train)
fv23c_three_cone_y.test <- fv23c_three_cone_y[fv23c_three_cone_test]

grid <- 10^seq(-5, 5, length = 100)

fv23c_three_cone_lasso.mod <- glmnet(fv23c_three_cone_x[fv23c_three_cone_train, ], fv23c_three_cone_y[fv23c_three_cone_train], alpha = 1,
    lambda = grid,intercept = TRUE ,standardize = TRUE)
plot(fv23c_three_cone_lasso.mod)

set.seed(1)
fv23c_three_cone_cv.out <- cv.glmnet(fv23c_three_cone_x[fv23c_three_cone_train, ], fv23c_three_cone_y[fv23c_three_cone_train], alpha = 1)
#plot(fv23c_three_cone_cv.out)
fv23c_three_cone_bestlam <- fv23c_three_cone_cv.out$lambda.min
#fv23c_three_cone_bestlam <- 1
fv23c_three_cone_lasso.pred <- predict(fv23c_three_cone_lasso.mod, s = fv23c_three_cone_bestlam,
    newx = fv23c_three_cone_x[fv23c_three_cone_test, ])
mean((fv23c_three_cone_lasso.pred - fv23c_three_cone_y.test)^2)

fv23c_three_cone_out <- glmnet(fv23c_three_cone_x, fv23c_three_cone_y, alpha = 1, lambda = fv23c_three_cone_bestlam )
coef(fv23c_three_cone_out)
fv23c_three_cone_lasso.coef <- predict(fv23c_three_cone_out, type = "coefficients",
    s = fv23c_three_cone_bestlam)[1:(ncol(forty_2_three_cone)+2), ]
fv23c_three_cone_lasso.coef
fv23c_three_cone_lasso.coef[fv23c_three_cone_lasso.coef != 0]

ggplot(forty_vertical_2_three_cone[-fv23c_three_cone_train,] %>% mutate(pred = fv23c_three_cone_lasso.pred),
       aes(x = pred, three_cone)) +
  geom_point()



fv23c_three_cone_x_scale <- model.matrix(scale(three_cone) ~ scale(forty) + scale(vertical), forty_vertical_2_three_cone)
fv23c_three_cone_y_scale <- (forty_vertical_2_three_cone %>% mutate(three_cone = scale(three_cone)))$three_cone

set.seed(2)
fv23c_three_cone_train <- sample(1:nrow(fv23c_three_cone_x_scale), .8*nrow(fv23c_three_cone_x_scale))
fv23c_three_cone_test <- (-fv23c_three_cone_train)
fv23c_three_cone_y.test_scale <- fv23c_three_cone_y_scale[fv23c_three_cone_test]

fv23c_three_cone_lasso.mod_scale <- glmnet(fv23c_three_cone_x_scale[fv23c_three_cone_train, ], fv23c_three_cone_y_scale[fv23c_three_cone_train], alpha = 1,
    lambda = grid,intercept = TRUE ,standardize = TRUE)

set.seed(1)
fv23c_three_cone_cv.out_scale <- cv.glmnet(fv23c_three_cone_x_scale[fv23c_three_cone_train, ], fv23c_three_cone_y_scale[fv23c_three_cone_train], alpha = 1)
#plot(fv23c_three_cone_cv.out)
fv23c_three_cone_bestlam_scale <- fv23c_three_cone_cv.out_scale$lambda.min
#fv23c_three_cone_bestlam <- 1
fv23c_three_cone_lasso.pred_scale <- predict(fv23c_three_cone_lasso.mod_scale, s = fv23c_three_cone_bestlam_scale,
    newx = fv23c_three_cone_x_scale[fv23c_three_cone_test, ])
mean((fv23c_three_cone_lasso.pred_scale - fv23c_three_cone_y.test_scale)^2)
```

```{r}
forty_vertical_2_shuttle <- combineonly %>% select(forty, vertical, shuttle) %>% 
  filter(!is.na(forty) & !is.na(vertical) & !is.na(shuttle))


fv2s_shuttle_x <- model.matrix(shuttle ~ ., forty_vertical_2_shuttle)
fv2s_shuttle_y <- forty_vertical_2_shuttle$shuttle
fv2s_shuttle_x 
mean(fv2s_shuttle_y)

set.seed(2)
fv2s_shuttle_train <- sample(1:nrow(fv2s_shuttle_x), .8*nrow(fv2s_shuttle_x))
fv2s_shuttle_test <- (-fv2s_shuttle_train)
fv2s_shuttle_y.test <- fv2s_shuttle_y[fv2s_shuttle_test]

grid <- 10^seq(-5, 5, length = 100)

fv2s_shuttle_lasso.mod <- glmnet(fv2s_shuttle_x[fv2s_shuttle_train, ], fv2s_shuttle_y[fv2s_shuttle_train], alpha = 1,
    lambda = grid,intercept = TRUE ,standardize = TRUE)
plot(fv2s_shuttle_lasso.mod)

set.seed(1)
fv2s_shuttle_cv.out <- cv.glmnet(fv2s_shuttle_x[fv2s_shuttle_train, ], fv2s_shuttle_y[fv2s_shuttle_train], alpha = 1)
#plot(fv2s_shuttle_cv.out)
fv2s_shuttle_bestlam <- fv2s_shuttle_cv.out$lambda.min
#fv2s_shuttle_bestlam <- 1
fv2s_shuttle_lasso.pred <- predict(fv2s_shuttle_lasso.mod, s = fv2s_shuttle_bestlam,
    newx = fv2s_shuttle_x[fv2s_shuttle_test, ])
mean((fv2s_shuttle_lasso.pred - fv2s_shuttle_y.test)^2)

fv2s_shuttle_out <- glmnet(fv2s_shuttle_x, fv2s_shuttle_y, alpha = 1, lambda = fv2s_shuttle_bestlam )
coef(fv2s_shuttle_out)
fv2s_shuttle_lasso.coef <- predict(fv2s_shuttle_out, type = "coefficients",
    s = fv2s_shuttle_bestlam)[1:(ncol(forty_2_shuttle)+2), ]
fv2s_shuttle_lasso.coef
fv2s_shuttle_lasso.coef[fv2s_shuttle_lasso.coef != 0]

ggplot(forty_vertical_2_shuttle[-fv2s_shuttle_train,] %>% mutate(pred = fv2s_shuttle_lasso.pred),
       aes(x = pred, shuttle)) +
  geom_point()



fv2s_shuttle_x_scale <- model.matrix(scale(shuttle) ~ scale(forty) + scale(vertical), forty_vertical_2_shuttle)
fv2s_shuttle_y_scale <- (forty_vertical_2_shuttle %>% mutate(shuttle = scale(shuttle)))$shuttle

set.seed(2)
fv2s_shuttle_train <- sample(1:nrow(fv2s_shuttle_x_scale), .8*nrow(fv2s_shuttle_x_scale))
fv2s_shuttle_test <- (-fv2s_shuttle_train)
fv2s_shuttle_y.test_scale <- fv2s_shuttle_y_scale[fv2s_shuttle_test]

fv2s_shuttle_lasso.mod_scale <- glmnet(fv2s_shuttle_x_scale[fv2s_shuttle_train, ], fv2s_shuttle_y_scale[fv2s_shuttle_train], alpha = 1,
    lambda = grid,intercept = TRUE ,standardize = TRUE)

set.seed(1)
fv2s_shuttle_cv.out_scale <- cv.glmnet(fv2s_shuttle_x_scale[fv2s_shuttle_train, ], fv2s_shuttle_y_scale[fv2s_shuttle_train], alpha = 1)
#plot(fv2s_shuttle_cv.out)
fv2s_shuttle_bestlam_scale <- fv2s_shuttle_cv.out_scale$lambda.min
#fv2s_shuttle_bestlam <- 1
fv2s_shuttle_lasso.pred_scale <- predict(fv2s_shuttle_lasso.mod_scale, s = fv2s_shuttle_bestlam_scale,
    newx = fv2s_shuttle_x_scale[fv2s_shuttle_test, ])
mean((fv2s_shuttle_lasso.pred_scale - fv2s_shuttle_y.test_scale)^2)
```

# If player only has forty and vertical predict broad jump
```{r}
update3 <- update2 %>% mutate(broad_jump = if_else(
                           !is.na(forty) & !is.na(vertical) & is.na(broad_jump) & is.na(three_cone) & is.na(shuttle),
                           fv2bj_broad_jump_lasso.coef[fv2bj_broad_jump_lasso.coef != 0][1] +
                             fv2bj_broad_jump_lasso.coef[fv2bj_broad_jump_lasso.coef != 0][2] * forty +
                             fv2bj_broad_jump_lasso.coef[fv2bj_broad_jump_lasso.coef != 0][3] * vertical,
                           broad_jump
                         )) 
```

# Use forty and broad jump to predict
```{r}
forty_broad_jump_2_vertical <- combineonly %>% select(forty, broad_jump, vertical) %>% 
  filter(!is.na(forty) & !is.na(broad_jump) & !is.na(vertical))


fbj2v_vertical_x <- model.matrix(vertical ~ ., forty_broad_jump_2_vertical)
fbj2v_vertical_y <- forty_broad_jump_2_vertical$vertical
fbj2v_vertical_x 
mean(fbj2v_vertical_y)

set.seed(2)
fbj2v_vertical_train <- sample(1:nrow(fbj2v_vertical_x), .8*nrow(fbj2v_vertical_x))
fbj2v_vertical_test <- (-fbj2v_vertical_train)
fbj2v_vertical_y.test <- fbj2v_vertical_y[fbj2v_vertical_test]

grid <- 10^seq(-5, 5, length = 100)

fbj2v_vertical_lasso.mod <- glmnet(fbj2v_vertical_x[fbj2v_vertical_train, ], fbj2v_vertical_y[fbj2v_vertical_train], alpha = 1,
    lambda = grid,intercept = TRUE ,standardize = TRUE)
plot(fbj2v_vertical_lasso.mod)

set.seed(1)
fbj2v_vertical_cv.out <- cv.glmnet(fbj2v_vertical_x[fbj2v_vertical_train, ], fbj2v_vertical_y[fbj2v_vertical_train], alpha = 1)
#plot(fbj2v_vertical_cv.out)
fbj2v_vertical_bestlam <- fbj2v_vertical_cv.out$lambda.min
#fbj2v_vertical_bestlam <- 1
fbj2v_vertical_lasso.pred <- predict(fbj2v_vertical_lasso.mod, s = fbj2v_vertical_bestlam,
    newx = fbj2v_vertical_x[fbj2v_vertical_test, ])
mean((fbj2v_vertical_lasso.pred - fbj2v_vertical_y.test)^2)

fbj2v_vertical_out <- glmnet(fbj2v_vertical_x, fbj2v_vertical_y, alpha = 1, lambda = fbj2v_vertical_bestlam )
coef(fbj2v_vertical_out)
fbj2v_vertical_lasso.coef <- predict(fbj2v_vertical_out, type = "coefficients",
    s = fbj2v_vertical_bestlam)[1:(ncol(forty_2_vertical)+2), ]
fbj2v_vertical_lasso.coef
fbj2v_vertical_lasso.coef[fbj2v_vertical_lasso.coef != 0]

ggplot(forty_broad_jump_2_vertical[-fbj2v_vertical_train,] %>% mutate(pred = fbj2v_vertical_lasso.pred),
       aes(x = pred, vertical)) +
  geom_point()



fbj2v_vertical_x_scale <- model.matrix(scale(vertical) ~ scale(forty) + scale(broad_jump), forty_broad_jump_2_vertical)
fbj2v_vertical_y_scale <- (forty_broad_jump_2_vertical %>% mutate(vertical = scale(vertical)))$vertical

set.seed(2)
fbj2v_vertical_train <- sample(1:nrow(fbj2v_vertical_x_scale), .8*nrow(fbj2v_vertical_x_scale))
fbj2v_vertical_test <- (-fbj2v_vertical_train)
fbj2v_vertical_y.test_scale <- fbj2v_vertical_y_scale[fbj2v_vertical_test]

fbj2v_vertical_lasso.mod_scale <- glmnet(fbj2v_vertical_x_scale[fbj2v_vertical_train, ], fbj2v_vertical_y_scale[fbj2v_vertical_train], alpha = 1,
    lambda = grid,intercept = TRUE ,standardize = TRUE)

set.seed(1)
fbj2v_vertical_cv.out_scale <- cv.glmnet(fbj2v_vertical_x_scale[fbj2v_vertical_train, ], fbj2v_vertical_y_scale[fbj2v_vertical_train], alpha = 1)
#plot(fbj2v_vertical_cv.out)
fbj2v_vertical_bestlam_scale <- fbj2v_vertical_cv.out_scale$lambda.min
#fbj2v_vertical_bestlam <- 1
fbj2v_vertical_lasso.pred_scale <- predict(fbj2v_vertical_lasso.mod_scale, s = fbj2v_vertical_bestlam_scale,
    newx = fbj2v_vertical_x_scale[fbj2v_vertical_test, ])
mean((fbj2v_vertical_lasso.pred_scale - fbj2v_vertical_y.test_scale)^2)
```

```{r}
forty_broad_jump_2_three_cone <- combineonly %>% select(forty, broad_jump, three_cone) %>% 
  filter(!is.na(forty) & !is.na(broad_jump) & !is.na(three_cone))


fbj23c_three_cone_x <- model.matrix(three_cone ~ ., forty_broad_jump_2_three_cone)
fbj23c_three_cone_y <- forty_broad_jump_2_three_cone$three_cone
fbj23c_three_cone_x 
mean(fbj23c_three_cone_y)

set.seed(2)
fbj23c_three_cone_train <- sample(1:nrow(fbj23c_three_cone_x), .8*nrow(fbj23c_three_cone_x))
fbj23c_three_cone_test <- (-fbj23c_three_cone_train)
fbj23c_three_cone_y.test <- fbj23c_three_cone_y[fbj23c_three_cone_test]

grid <- 10^seq(-5, 5, length = 100)

fbj23c_three_cone_lasso.mod <- glmnet(fbj23c_three_cone_x[fbj23c_three_cone_train, ], fbj23c_three_cone_y[fbj23c_three_cone_train], alpha = 1,
    lambda = grid,intercept = TRUE ,standardize = TRUE)
plot(fbj23c_three_cone_lasso.mod)

set.seed(1)
fbj23c_three_cone_cv.out <- cv.glmnet(fbj23c_three_cone_x[fbj23c_three_cone_train, ], fbj23c_three_cone_y[fbj23c_three_cone_train], alpha = 1)
#plot(fbj23c_three_cone_cv.out)
fbj23c_three_cone_bestlam <- fbj23c_three_cone_cv.out$lambda.min
#fbj23c_three_cone_bestlam <- 1
fbj23c_three_cone_lasso.pred <- predict(fbj23c_three_cone_lasso.mod, s = fbj23c_three_cone_bestlam,
    newx = fbj23c_three_cone_x[fbj23c_three_cone_test, ])
mean((fbj23c_three_cone_lasso.pred - fbj23c_three_cone_y.test)^2)

fbj23c_three_cone_out <- glmnet(fbj23c_three_cone_x, fbj23c_three_cone_y, alpha = 1, lambda = fbj23c_three_cone_bestlam )
coef(fbj23c_three_cone_out)
fbj23c_three_cone_lasso.coef <- predict(fbj23c_three_cone_out, type = "coefficients",
    s = fbj23c_three_cone_bestlam)[1:(ncol(forty_2_three_cone)+2), ]
fbj23c_three_cone_lasso.coef
fbj23c_three_cone_lasso.coef[fbj23c_three_cone_lasso.coef != 0]

ggplot(forty_broad_jump_2_three_cone[-fbj23c_three_cone_train,] %>% mutate(pred = fbj23c_three_cone_lasso.pred),
       aes(x = pred, three_cone)) +
  geom_point()



fbj23c_three_cone_x_scale <- model.matrix(scale(three_cone) ~ scale(forty) + scale(broad_jump), forty_broad_jump_2_three_cone)
fbj23c_three_cone_y_scale <- (forty_broad_jump_2_three_cone %>% mutate(three_cone = scale(three_cone)))$three_cone

set.seed(2)
fbj23c_three_cone_train <- sample(1:nrow(fbj23c_three_cone_x_scale), .8*nrow(fbj23c_three_cone_x_scale))
fbj23c_three_cone_test <- (-fbj23c_three_cone_train)
fbj23c_three_cone_y.test_scale <- fbj23c_three_cone_y_scale[fbj23c_three_cone_test]

fbj23c_three_cone_lasso.mod_scale <- glmnet(fbj23c_three_cone_x_scale[fbj23c_three_cone_train, ], fbj23c_three_cone_y_scale[fbj23c_three_cone_train], alpha = 1,
    lambda = grid,intercept = TRUE ,standardize = TRUE)

set.seed(1)
fbj23c_three_cone_cv.out_scale <- cv.glmnet(fbj23c_three_cone_x_scale[fbj23c_three_cone_train, ], fbj23c_three_cone_y_scale[fbj23c_three_cone_train], alpha = 1)
#plot(fbj23c_three_cone_cv.out)
fbj23c_three_cone_bestlam_scale <- fbj23c_three_cone_cv.out_scale$lambda.min
#fbj23c_three_cone_bestlam <- 1
fbj23c_three_cone_lasso.pred_scale <- predict(fbj23c_three_cone_lasso.mod_scale, s = fbj23c_three_cone_bestlam_scale,
    newx = fbj23c_three_cone_x_scale[fbj23c_three_cone_test, ])
mean((fbj23c_three_cone_lasso.pred_scale - fbj23c_three_cone_y.test_scale)^2)
```

```{r}
forty_broad_jump_2_shuttle <- combineonly %>% select(forty, broad_jump, shuttle) %>% 
  filter(!is.na(forty) & !is.na(broad_jump) & !is.na(shuttle))


fbj2s_shuttle_x <- model.matrix(shuttle ~ ., forty_broad_jump_2_shuttle)
fbj2s_shuttle_y <- forty_broad_jump_2_shuttle$shuttle
fbj2s_shuttle_x 
mean(fbj2s_shuttle_y)

set.seed(2)
fbj2s_shuttle_train <- sample(1:nrow(fbj2s_shuttle_x), .8*nrow(fbj2s_shuttle_x))
fbj2s_shuttle_test <- (-fbj2s_shuttle_train)
fbj2s_shuttle_y.test <- fbj2s_shuttle_y[fbj2s_shuttle_test]

grid <- 10^seq(-5, 5, length = 100)

fbj2s_shuttle_lasso.mod <- glmnet(fbj2s_shuttle_x[fbj2s_shuttle_train, ], fbj2s_shuttle_y[fbj2s_shuttle_train], alpha = 1,
    lambda = grid,intercept = TRUE ,standardize = TRUE)
plot(fbj2s_shuttle_lasso.mod)

set.seed(1)
fbj2s_shuttle_cv.out <- cv.glmnet(fbj2s_shuttle_x[fbj2s_shuttle_train, ], fbj2s_shuttle_y[fbj2s_shuttle_train], alpha = 1)
#plot(fbj2s_shuttle_cv.out)
fbj2s_shuttle_bestlam <- fbj2s_shuttle_cv.out$lambda.min
#fbj2s_shuttle_bestlam <- 1
fbj2s_shuttle_lasso.pred <- predict(fbj2s_shuttle_lasso.mod, s = fbj2s_shuttle_bestlam,
    newx = fbj2s_shuttle_x[fbj2s_shuttle_test, ])
mean((fbj2s_shuttle_lasso.pred - fbj2s_shuttle_y.test)^2)

fbj2s_shuttle_out <- glmnet(fbj2s_shuttle_x, fbj2s_shuttle_y, alpha = 1, lambda = fbj2s_shuttle_bestlam )
coef(fbj2s_shuttle_out)
fbj2s_shuttle_lasso.coef <- predict(fbj2s_shuttle_out, type = "coefficients",
    s = fbj2s_shuttle_bestlam)[1:(ncol(forty_2_shuttle)+2), ]
fbj2s_shuttle_lasso.coef
fbj2s_shuttle_lasso.coef[fbj2s_shuttle_lasso.coef != 0]

ggplot(forty_broad_jump_2_shuttle[-fbj2s_shuttle_train,] %>% mutate(pred = fbj2s_shuttle_lasso.pred),
       aes(x = pred, shuttle)) +
  geom_point()



fbj2s_shuttle_x_scale <- model.matrix(scale(shuttle) ~ scale(forty) + scale(broad_jump), forty_broad_jump_2_shuttle)
fbj2s_shuttle_y_scale <- (forty_broad_jump_2_shuttle %>% mutate(shuttle = scale(shuttle)))$shuttle

set.seed(2)
fbj2s_shuttle_train <- sample(1:nrow(fbj2s_shuttle_x_scale), .8*nrow(fbj2s_shuttle_x_scale))
fbj2s_shuttle_test <- (-fbj2s_shuttle_train)
fbj2s_shuttle_y.test_scale <- fbj2s_shuttle_y_scale[fbj2s_shuttle_test]

fbj2s_shuttle_lasso.mod_scale <- glmnet(fbj2s_shuttle_x_scale[fbj2s_shuttle_train, ], fbj2s_shuttle_y_scale[fbj2s_shuttle_train], alpha = 1,
    lambda = grid,intercept = TRUE ,standardize = TRUE)

set.seed(1)
fbj2s_shuttle_cv.out_scale <- cv.glmnet(fbj2s_shuttle_x_scale[fbj2s_shuttle_train, ], fbj2s_shuttle_y_scale[fbj2s_shuttle_train], alpha = 1)
#plot(fbj2s_shuttle_cv.out)
fbj2s_shuttle_bestlam_scale <- fbj2s_shuttle_cv.out_scale$lambda.min
#fbj2s_shuttle_bestlam <- 1
fbj2s_shuttle_lasso.pred_scale <- predict(fbj2s_shuttle_lasso.mod_scale, s = fbj2s_shuttle_bestlam_scale,
    newx = fbj2s_shuttle_x_scale[fbj2s_shuttle_test, ])
mean((fbj2s_shuttle_lasso.pred_scale - fbj2s_shuttle_y.test_scale)^2)
```

# If player only has forty and broad jump predict vertical
```{r}
update4 <- update3 %>% mutate(vertical = if_else(
                           !is.na(forty) & is.na(vertical) & !is.na(broad_jump) & is.na(three_cone) & is.na(shuttle),
                           fbj2v_vertical_lasso.coef[fbj2v_vertical_lasso.coef != 0][1] +
                             fbj2v_vertical_lasso.coef[fbj2v_vertical_lasso.coef != 0][2] * forty +
                             fbj2v_vertical_lasso.coef[fbj2v_vertical_lasso.coef != 0][3] * broad_jump,
                           vertical
                         )) 
```

# Use vertical and broad jump to predict
```{r}
broad_jump_vertical_2_forty <- combineonly %>% select(broad_jump, vertical, forty) %>% 
  filter(!is.na(broad_jump) & !is.na(vertical) & !is.na(forty))


bjv2f_forty_x <- model.matrix(forty ~ ., broad_jump_vertical_2_forty)
bjv2f_forty_y <- broad_jump_vertical_2_forty$forty
bjv2f_forty_x 
mean(bjv2f_forty_y)

set.seed(2)
bjv2f_forty_train <- sample(1:nrow(bjv2f_forty_x), .8*nrow(bjv2f_forty_x))
bjv2f_forty_test <- (-bjv2f_forty_train)
bjv2f_forty_y.test <- bjv2f_forty_y[bjv2f_forty_test]

grid <- 10^seq(-5, 5, length = 100)

bjv2f_forty_lasso.mod <- glmnet(bjv2f_forty_x[bjv2f_forty_train, ], bjv2f_forty_y[bjv2f_forty_train], alpha = 1,
    lambda = grid,intercept = TRUE ,standardize = TRUE)
plot(bjv2f_forty_lasso.mod)

set.seed(1)
bjv2f_forty_cv.out <- cv.glmnet(bjv2f_forty_x[bjv2f_forty_train, ], bjv2f_forty_y[bjv2f_forty_train], alpha = 1)
#plot(bjv2f_forty_cv.out)
bjv2f_forty_bestlam <- bjv2f_forty_cv.out$lambda.min
#bjv2f_forty_bestlam <- 1
bjv2f_forty_lasso.pred <- predict(bjv2f_forty_lasso.mod, s = bjv2f_forty_bestlam,
    newx = bjv2f_forty_x[bjv2f_forty_test, ])
mean((bjv2f_forty_lasso.pred - bjv2f_forty_y.test)^2)

bjv2f_forty_out <- glmnet(bjv2f_forty_x, bjv2f_forty_y, alpha = 1, lambda = bjv2f_forty_bestlam )
coef(bjv2f_forty_out)
bjv2f_forty_lasso.coef <- predict(bjv2f_forty_out, type = "coefficients",
    s = bjv2f_forty_bestlam)[1:(ncol(broad_jump_vertical_2_forty)+1), ]
bjv2f_forty_lasso.coef
bjv2f_forty_lasso.coef[bjv2f_forty_lasso.coef != 0]

ggplot(broad_jump_vertical_2_forty[-bjv2f_forty_train,] %>% mutate(pred = bjv2f_forty_lasso.pred),
       aes(x = pred, forty)) +
  geom_point()



bjv2f_forty_x_scale <- model.matrix(scale(forty) ~ scale(broad_jump) + scale(vertical), broad_jump_vertical_2_forty)
bjv2f_forty_y_scale <- (broad_jump_vertical_2_forty %>% mutate(forty = scale(forty)))$forty

set.seed(2)
bjv2f_forty_train <- sample(1:nrow(bjv2f_forty_x_scale), .8*nrow(bjv2f_forty_x_scale))
bjv2f_forty_test <- (-bjv2f_forty_train)
bjv2f_forty_y.test_scale <- bjv2f_forty_y_scale[bjv2f_forty_test]

bjv2f_forty_lasso.mod_scale <- glmnet(bjv2f_forty_x_scale[bjv2f_forty_train, ], bjv2f_forty_y_scale[bjv2f_forty_train], alpha = 1,
    lambda = grid,intercept = TRUE ,standardize = TRUE)

set.seed(1)
bjv2f_forty_cv.out_scale <- cv.glmnet(bjv2f_forty_x_scale[bjv2f_forty_train, ], bjv2f_forty_y_scale[bjv2f_forty_train], alpha = 1)
#plot(bjv2f_forty_cv.out)
bjv2f_forty_bestlam_scale <- bjv2f_forty_cv.out_scale$lambda.min
#bjv2f_forty_bestlam <- 1
bjv2f_forty_lasso.pred_scale <- predict(bjv2f_forty_lasso.mod_scale, s = bjv2f_forty_bestlam_scale,
    newx = bjv2f_forty_x_scale[bjv2f_forty_test, ])
mean((bjv2f_forty_lasso.pred_scale - bjv2f_forty_y.test_scale)^2)
```

```{r}
broad_jump_vertical_2_three_cone <- combineonly %>% select(broad_jump, vertical, three_cone) %>% 
  filter(!is.na(broad_jump) & !is.na(vertical) & !is.na(three_cone))


bjv23c_three_cone_x <- model.matrix(three_cone ~ ., broad_jump_vertical_2_three_cone)
bjv23c_three_cone_y <- broad_jump_vertical_2_three_cone$three_cone
bjv23c_three_cone_x 
mean(bjv23c_three_cone_y)

set.seed(2)
bjv23c_three_cone_train <- sample(1:nrow(bjv23c_three_cone_x), .8*nrow(bjv23c_three_cone_x))
bjv23c_three_cone_test <- (-bjv23c_three_cone_train)
bjv23c_three_cone_y.test <- bjv23c_three_cone_y[bjv23c_three_cone_test]

grid <- 10^seq(-5, 5, length = 100)

bjv23c_three_cone_lasso.mod <- glmnet(bjv23c_three_cone_x[bjv23c_three_cone_train, ], bjv23c_three_cone_y[bjv23c_three_cone_train], alpha = 1,
    lambda = grid,intercept = TRUE ,standardize = TRUE)
plot(bjv23c_three_cone_lasso.mod)

set.seed(1)
bjv23c_three_cone_cv.out <- cv.glmnet(bjv23c_three_cone_x[bjv23c_three_cone_train, ], bjv23c_three_cone_y[bjv23c_three_cone_train], alpha = 1)
#plot(bjv23c_three_cone_cv.out)
bjv23c_three_cone_bestlam <- bjv23c_three_cone_cv.out$lambda.min
#bjv23c_three_cone_bestlam <- 1
bjv23c_three_cone_lasso.pred <- predict(bjv23c_three_cone_lasso.mod, s = bjv23c_three_cone_bestlam,
    newx = bjv23c_three_cone_x[bjv23c_three_cone_test, ])
mean((bjv23c_three_cone_lasso.pred - bjv23c_three_cone_y.test)^2)

bjv23c_three_cone_out <- glmnet(bjv23c_three_cone_x, bjv23c_three_cone_y, alpha = 1, lambda = bjv23c_three_cone_bestlam )
coef(bjv23c_three_cone_out)
bjv23c_three_cone_lasso.coef <- predict(bjv23c_three_cone_out, type = "coefficients",
    s = bjv23c_three_cone_bestlam)[1:(ncol(broad_jump_vertical_2_three_cone)+1), ]
bjv23c_three_cone_lasso.coef
bjv23c_three_cone_lasso.coef[bjv23c_three_cone_lasso.coef != 0]

ggplot(broad_jump_vertical_2_three_cone[-bjv23c_three_cone_train,] %>% mutate(pred = bjv23c_three_cone_lasso.pred),
       aes(x = pred, three_cone)) +
  geom_point()



bjv23c_three_cone_x_scale <- model.matrix(scale(three_cone) ~ scale(broad_jump) + scale(vertical), broad_jump_vertical_2_three_cone)
bjv23c_three_cone_y_scale <- (broad_jump_vertical_2_three_cone %>% mutate(three_cone = scale(three_cone)))$three_cone

set.seed(2)
bjv23c_three_cone_train <- sample(1:nrow(bjv23c_three_cone_x_scale), .8*nrow(bjv23c_three_cone_x_scale))
bjv23c_three_cone_test <- (-bjv23c_three_cone_train)
bjv23c_three_cone_y.test_scale <- bjv23c_three_cone_y_scale[bjv23c_three_cone_test]

bjv23c_three_cone_lasso.mod_scale <- glmnet(bjv23c_three_cone_x_scale[bjv23c_three_cone_train, ], bjv23c_three_cone_y_scale[bjv23c_three_cone_train], alpha = 1,
    lambda = grid,intercept = TRUE ,standardize = TRUE)

set.seed(1)
bjv23c_three_cone_cv.out_scale <- cv.glmnet(bjv23c_three_cone_x_scale[bjv23c_three_cone_train, ], bjv23c_three_cone_y_scale[bjv23c_three_cone_train], alpha = 1)
#plot(bjv23c_three_cone_cv.out)
bjv23c_three_cone_bestlam_scale <- bjv23c_three_cone_cv.out_scale$lambda.min
#bjv23c_three_cone_bestlam <- 1
bjv23c_three_cone_lasso.pred_scale <- predict(bjv23c_three_cone_lasso.mod_scale, s = bjv23c_three_cone_bestlam_scale,
    newx = bjv23c_three_cone_x_scale[bjv23c_three_cone_test, ])
mean((bjv23c_three_cone_lasso.pred_scale - bjv23c_three_cone_y.test_scale)^2)
```

```{r}
broad_jump_vertical_2_shuttle <- combineonly %>% select(broad_jump, vertical, shuttle) %>% 
  filter(!is.na(broad_jump) & !is.na(vertical) & !is.na(shuttle))


bjv2s_shuttle_x <- model.matrix(shuttle ~ ., broad_jump_vertical_2_shuttle)
bjv2s_shuttle_y <- broad_jump_vertical_2_shuttle$shuttle
bjv2s_shuttle_x 
mean(bjv2s_shuttle_y)

set.seed(2)
bjv2s_shuttle_train <- sample(1:nrow(bjv2s_shuttle_x), .8*nrow(bjv2s_shuttle_x))
bjv2s_shuttle_test <- (-bjv2s_shuttle_train)
bjv2s_shuttle_y.test <- bjv2s_shuttle_y[bjv2s_shuttle_test]

grid <- 10^seq(-5, 5, length = 100)

bjv2s_shuttle_lasso.mod <- glmnet(bjv2s_shuttle_x[bjv2s_shuttle_train, ], bjv2s_shuttle_y[bjv2s_shuttle_train], alpha = 1,
    lambda = grid,intercept = TRUE ,standardize = TRUE)
plot(bjv2s_shuttle_lasso.mod)

set.seed(1)
bjv2s_shuttle_cv.out <- cv.glmnet(bjv2s_shuttle_x[bjv2s_shuttle_train, ], bjv2s_shuttle_y[bjv2s_shuttle_train], alpha = 1)
#plot(bjv2s_shuttle_cv.out)
bjv2s_shuttle_bestlam <- bjv2s_shuttle_cv.out$lambda.min
#bjv2s_shuttle_bestlam <- 1
bjv2s_shuttle_lasso.pred <- predict(bjv2s_shuttle_lasso.mod, s = bjv2s_shuttle_bestlam,
    newx = bjv2s_shuttle_x[bjv2s_shuttle_test, ])
mean((bjv2s_shuttle_lasso.pred - bjv2s_shuttle_y.test)^2)

bjv2s_shuttle_out <- glmnet(bjv2s_shuttle_x, bjv2s_shuttle_y, alpha = 1, lambda = bjv2s_shuttle_bestlam )
coef(bjv2s_shuttle_out)
bjv2s_shuttle_lasso.coef <- predict(bjv2s_shuttle_out, type = "coefficients",
    s = bjv2s_shuttle_bestlam)[1:(ncol(broad_jump_vertical_2_shuttle)+1), ]
bjv2s_shuttle_lasso.coef
bjv2s_shuttle_lasso.coef[bjv2s_shuttle_lasso.coef != 0]

ggplot(broad_jump_vertical_2_shuttle[-bjv2s_shuttle_train,] %>% mutate(pred = bjv2s_shuttle_lasso.pred),
       aes(x = pred, shuttle)) +
  geom_point()



bjv2s_shuttle_x_scale <- model.matrix(scale(shuttle) ~ scale(broad_jump) + scale(vertical), broad_jump_vertical_2_shuttle)
bjv2s_shuttle_y_scale <- (broad_jump_vertical_2_shuttle %>% mutate(shuttle = scale(shuttle)))$shuttle

set.seed(2)
bjv2s_shuttle_train <- sample(1:nrow(bjv2s_shuttle_x_scale), .8*nrow(bjv2s_shuttle_x_scale))
bjv2s_shuttle_test <- (-bjv2s_shuttle_train)
bjv2s_shuttle_y.test_scale <- bjv2s_shuttle_y_scale[bjv2s_shuttle_test]

bjv2s_shuttle_lasso.mod_scale <- glmnet(bjv2s_shuttle_x_scale[bjv2s_shuttle_train, ], bjv2s_shuttle_y_scale[bjv2s_shuttle_train], alpha = 1,
    lambda = grid,intercept = TRUE ,standardize = TRUE)

set.seed(1)
bjv2s_shuttle_cv.out_scale <- cv.glmnet(bjv2s_shuttle_x_scale[bjv2s_shuttle_train, ], bjv2s_shuttle_y_scale[bjv2s_shuttle_train], alpha = 1)
#plot(bjv2s_shuttle_cv.out)
bjv2s_shuttle_bestlam_scale <- bjv2s_shuttle_cv.out_scale$lambda.min
#bjv2s_shuttle_bestlam <- 1
bjv2s_shuttle_lasso.pred_scale <- predict(bjv2s_shuttle_lasso.mod_scale, s = bjv2s_shuttle_bestlam_scale,
    newx = bjv2s_shuttle_x_scale[bjv2s_shuttle_test, ])
mean((bjv2s_shuttle_lasso.pred_scale - bjv2s_shuttle_y.test_scale)^2)
```

# If player only has broad jump and vertical predict forty
```{r}
update5 <- update4 %>% mutate(forty = if_else(
                           is.na(forty) & !is.na(vertical) & !is.na(broad_jump) & is.na(three_cone) & is.na(shuttle),
                           bjv2f_forty_lasso.coef[bjv2f_forty_lasso.coef != 0][1] +
                             bjv2f_forty_lasso.coef[bjv2f_forty_lasso.coef != 0][2] * broad_jump +
                             bjv2f_forty_lasso.coef[bjv2f_forty_lasso.coef != 0][3] * vertical,
                           forty
                         )) 
```

# Use forty and three cone to predict
```{r}
forty_three_cone_2_vertical <- combineonly %>% select(forty, three_cone, vertical) %>% 
  filter(!is.na(forty) & !is.na(three_cone) & !is.na(vertical))


f3c2v_vertical_x <- model.matrix(vertical ~ ., forty_three_cone_2_vertical)
f3c2v_vertical_y <- forty_three_cone_2_vertical$vertical
f3c2v_vertical_x 
mean(f3c2v_vertical_y)

set.seed(2)
f3c2v_vertical_train <- sample(1:nrow(f3c2v_vertical_x), .8*nrow(f3c2v_vertical_x))
f3c2v_vertical_test <- (-f3c2v_vertical_train)
f3c2v_vertical_y.test <- f3c2v_vertical_y[f3c2v_vertical_test]

grid <- 10^seq(-5, 5, length = 100)

f3c2v_vertical_lasso.mod <- glmnet(f3c2v_vertical_x[f3c2v_vertical_train, ], f3c2v_vertical_y[f3c2v_vertical_train], alpha = 1,
    lambda = grid,intercept = TRUE ,standardize = TRUE)
plot(f3c2v_vertical_lasso.mod)

set.seed(1)
f3c2v_vertical_cv.out <- cv.glmnet(f3c2v_vertical_x[f3c2v_vertical_train, ], f3c2v_vertical_y[f3c2v_vertical_train], alpha = 1)
#plot(f3c2v_vertical_cv.out)
f3c2v_vertical_bestlam <- f3c2v_vertical_cv.out$lambda.min
#f3c2v_vertical_bestlam <- 1
f3c2v_vertical_lasso.pred <- predict(f3c2v_vertical_lasso.mod, s = f3c2v_vertical_bestlam,
    newx = f3c2v_vertical_x[f3c2v_vertical_test, ])
mean((f3c2v_vertical_lasso.pred - f3c2v_vertical_y.test)^2)

f3c2v_vertical_out <- glmnet(f3c2v_vertical_x, f3c2v_vertical_y, alpha = 1, lambda = f3c2v_vertical_bestlam )
coef(f3c2v_vertical_out)
f3c2v_vertical_lasso.coef <- predict(f3c2v_vertical_out, type = "coefficients",
    s = f3c2v_vertical_bestlam)[1:(ncol(forty_2_vertical)+2), ]
f3c2v_vertical_lasso.coef
f3c2v_vertical_lasso.coef[f3c2v_vertical_lasso.coef != 0]

ggplot(forty_three_cone_2_vertical[-f3c2v_vertical_train,] %>% mutate(pred = f3c2v_vertical_lasso.pred),
       aes(x = pred, vertical)) +
  geom_point()



f3c2v_vertical_x_scale <- model.matrix(scale(vertical) ~ scale(forty) + scale(three_cone), forty_three_cone_2_vertical)
f3c2v_vertical_y_scale <- (forty_three_cone_2_vertical %>% mutate(vertical = scale(vertical)))$vertical

set.seed(2)
f3c2v_vertical_train <- sample(1:nrow(f3c2v_vertical_x_scale), .8*nrow(f3c2v_vertical_x_scale))
f3c2v_vertical_test <- (-f3c2v_vertical_train)
f3c2v_vertical_y.test_scale <- f3c2v_vertical_y_scale[f3c2v_vertical_test]

f3c2v_vertical_lasso.mod_scale <- glmnet(f3c2v_vertical_x_scale[f3c2v_vertical_train, ], f3c2v_vertical_y_scale[f3c2v_vertical_train], alpha = 1,
    lambda = grid,intercept = TRUE ,standardize = TRUE)

set.seed(1)
f3c2v_vertical_cv.out_scale <- cv.glmnet(f3c2v_vertical_x_scale[f3c2v_vertical_train, ], f3c2v_vertical_y_scale[f3c2v_vertical_train], alpha = 1)
#plot(f3c2v_vertical_cv.out)
f3c2v_vertical_bestlam_scale <- f3c2v_vertical_cv.out_scale$lambda.min
#f3c2v_vertical_bestlam <- 1
f3c2v_vertical_lasso.pred_scale <- predict(f3c2v_vertical_lasso.mod_scale, s = f3c2v_vertical_bestlam_scale,
    newx = f3c2v_vertical_x_scale[f3c2v_vertical_test, ])
mean((f3c2v_vertical_lasso.pred_scale - f3c2v_vertical_y.test_scale)^2)
```

```{r}
forty_three_cone_2_broad_jump <- combineonly %>% select(forty, three_cone, broad_jump) %>% 
  filter(!is.na(forty) & !is.na(three_cone) & !is.na(broad_jump))


f3c2bj_broad_jump_x <- model.matrix(broad_jump ~ ., forty_three_cone_2_broad_jump)
f3c2bj_broad_jump_y <- forty_three_cone_2_broad_jump$broad_jump
f3c2bj_broad_jump_x 
mean(f3c2bj_broad_jump_y)

set.seed(2)
f3c2bj_broad_jump_train <- sample(1:nrow(f3c2bj_broad_jump_x), .8*nrow(f3c2bj_broad_jump_x))
f3c2bj_broad_jump_test <- (-f3c2bj_broad_jump_train)
f3c2bj_broad_jump_y.test <- f3c2bj_broad_jump_y[f3c2bj_broad_jump_test]

grid <- 10^seq(-5, 5, length = 100)

f3c2bj_broad_jump_lasso.mod <- glmnet(f3c2bj_broad_jump_x[f3c2bj_broad_jump_train, ], f3c2bj_broad_jump_y[f3c2bj_broad_jump_train], alpha = 1,
    lambda = grid,intercept = TRUE ,standardize = TRUE)
plot(f3c2bj_broad_jump_lasso.mod)

set.seed(1)
f3c2bj_broad_jump_cv.out <- cv.glmnet(f3c2bj_broad_jump_x[f3c2bj_broad_jump_train, ], f3c2bj_broad_jump_y[f3c2bj_broad_jump_train], alpha = 1)
#plot(f3c2bj_broad_jump_cv.out)
f3c2bj_broad_jump_bestlam <- f3c2bj_broad_jump_cv.out$lambda.min
#f3c2bj_broad_jump_bestlam <- 1
f3c2bj_broad_jump_lasso.pred <- predict(f3c2bj_broad_jump_lasso.mod, s = f3c2bj_broad_jump_bestlam,
    newx = f3c2bj_broad_jump_x[f3c2bj_broad_jump_test, ])
mean((f3c2bj_broad_jump_lasso.pred - f3c2bj_broad_jump_y.test)^2)

f3c2bj_broad_jump_out <- glmnet(f3c2bj_broad_jump_x, f3c2bj_broad_jump_y, alpha = 1, lambda = f3c2bj_broad_jump_bestlam )
coef(f3c2bj_broad_jump_out)
f3c2bj_broad_jump_lasso.coef <- predict(f3c2bj_broad_jump_out, type = "coefficients",
    s = f3c2bj_broad_jump_bestlam)[1:(ncol(forty_2_broad_jump)+2), ]
f3c2bj_broad_jump_lasso.coef
f3c2bj_broad_jump_lasso.coef[f3c2bj_broad_jump_lasso.coef != 0]

ggplot(forty_three_cone_2_broad_jump[-f3c2bj_broad_jump_train,] %>% mutate(pred = f3c2bj_broad_jump_lasso.pred),
       aes(x = pred, broad_jump)) +
  geom_point()



f3c2bj_broad_jump_x_scale <- model.matrix(scale(broad_jump) ~ scale(forty) + scale(three_cone), forty_three_cone_2_broad_jump)
f3c2bj_broad_jump_y_scale <- (forty_three_cone_2_broad_jump %>% mutate(broad_jump = scale(broad_jump)))$broad_jump

set.seed(2)
f3c2bj_broad_jump_train <- sample(1:nrow(f3c2bj_broad_jump_x_scale), .8*nrow(f3c2bj_broad_jump_x_scale))
f3c2bj_broad_jump_test <- (-f3c2bj_broad_jump_train)
f3c2bj_broad_jump_y.test_scale <- f3c2bj_broad_jump_y_scale[f3c2bj_broad_jump_test]

f3c2bj_broad_jump_lasso.mod_scale <- glmnet(f3c2bj_broad_jump_x_scale[f3c2bj_broad_jump_train, ], f3c2bj_broad_jump_y_scale[f3c2bj_broad_jump_train], alpha = 1,
    lambda = grid,intercept = TRUE ,standardize = TRUE)

set.seed(1)
f3c2bj_broad_jump_cv.out_scale <- cv.glmnet(f3c2bj_broad_jump_x_scale[f3c2bj_broad_jump_train, ], f3c2bj_broad_jump_y_scale[f3c2bj_broad_jump_train], alpha = 1)
#plot(f3c2bj_broad_jump_cv.out)
f3c2bj_broad_jump_bestlam_scale <- f3c2bj_broad_jump_cv.out_scale$lambda.min
#f3c2bj_broad_jump_bestlam <- 1
f3c2bj_broad_jump_lasso.pred_scale <- predict(f3c2bj_broad_jump_lasso.mod_scale, s = f3c2bj_broad_jump_bestlam_scale,
    newx = f3c2bj_broad_jump_x_scale[f3c2bj_broad_jump_test, ])
mean((f3c2bj_broad_jump_lasso.pred_scale - f3c2bj_broad_jump_y.test_scale)^2)
```

```{r}
forty_three_cone_2_shuttle <- combineonly %>% select(forty, three_cone, shuttle) %>% 
  filter(!is.na(forty) & !is.na(three_cone) & !is.na(shuttle))


f3c2s_shuttle_x <- model.matrix(shuttle ~ ., forty_three_cone_2_shuttle)
f3c2s_shuttle_y <- forty_three_cone_2_shuttle$shuttle
f3c2s_shuttle_x 
mean(f3c2s_shuttle_y)

set.seed(2)
f3c2s_shuttle_train <- sample(1:nrow(f3c2s_shuttle_x), .8*nrow(f3c2s_shuttle_x))
f3c2s_shuttle_test <- (-f3c2s_shuttle_train)
f3c2s_shuttle_y.test <- f3c2s_shuttle_y[f3c2s_shuttle_test]

grid <- 10^seq(-5, 5, length = 100)

f3c2s_shuttle_lasso.mod <- glmnet(f3c2s_shuttle_x[f3c2s_shuttle_train, ], f3c2s_shuttle_y[f3c2s_shuttle_train], alpha = 1,
    lambda = grid,intercept = TRUE ,standardize = TRUE)
plot(f3c2s_shuttle_lasso.mod)

set.seed(1)
f3c2s_shuttle_cv.out <- cv.glmnet(f3c2s_shuttle_x[f3c2s_shuttle_train, ], f3c2s_shuttle_y[f3c2s_shuttle_train], alpha = 1)
#plot(f3c2s_shuttle_cv.out)
f3c2s_shuttle_bestlam <- f3c2s_shuttle_cv.out$lambda.min
#f3c2s_shuttle_bestlam <- 1
f3c2s_shuttle_lasso.pred <- predict(f3c2s_shuttle_lasso.mod, s = f3c2s_shuttle_bestlam,
    newx = f3c2s_shuttle_x[f3c2s_shuttle_test, ])
mean((f3c2s_shuttle_lasso.pred - f3c2s_shuttle_y.test)^2)

f3c2s_shuttle_out <- glmnet(f3c2s_shuttle_x, f3c2s_shuttle_y, alpha = 1, lambda = f3c2s_shuttle_bestlam )
coef(f3c2s_shuttle_out)
f3c2s_shuttle_lasso.coef <- predict(f3c2s_shuttle_out, type = "coefficients",
    s = f3c2s_shuttle_bestlam)[1:(ncol(forty_2_shuttle)+2), ]
f3c2s_shuttle_lasso.coef
f3c2s_shuttle_lasso.coef[f3c2s_shuttle_lasso.coef != 0]

ggplot(forty_three_cone_2_shuttle[-f3c2s_shuttle_train,] %>% mutate(pred = f3c2s_shuttle_lasso.pred),
       aes(x = pred, shuttle)) +
  geom_point()



f3c2s_shuttle_x_scale <- model.matrix(scale(shuttle) ~ scale(forty) + scale(three_cone), forty_three_cone_2_shuttle)
f3c2s_shuttle_y_scale <- (forty_three_cone_2_shuttle %>% mutate(shuttle = scale(shuttle)))$shuttle

set.seed(2)
f3c2s_shuttle_train <- sample(1:nrow(f3c2s_shuttle_x_scale), .8*nrow(f3c2s_shuttle_x_scale))
f3c2s_shuttle_test <- (-f3c2s_shuttle_train)
f3c2s_shuttle_y.test_scale <- f3c2s_shuttle_y_scale[f3c2s_shuttle_test]

f3c2s_shuttle_lasso.mod_scale <- glmnet(f3c2s_shuttle_x_scale[f3c2s_shuttle_train, ], f3c2s_shuttle_y_scale[f3c2s_shuttle_train], alpha = 1,
    lambda = grid,intercept = TRUE ,standardize = TRUE)

set.seed(1)
f3c2s_shuttle_cv.out_scale <- cv.glmnet(f3c2s_shuttle_x_scale[f3c2s_shuttle_train, ], f3c2s_shuttle_y_scale[f3c2s_shuttle_train], alpha = 1)
#plot(f3c2s_shuttle_cv.out)
f3c2s_shuttle_bestlam_scale <- f3c2s_shuttle_cv.out_scale$lambda.min
#f3c2s_shuttle_bestlam <- 1
f3c2s_shuttle_lasso.pred_scale <- predict(f3c2s_shuttle_lasso.mod_scale, s = f3c2s_shuttle_bestlam_scale,
    newx = f3c2s_shuttle_x_scale[f3c2s_shuttle_test, ])
mean((f3c2s_shuttle_lasso.pred_scale - f3c2s_shuttle_y.test_scale)^2)
```

# If player only has forty and three cone predict shuttle
```{r}
update6 <- update5 %>% mutate(shuttle = if_else(
                           !is.na(forty) & is.na(vertical) & is.na(broad_jump) & !is.na(three_cone) & is.na(shuttle),
                           f3c2s_shuttle_lasso.coef[f3c2s_shuttle_lasso.coef != 0][1] +
                             f3c2s_shuttle_lasso.coef[f3c2s_shuttle_lasso.coef != 0][2] * forty +
                             f3c2s_shuttle_lasso.coef[f3c2s_shuttle_lasso.coef != 0][3] * three_cone,
                           shuttle
                         )) 
```

# Use forty and shuttle to predict
```{r}
forty_shuttle_2_vertical <- combineonly %>% select(forty, shuttle, vertical) %>% 
  filter(!is.na(forty) & !is.na(shuttle) & !is.na(vertical))


fs2v_vertical_x <- model.matrix(vertical ~ ., forty_shuttle_2_vertical)
fs2v_vertical_y <- forty_shuttle_2_vertical$vertical
fs2v_vertical_x 
mean(fs2v_vertical_y)

set.seed(2)
fs2v_vertical_train <- sample(1:nrow(fs2v_vertical_x), .8*nrow(fs2v_vertical_x))
fs2v_vertical_test <- (-fs2v_vertical_train)
fs2v_vertical_y.test <- fs2v_vertical_y[fs2v_vertical_test]

grid <- 10^seq(-5, 5, length = 100)

fs2v_vertical_lasso.mod <- glmnet(fs2v_vertical_x[fs2v_vertical_train, ], fs2v_vertical_y[fs2v_vertical_train], alpha = 1,
    lambda = grid,intercept = TRUE ,standardize = TRUE)
plot(fs2v_vertical_lasso.mod)

set.seed(1)
fs2v_vertical_cv.out <- cv.glmnet(fs2v_vertical_x[fs2v_vertical_train, ], fs2v_vertical_y[fs2v_vertical_train], alpha = 1)
#plot(fs2v_vertical_cv.out)
fs2v_vertical_bestlam <- fs2v_vertical_cv.out$lambda.min
#fs2v_vertical_bestlam <- 1
fs2v_vertical_lasso.pred <- predict(fs2v_vertical_lasso.mod, s = fs2v_vertical_bestlam,
    newx = fs2v_vertical_x[fs2v_vertical_test, ])
mean((fs2v_vertical_lasso.pred - fs2v_vertical_y.test)^2)

fs2v_vertical_out <- glmnet(fs2v_vertical_x, fs2v_vertical_y, alpha = 1, lambda = fs2v_vertical_bestlam )
coef(fs2v_vertical_out)
fs2v_vertical_lasso.coef <- predict(fs2v_vertical_out, type = "coefficients",
    s = fs2v_vertical_bestlam)[1:(ncol(forty_2_vertical)+2), ]
fs2v_vertical_lasso.coef
fs2v_vertical_lasso.coef[fs2v_vertical_lasso.coef != 0]

ggplot(forty_shuttle_2_vertical[-fs2v_vertical_train,] %>% mutate(pred = fs2v_vertical_lasso.pred),
       aes(x = pred, vertical)) +
  geom_point()



fs2v_vertical_x_scale <- model.matrix(scale(vertical) ~ scale(forty) + scale(shuttle), forty_shuttle_2_vertical)
fs2v_vertical_y_scale <- (forty_shuttle_2_vertical %>% mutate(vertical = scale(vertical)))$vertical

set.seed(2)
fs2v_vertical_train <- sample(1:nrow(fs2v_vertical_x_scale), .8*nrow(fs2v_vertical_x_scale))
fs2v_vertical_test <- (-fs2v_vertical_train)
fs2v_vertical_y.test_scale <- fs2v_vertical_y_scale[fs2v_vertical_test]

fs2v_vertical_lasso.mod_scale <- glmnet(fs2v_vertical_x_scale[fs2v_vertical_train, ], fs2v_vertical_y_scale[fs2v_vertical_train], alpha = 1,
    lambda = grid,intercept = TRUE ,standardize = TRUE)

set.seed(1)
fs2v_vertical_cv.out_scale <- cv.glmnet(fs2v_vertical_x_scale[fs2v_vertical_train, ], fs2v_vertical_y_scale[fs2v_vertical_train], alpha = 1)
#plot(fs2v_vertical_cv.out)
fs2v_vertical_bestlam_scale <- fs2v_vertical_cv.out_scale$lambda.min
#fs2v_vertical_bestlam <- 1
fs2v_vertical_lasso.pred_scale <- predict(fs2v_vertical_lasso.mod_scale, s = fs2v_vertical_bestlam_scale,
    newx = fs2v_vertical_x_scale[fs2v_vertical_test, ])
mean((fs2v_vertical_lasso.pred_scale - fs2v_vertical_y.test_scale)^2)
```

```{r}
forty_shuttle_2_broad_jump <- combineonly %>% select(forty, shuttle, broad_jump) %>% 
  filter(!is.na(forty) & !is.na(shuttle) & !is.na(broad_jump))


fs2bj_broad_jump_x <- model.matrix(broad_jump ~ ., forty_shuttle_2_broad_jump)
fs2bj_broad_jump_y <- forty_shuttle_2_broad_jump$broad_jump
fs2bj_broad_jump_x 
mean(fs2bj_broad_jump_y)

set.seed(2)
fs2bj_broad_jump_train <- sample(1:nrow(fs2bj_broad_jump_x), .8*nrow(fs2bj_broad_jump_x))
fs2bj_broad_jump_test <- (-fs2bj_broad_jump_train)
fs2bj_broad_jump_y.test <- fs2bj_broad_jump_y[fs2bj_broad_jump_test]

grid <- 10^seq(-5, 5, length = 100)

fs2bj_broad_jump_lasso.mod <- glmnet(fs2bj_broad_jump_x[fs2bj_broad_jump_train, ], fs2bj_broad_jump_y[fs2bj_broad_jump_train], alpha = 1,
    lambda = grid,intercept = TRUE ,standardize = TRUE)
plot(fs2bj_broad_jump_lasso.mod)

set.seed(1)
fs2bj_broad_jump_cv.out <- cv.glmnet(fs2bj_broad_jump_x[fs2bj_broad_jump_train, ], fs2bj_broad_jump_y[fs2bj_broad_jump_train], alpha = 1)
#plot(fs2bj_broad_jump_cv.out)
fs2bj_broad_jump_bestlam <- fs2bj_broad_jump_cv.out$lambda.min
#fs2bj_broad_jump_bestlam <- 1
fs2bj_broad_jump_lasso.pred <- predict(fs2bj_broad_jump_lasso.mod, s = fs2bj_broad_jump_bestlam,
    newx = fs2bj_broad_jump_x[fs2bj_broad_jump_test, ])
mean((fs2bj_broad_jump_lasso.pred - fs2bj_broad_jump_y.test)^2)

fs2bj_broad_jump_out <- glmnet(fs2bj_broad_jump_x, fs2bj_broad_jump_y, alpha = 1, lambda = fs2bj_broad_jump_bestlam )
coef(fs2bj_broad_jump_out)
fs2bj_broad_jump_lasso.coef <- predict(fs2bj_broad_jump_out, type = "coefficients",
    s = fs2bj_broad_jump_bestlam)[1:(ncol(forty_2_broad_jump)+2), ]
fs2bj_broad_jump_lasso.coef
fs2bj_broad_jump_lasso.coef[fs2bj_broad_jump_lasso.coef != 0]

ggplot(forty_shuttle_2_broad_jump[-fs2bj_broad_jump_train,] %>% mutate(pred = fs2bj_broad_jump_lasso.pred),
       aes(x = pred, broad_jump)) +
  geom_point()



fs2bj_broad_jump_x_scale <- model.matrix(scale(broad_jump) ~ scale(forty) + scale(shuttle), forty_shuttle_2_broad_jump)
fs2bj_broad_jump_y_scale <- (forty_shuttle_2_broad_jump %>% mutate(broad_jump = scale(broad_jump)))$broad_jump

set.seed(2)
fs2bj_broad_jump_train <- sample(1:nrow(fs2bj_broad_jump_x_scale), .8*nrow(fs2bj_broad_jump_x_scale))
fs2bj_broad_jump_test <- (-fs2bj_broad_jump_train)
fs2bj_broad_jump_y.test_scale <- fs2bj_broad_jump_y_scale[fs2bj_broad_jump_test]

fs2bj_broad_jump_lasso.mod_scale <- glmnet(fs2bj_broad_jump_x_scale[fs2bj_broad_jump_train, ], fs2bj_broad_jump_y_scale[fs2bj_broad_jump_train], alpha = 1,
    lambda = grid,intercept = TRUE ,standardize = TRUE)

set.seed(1)
fs2bj_broad_jump_cv.out_scale <- cv.glmnet(fs2bj_broad_jump_x_scale[fs2bj_broad_jump_train, ], fs2bj_broad_jump_y_scale[fs2bj_broad_jump_train], alpha = 1)
#plot(fs2bj_broad_jump_cv.out)
fs2bj_broad_jump_bestlam_scale <- fs2bj_broad_jump_cv.out_scale$lambda.min
#fs2bj_broad_jump_bestlam <- 1
fs2bj_broad_jump_lasso.pred_scale <- predict(fs2bj_broad_jump_lasso.mod_scale, s = fs2bj_broad_jump_bestlam_scale,
    newx = fs2bj_broad_jump_x_scale[fs2bj_broad_jump_test, ])
mean((fs2bj_broad_jump_lasso.pred_scale - fs2bj_broad_jump_y.test_scale)^2)
```

```{r}
forty_shuttle_2_three_cone <- combineonly %>% select(forty, shuttle, three_cone) %>% 
  filter(!is.na(forty) & !is.na(shuttle) & !is.na(three_cone))


fs23c_three_cone_x <- model.matrix(three_cone ~ ., forty_shuttle_2_three_cone)
fs23c_three_cone_y <- forty_shuttle_2_three_cone$three_cone
fs23c_three_cone_x 
mean(fs23c_three_cone_y)

set.seed(2)
fs23c_three_cone_train <- sample(1:nrow(fs23c_three_cone_x), .8*nrow(fs23c_three_cone_x))
fs23c_three_cone_test <- (-fs23c_three_cone_train)
fs23c_three_cone_y.test <- fs23c_three_cone_y[fs23c_three_cone_test]

grid <- 10^seq(-5, 5, length = 100)

fs23c_three_cone_lasso.mod <- glmnet(fs23c_three_cone_x[fs23c_three_cone_train, ], fs23c_three_cone_y[fs23c_three_cone_train], alpha = 1,
    lambda = grid,intercept = TRUE ,standardize = TRUE)
plot(fs23c_three_cone_lasso.mod)

set.seed(1)
fs23c_three_cone_cv.out <- cv.glmnet(fs23c_three_cone_x[fs23c_three_cone_train, ], fs23c_three_cone_y[fs23c_three_cone_train], alpha = 1)
#plot(fs23c_three_cone_cv.out)
fs23c_three_cone_bestlam <- fs23c_three_cone_cv.out$lambda.min
#fs23c_three_cone_bestlam <- 1
fs23c_three_cone_lasso.pred <- predict(fs23c_three_cone_lasso.mod, s = fs23c_three_cone_bestlam,
    newx = fs23c_three_cone_x[fs23c_three_cone_test, ])
mean((fs23c_three_cone_lasso.pred - fs23c_three_cone_y.test)^2)

fs23c_three_cone_out <- glmnet(fs23c_three_cone_x, fs23c_three_cone_y, alpha = 1, lambda = fs23c_three_cone_bestlam )
coef(fs23c_three_cone_out)
fs23c_three_cone_lasso.coef <- predict(fs23c_three_cone_out, type = "coefficients",
    s = fs23c_three_cone_bestlam)[1:(ncol(forty_2_three_cone)+2), ]
fs23c_three_cone_lasso.coef
fs23c_three_cone_lasso.coef[fs23c_three_cone_lasso.coef != 0]

ggplot(forty_shuttle_2_three_cone[-fs23c_three_cone_train,] %>% mutate(pred = fs23c_three_cone_lasso.pred),
       aes(x = pred, three_cone)) +
  geom_point()



fs23c_three_cone_x_scale <- model.matrix(scale(three_cone) ~ scale(forty) + scale(shuttle), forty_shuttle_2_three_cone)
fs23c_three_cone_y_scale <- (forty_shuttle_2_three_cone %>% mutate(three_cone = scale(three_cone)))$three_cone

set.seed(2)
fs23c_three_cone_train <- sample(1:nrow(fs23c_three_cone_x_scale), .8*nrow(fs23c_three_cone_x_scale))
fs23c_three_cone_test <- (-fs23c_three_cone_train)
fs23c_three_cone_y.test_scale <- fs23c_three_cone_y_scale[fs23c_three_cone_test]

fs23c_three_cone_lasso.mod_scale <- glmnet(fs23c_three_cone_x_scale[fs23c_three_cone_train, ], fs23c_three_cone_y_scale[fs23c_three_cone_train], alpha = 1,
    lambda = grid,intercept = TRUE ,standardize = TRUE)

set.seed(1)
fs23c_three_cone_cv.out_scale <- cv.glmnet(fs23c_three_cone_x_scale[fs23c_three_cone_train, ], fs23c_three_cone_y_scale[fs23c_three_cone_train], alpha = 1)
#plot(fs23c_three_cone_cv.out)
fs23c_three_cone_bestlam_scale <- fs23c_three_cone_cv.out_scale$lambda.min
#fs23c_three_cone_bestlam <- 1
fs23c_three_cone_lasso.pred_scale <- predict(fs23c_three_cone_lasso.mod_scale, s = fs23c_three_cone_bestlam_scale,
    newx = fs23c_three_cone_x_scale[fs23c_three_cone_test, ])
mean((fs23c_three_cone_lasso.pred_scale - fs23c_three_cone_y.test_scale)^2)
```

# If player only has forty and shuttle, predict three cone
```{r}
update7 <- update6 %>% mutate(three_cone = if_else(
                           !is.na(forty) & is.na(vertical) & is.na(broad_jump) & is.na(three_cone) & !is.na(shuttle),
                           fs23c_three_cone_lasso.coef[fs23c_three_cone_lasso.coef != 0][1] +
                             fs23c_three_cone_lasso.coef[fs23c_three_cone_lasso.coef != 0][2] * forty +
                             fs23c_three_cone_lasso.coef[fs23c_three_cone_lasso.coef != 0][3] * shuttle,
                           three_cone
                         )) 
```

# Use three cone and shuttle to predict
```{r}
three_cone_shuttle_2_forty <- combineonly %>% select(three_cone, shuttle, forty) %>% 
  filter(!is.na(three_cone) & !is.na(shuttle) & !is.na(forty))


tcs2f_forty_x <- model.matrix(forty ~ ., three_cone_shuttle_2_forty)
tcs2f_forty_y <- three_cone_shuttle_2_forty$forty
tcs2f_forty_x 
mean(tcs2f_forty_y)

set.seed(2)
tcs2f_forty_train <- sample(1:nrow(tcs2f_forty_x), .8*nrow(tcs2f_forty_x))
tcs2f_forty_test <- (-tcs2f_forty_train)
tcs2f_forty_y.test <- tcs2f_forty_y[tcs2f_forty_test]

grid <- 10^seq(-5, 5, length = 100)

tcs2f_forty_lasso.mod <- glmnet(tcs2f_forty_x[tcs2f_forty_train, ], tcs2f_forty_y[tcs2f_forty_train], alpha = 1,
    lambda = grid,intercept = TRUE ,standardize = TRUE)
plot(tcs2f_forty_lasso.mod)

set.seed(1)
tcs2f_forty_cv.out <- cv.glmnet(tcs2f_forty_x[tcs2f_forty_train, ], tcs2f_forty_y[tcs2f_forty_train], alpha = 1)
#plot(tcs2f_forty_cv.out)
tcs2f_forty_bestlam <- tcs2f_forty_cv.out$lambda.min
#tcs2f_forty_bestlam <- 1
tcs2f_forty_lasso.pred <- predict(tcs2f_forty_lasso.mod, s = tcs2f_forty_bestlam,
    newx = tcs2f_forty_x[tcs2f_forty_test, ])
mean((tcs2f_forty_lasso.pred - tcs2f_forty_y.test)^2)

tcs2f_forty_out <- glmnet(tcs2f_forty_x, tcs2f_forty_y, alpha = 1, lambda = tcs2f_forty_bestlam )
coef(tcs2f_forty_out)
tcs2f_forty_lasso.coef <- predict(tcs2f_forty_out, type = "coefficients",
    s = tcs2f_forty_bestlam)[1:(ncol(three_cone_2_forty)+2), ]
tcs2f_forty_lasso.coef
tcs2f_forty_lasso.coef[tcs2f_forty_lasso.coef != 0]

ggplot(three_cone_shuttle_2_forty[-tcs2f_forty_train,] %>% mutate(pred = tcs2f_forty_lasso.pred),
       aes(x = pred, forty)) +
  geom_point()



tcs2f_forty_x_scale <- model.matrix(scale(forty) ~ scale(three_cone) + scale(shuttle), three_cone_shuttle_2_forty)
tcs2f_forty_y_scale <- (three_cone_shuttle_2_forty %>% mutate(forty = scale(forty)))$forty

set.seed(2)
tcs2f_forty_train <- sample(1:nrow(tcs2f_forty_x_scale), .8*nrow(tcs2f_forty_x_scale))
tcs2f_forty_test <- (-tcs2f_forty_train)
tcs2f_forty_y.test_scale <- tcs2f_forty_y_scale[tcs2f_forty_test]

tcs2f_forty_lasso.mod_scale <- glmnet(tcs2f_forty_x_scale[tcs2f_forty_train, ], tcs2f_forty_y_scale[tcs2f_forty_train], alpha = 1,
    lambda = grid,intercept = TRUE ,standardize = TRUE)

set.seed(1)
tcs2f_forty_cv.out_scale <- cv.glmnet(tcs2f_forty_x_scale[tcs2f_forty_train, ], tcs2f_forty_y_scale[tcs2f_forty_train], alpha = 1)
#plot(tcs2f_forty_cv.out)
tcs2f_forty_bestlam_scale <- tcs2f_forty_cv.out_scale$lambda.min
#tcs2f_forty_bestlam <- 1
tcs2f_forty_lasso.pred_scale <- predict(tcs2f_forty_lasso.mod_scale, s = tcs2f_forty_bestlam_scale,
    newx = tcs2f_forty_x_scale[tcs2f_forty_test, ])
mean((tcs2f_forty_lasso.pred_scale - tcs2f_forty_y.test_scale)^2)
```

```{r}
three_cone_shuttle_2_vertical <- combineonly %>% select(three_cone, shuttle, vertical) %>% 
  filter(!is.na(three_cone) & !is.na(shuttle) & !is.na(vertical))


tcs2v_vertical_x <- model.matrix(vertical ~ ., three_cone_shuttle_2_vertical)
tcs2v_vertical_y <- three_cone_shuttle_2_vertical$vertical
tcs2v_vertical_x 
mean(tcs2v_vertical_y)

set.seed(2)
tcs2v_vertical_train <- sample(1:nrow(tcs2v_vertical_x), .8*nrow(tcs2v_vertical_x))
tcs2v_vertical_test <- (-tcs2v_vertical_train)
tcs2v_vertical_y.test <- tcs2v_vertical_y[tcs2v_vertical_test]

grid <- 10^seq(-5, 5, length = 100)

tcs2v_vertical_lasso.mod <- glmnet(tcs2v_vertical_x[tcs2v_vertical_train, ], tcs2v_vertical_y[tcs2v_vertical_train], alpha = 1,
    lambda = grid,intercept = TRUE ,standardize = TRUE)
plot(tcs2v_vertical_lasso.mod)

set.seed(1)
tcs2v_vertical_cv.out <- cv.glmnet(tcs2v_vertical_x[tcs2v_vertical_train, ], tcs2v_vertical_y[tcs2v_vertical_train], alpha = 1)
#plot(tcs2v_vertical_cv.out)
tcs2v_vertical_bestlam <- tcs2v_vertical_cv.out$lambda.min
#tcs2v_vertical_bestlam <- 1
tcs2v_vertical_lasso.pred <- predict(tcs2v_vertical_lasso.mod, s = tcs2v_vertical_bestlam,
    newx = tcs2v_vertical_x[tcs2v_vertical_test, ])
mean((tcs2v_vertical_lasso.pred - tcs2v_vertical_y.test)^2)

tcs2v_vertical_out <- glmnet(tcs2v_vertical_x, tcs2v_vertical_y, alpha = 1, lambda = tcs2v_vertical_bestlam )
coef(tcs2v_vertical_out)
tcs2v_vertical_lasso.coef <- predict(tcs2v_vertical_out, type = "coefficients",
    s = tcs2v_vertical_bestlam)[1:(ncol(three_cone_2_vertical)+2), ]
tcs2v_vertical_lasso.coef
tcs2v_vertical_lasso.coef[tcs2v_vertical_lasso.coef != 0]

ggplot(three_cone_shuttle_2_vertical[-tcs2v_vertical_train,] %>% mutate(pred = tcs2v_vertical_lasso.pred),
       aes(x = pred, vertical)) +
  geom_point()



tcs2v_vertical_x_scale <- model.matrix(scale(vertical) ~ scale(three_cone) + scale(shuttle), three_cone_shuttle_2_vertical)
tcs2v_vertical_y_scale <- (three_cone_shuttle_2_vertical %>% mutate(vertical = scale(vertical)))$vertical

set.seed(2)
tcs2v_vertical_train <- sample(1:nrow(tcs2v_vertical_x_scale), .8*nrow(tcs2v_vertical_x_scale))
tcs2v_vertical_test <- (-tcs2v_vertical_train)
tcs2v_vertical_y.test_scale <- tcs2v_vertical_y_scale[tcs2v_vertical_test]

tcs2v_vertical_lasso.mod_scale <- glmnet(tcs2v_vertical_x_scale[tcs2v_vertical_train, ], tcs2v_vertical_y_scale[tcs2v_vertical_train], alpha = 1,
    lambda = grid,intercept = TRUE ,standardize = TRUE)

set.seed(1)
tcs2v_vertical_cv.out_scale <- cv.glmnet(tcs2v_vertical_x_scale[tcs2v_vertical_train, ], tcs2v_vertical_y_scale[tcs2v_vertical_train], alpha = 1)
#plot(tcs2v_vertical_cv.out)
tcs2v_vertical_bestlam_scale <- tcs2v_vertical_cv.out_scale$lambda.min
#tcs2v_vertical_bestlam <- 1
tcs2v_vertical_lasso.pred_scale <- predict(tcs2v_vertical_lasso.mod_scale, s = tcs2v_vertical_bestlam_scale,
    newx = tcs2v_vertical_x_scale[tcs2v_vertical_test, ])
mean((tcs2v_vertical_lasso.pred_scale - tcs2v_vertical_y.test_scale)^2)
```

```{r}
three_cone_shuttle_2_broad_jump <- combineonly %>% select(three_cone, shuttle, broad_jump) %>% 
  filter(!is.na(three_cone) & !is.na(shuttle) & !is.na(broad_jump))


tcs2bj_broad_jump_x <- model.matrix(broad_jump ~ ., three_cone_shuttle_2_broad_jump)
tcs2bj_broad_jump_y <- three_cone_shuttle_2_broad_jump$broad_jump
tcs2bj_broad_jump_x 
mean(tcs2bj_broad_jump_y)

set.seed(2)
tcs2bj_broad_jump_train <- sample(1:nrow(tcs2bj_broad_jump_x), .8*nrow(tcs2bj_broad_jump_x))
tcs2bj_broad_jump_test <- (-tcs2bj_broad_jump_train)
tcs2bj_broad_jump_y.test <- tcs2bj_broad_jump_y[tcs2bj_broad_jump_test]

grid <- 10^seq(-5, 5, length = 100)

tcs2bj_broad_jump_lasso.mod <- glmnet(tcs2bj_broad_jump_x[tcs2bj_broad_jump_train, ], tcs2bj_broad_jump_y[tcs2bj_broad_jump_train], alpha = 1,
    lambda = grid,intercept = TRUE ,standardize = TRUE)
plot(tcs2bj_broad_jump_lasso.mod)

set.seed(1)
tcs2bj_broad_jump_cv.out <- cv.glmnet(tcs2bj_broad_jump_x[tcs2bj_broad_jump_train, ], tcs2bj_broad_jump_y[tcs2bj_broad_jump_train], alpha = 1)
#plot(tcs2bj_broad_jump_cv.out)
tcs2bj_broad_jump_bestlam <- tcs2bj_broad_jump_cv.out$lambda.min
#tcs2bj_broad_jump_bestlam <- 1
tcs2bj_broad_jump_lasso.pred <- predict(tcs2bj_broad_jump_lasso.mod, s = tcs2bj_broad_jump_bestlam,
    newx = tcs2bj_broad_jump_x[tcs2bj_broad_jump_test, ])
mean((tcs2bj_broad_jump_lasso.pred - tcs2bj_broad_jump_y.test)^2)

tcs2bj_broad_jump_out <- glmnet(tcs2bj_broad_jump_x, tcs2bj_broad_jump_y, alpha = 1, lambda = tcs2bj_broad_jump_bestlam )
coef(tcs2bj_broad_jump_out)
tcs2bj_broad_jump_lasso.coef <- predict(tcs2bj_broad_jump_out, type = "coefficients",
    s = tcs2bj_broad_jump_bestlam)[1:(ncol(three_cone_2_broad_jump)+2), ]
tcs2bj_broad_jump_lasso.coef
tcs2bj_broad_jump_lasso.coef[tcs2bj_broad_jump_lasso.coef != 0]

ggplot(three_cone_shuttle_2_broad_jump[-tcs2bj_broad_jump_train,] %>% mutate(pred = tcs2bj_broad_jump_lasso.pred),
       aes(x = pred, broad_jump)) +
  geom_point()



tcs2bj_broad_jump_x_scale <- model.matrix(scale(broad_jump) ~ scale(three_cone) + scale(shuttle), three_cone_shuttle_2_broad_jump)
tcs2bj_broad_jump_y_scale <- (three_cone_shuttle_2_broad_jump %>% mutate(broad_jump = scale(broad_jump)))$broad_jump

set.seed(2)
tcs2bj_broad_jump_train <- sample(1:nrow(tcs2bj_broad_jump_x_scale), .8*nrow(tcs2bj_broad_jump_x_scale))
tcs2bj_broad_jump_test <- (-tcs2bj_broad_jump_train)
tcs2bj_broad_jump_y.test_scale <- tcs2bj_broad_jump_y_scale[tcs2bj_broad_jump_test]

tcs2bj_broad_jump_lasso.mod_scale <- glmnet(tcs2bj_broad_jump_x_scale[tcs2bj_broad_jump_train, ], tcs2bj_broad_jump_y_scale[tcs2bj_broad_jump_train], alpha = 1,
    lambda = grid,intercept = TRUE ,standardize = TRUE)

set.seed(1)
tcs2bj_broad_jump_cv.out_scale <- cv.glmnet(tcs2bj_broad_jump_x_scale[tcs2bj_broad_jump_train, ], tcs2bj_broad_jump_y_scale[tcs2bj_broad_jump_train], alpha = 1)
#plot(tcs2bj_broad_jump_cv.out)
tcs2bj_broad_jump_bestlam_scale <- tcs2bj_broad_jump_cv.out_scale$lambda.min
#tcs2bj_broad_jump_bestlam <- 1
tcs2bj_broad_jump_lasso.pred_scale <- predict(tcs2bj_broad_jump_lasso.mod_scale, s = tcs2bj_broad_jump_bestlam_scale,
    newx = tcs2bj_broad_jump_x_scale[tcs2bj_broad_jump_test, ])
mean((tcs2bj_broad_jump_lasso.pred_scale - tcs2bj_broad_jump_y.test_scale)^2)
```

# If player only has three cone and shuttle predict forty
```{r}
update8 <- update7 %>% mutate(forty = if_else(
                           is.na(forty) & is.na(vertical) & is.na(broad_jump) & !is.na(three_cone) & !is.na(shuttle),
                           tcs2f_forty_lasso.coef[tcs2f_forty_lasso.coef != 0][1] +
                             tcs2f_forty_lasso.coef[tcs2f_forty_lasso.coef != 0][2] * three_cone +
                             tcs2f_forty_lasso.coef[tcs2f_forty_lasso.coef != 0][3] * shuttle,
                           forty
                         )) 
```

# Use forty, vertical and three cone to predict
```{r}
forty_three_cone_vertical_2_broad_jump <- combineonly %>% select(forty, three_cone, vertical, broad_jump) %>% 
  filter(!is.na(forty) & !is.na(three_cone) & !is.na(vertical) & !is.na(broad_jump))


f3cv2bj_broad_jump_x <- model.matrix(broad_jump ~ ., forty_three_cone_vertical_2_broad_jump)
f3cv2bj_broad_jump_y <- forty_three_cone_vertical_2_broad_jump$broad_jump
f3cv2bj_broad_jump_x 
mean(f3cv2bj_broad_jump_y)

set.seed(2)
f3cv2bj_broad_jump_train <- sample(1:nrow(f3cv2bj_broad_jump_x), .8*nrow(f3cv2bj_broad_jump_x))
f3cv2bj_broad_jump_test <- (-f3cv2bj_broad_jump_train)
f3cv2bj_broad_jump_y.test <- f3cv2bj_broad_jump_y[f3cv2bj_broad_jump_test]

grid <- 10^seq(-5, 5, length = 100)

f3cv2bj_broad_jump_lasso.mod <- glmnet(f3cv2bj_broad_jump_x[f3cv2bj_broad_jump_train, ], f3cv2bj_broad_jump_y[f3cv2bj_broad_jump_train], alpha = 1,
    lambda = grid,intercept = TRUE ,standardize = TRUE)
plot(f3cv2bj_broad_jump_lasso.mod)

set.seed(1)
f3cv2bj_broad_jump_cv.out <- cv.glmnet(f3cv2bj_broad_jump_x[f3cv2bj_broad_jump_train, ], f3cv2bj_broad_jump_y[f3cv2bj_broad_jump_train], alpha = 1)
#plot(f3cv2bj_broad_jump_cv.out)
f3cv2bj_broad_jump_bestlam <- f3cv2bj_broad_jump_cv.out$lambda.min
#f3cv2bj_broad_jump_bestlam <- 1
f3cv2bj_broad_jump_lasso.pred <- predict(f3cv2bj_broad_jump_lasso.mod, s = f3cv2bj_broad_jump_bestlam,
    newx = f3cv2bj_broad_jump_x[f3cv2bj_broad_jump_test, ])
mean((f3cv2bj_broad_jump_lasso.pred - f3cv2bj_broad_jump_y.test)^2)

f3cv2bj_broad_jump_out <- glmnet(f3cv2bj_broad_jump_x, f3cv2bj_broad_jump_y, alpha = 1, lambda = f3cv2bj_broad_jump_bestlam )
coef(f3cv2bj_broad_jump_out)
f3cv2bj_broad_jump_lasso.coef <- predict(f3cv2bj_broad_jump_out, type = "coefficients",
    s = f3cv2bj_broad_jump_bestlam)[1:(ncol(forty_three_cone_vertical_2_broad_jump)+1), ]
f3cv2bj_broad_jump_lasso.coef
f3cv2bj_broad_jump_lasso.coef[f3cv2bj_broad_jump_lasso.coef != 0]

ggplot(forty_three_cone_vertical_2_broad_jump[-f3cv2bj_broad_jump_train,] %>% mutate(pred = f3cv2bj_broad_jump_lasso.pred),
       aes(x = pred, broad_jump)) +
  geom_point()



f3cv2bj_broad_jump_x_scale <- model.matrix(scale(broad_jump) ~ scale(three_cone) + scale(vertical), forty_three_cone_vertical_2_broad_jump)
f3cv2bj_broad_jump_y_scale <- (forty_three_cone_vertical_2_broad_jump %>% mutate(broad_jump = scale(broad_jump)))$broad_jump

set.seed(2)
f3cv2bj_broad_jump_train <- sample(1:nrow(f3cv2bj_broad_jump_x_scale), .8*nrow(f3cv2bj_broad_jump_x_scale))
f3cv2bj_broad_jump_test <- (-f3cv2bj_broad_jump_train)
f3cv2bj_broad_jump_y.test_scale <- f3cv2bj_broad_jump_y_scale[f3cv2bj_broad_jump_test]

f3cv2bj_broad_jump_lasso.mod_scale <- glmnet(f3cv2bj_broad_jump_x_scale[f3cv2bj_broad_jump_train, ], f3cv2bj_broad_jump_y_scale[f3cv2bj_broad_jump_train], alpha = 1,
    lambda = grid,intercept = TRUE ,standardize = TRUE)

set.seed(1)
f3cv2bj_broad_jump_cv.out_scale <- cv.glmnet(f3cv2bj_broad_jump_x_scale[f3cv2bj_broad_jump_train, ], f3cv2bj_broad_jump_y_scale[f3cv2bj_broad_jump_train], alpha = 1)
#plot(f3cv2bj_broad_jump_cv.out)
f3cv2bj_broad_jump_bestlam_scale <- f3cv2bj_broad_jump_cv.out_scale$lambda.min
#f3cv2bj_broad_jump_bestlam <- 1
f3cv2bj_broad_jump_lasso.pred_scale <- predict(f3cv2bj_broad_jump_lasso.mod_scale, s = f3cv2bj_broad_jump_bestlam_scale,
    newx = f3cv2bj_broad_jump_x_scale[f3cv2bj_broad_jump_test, ])
mean((f3cv2bj_broad_jump_lasso.pred_scale - f3cv2bj_broad_jump_y.test_scale)^2)
```


```{r}
forty_three_cone_vertical_2_shuttle <- combineonly %>% select(forty, three_cone, vertical, shuttle) %>% 
  filter(!is.na(forty) & !is.na(three_cone) & !is.na(vertical) & !is.na(shuttle))


f3cv2s_shuttle_x <- model.matrix(shuttle ~ ., forty_three_cone_vertical_2_shuttle)
f3cv2s_shuttle_y <- forty_three_cone_vertical_2_shuttle$shuttle
f3cv2s_shuttle_x 
mean(f3cv2s_shuttle_y)

set.seed(2)
f3cv2s_shuttle_train <- sample(1:nrow(f3cv2s_shuttle_x), .8*nrow(f3cv2s_shuttle_x))
f3cv2s_shuttle_test <- (-f3cv2s_shuttle_train)
f3cv2s_shuttle_y.test <- f3cv2s_shuttle_y[f3cv2s_shuttle_test]

grid <- 10^seq(-5, 5, length = 100)

f3cv2s_shuttle_lasso.mod <- glmnet(f3cv2s_shuttle_x[f3cv2s_shuttle_train, ], f3cv2s_shuttle_y[f3cv2s_shuttle_train], alpha = 1,
    lambda = grid,intercept = TRUE ,standardize = TRUE)
plot(f3cv2s_shuttle_lasso.mod)

set.seed(1)
f3cv2s_shuttle_cv.out <- cv.glmnet(f3cv2s_shuttle_x[f3cv2s_shuttle_train, ], f3cv2s_shuttle_y[f3cv2s_shuttle_train], alpha = 1)
#plot(f3cv2s_shuttle_cv.out)
f3cv2s_shuttle_bestlam <- f3cv2s_shuttle_cv.out$lambda.min
#f3cv2s_shuttle_bestlam <- 1
f3cv2s_shuttle_lasso.pred <- predict(f3cv2s_shuttle_lasso.mod, s = f3cv2s_shuttle_bestlam,
    newx = f3cv2s_shuttle_x[f3cv2s_shuttle_test, ])
mean((f3cv2s_shuttle_lasso.pred - f3cv2s_shuttle_y.test)^2)

f3cv2s_shuttle_out <- glmnet(f3cv2s_shuttle_x, f3cv2s_shuttle_y, alpha = 1, lambda = f3cv2s_shuttle_bestlam )
coef(f3cv2s_shuttle_out)
f3cv2s_shuttle_lasso.coef <- predict(f3cv2s_shuttle_out, type = "coefficients",
    s = f3cv2s_shuttle_bestlam)[1:(ncol(forty_three_cone_vertical_2_shuttle)+1), ]
f3cv2s_shuttle_lasso.coef
f3cv2s_shuttle_lasso.coef[f3cv2s_shuttle_lasso.coef != 0]

ggplot(forty_three_cone_vertical_2_shuttle[-f3cv2s_shuttle_train,] %>% mutate(pred = f3cv2s_shuttle_lasso.pred),
       aes(x = pred, shuttle)) +
  geom_point()



f3cv2s_shuttle_x_scale <- model.matrix(scale(shuttle) ~ scale(three_cone) + scale(vertical), forty_three_cone_vertical_2_shuttle)
f3cv2s_shuttle_y_scale <- (forty_three_cone_vertical_2_shuttle %>% mutate(shuttle = scale(shuttle)))$shuttle

set.seed(2)
f3cv2s_shuttle_train <- sample(1:nrow(f3cv2s_shuttle_x_scale), .8*nrow(f3cv2s_shuttle_x_scale))
f3cv2s_shuttle_test <- (-f3cv2s_shuttle_train)
f3cv2s_shuttle_y.test_scale <- f3cv2s_shuttle_y_scale[f3cv2s_shuttle_test]

f3cv2s_shuttle_lasso.mod_scale <- glmnet(f3cv2s_shuttle_x_scale[f3cv2s_shuttle_train, ], f3cv2s_shuttle_y_scale[f3cv2s_shuttle_train], alpha = 1,
    lambda = grid,intercept = TRUE ,standardize = TRUE)

set.seed(1)
f3cv2s_shuttle_cv.out_scale <- cv.glmnet(f3cv2s_shuttle_x_scale[f3cv2s_shuttle_train, ], f3cv2s_shuttle_y_scale[f3cv2s_shuttle_train], alpha = 1)
#plot(f3cv2s_shuttle_cv.out)
f3cv2s_shuttle_bestlam_scale <- f3cv2s_shuttle_cv.out_scale$lambda.min
#f3cv2s_shuttle_bestlam <- 1
f3cv2s_shuttle_lasso.pred_scale <- predict(f3cv2s_shuttle_lasso.mod_scale, s = f3cv2s_shuttle_bestlam_scale,
    newx = f3cv2s_shuttle_x_scale[f3cv2s_shuttle_test, ])
mean((f3cv2s_shuttle_lasso.pred_scale - f3cv2s_shuttle_y.test_scale)^2)
```

# If player only has forty, vertical and three cone predict broad jump
```{r}
update9 <- update8 %>% mutate(broad_jump = if_else(
                           !is.na(forty) & !is.na(vertical) & is.na(broad_jump) & !is.na(three_cone) & is.na(shuttle),
                           f3cv2bj_broad_jump_lasso.coef[f3cv2bj_broad_jump_lasso.coef != 0][1] +
                             f3cv2bj_broad_jump_lasso.coef[f3cv2bj_broad_jump_lasso.coef != 0][2] * forty +
                             f3cv2bj_broad_jump_lasso.coef[f3cv2bj_broad_jump_lasso.coef != 0][3] * vertical,
                           broad_jump
                         )) 
```

# Use forty, vertical, broad jump to predict
```{r}
forty_broad_jump_vertical_2_three_cone <- combineonly %>% select(forty, broad_jump, vertical, three_cone) %>% 
  filter(!is.na(forty) & !is.na(broad_jump) & !is.na(vertical) & !is.na(three_cone))


fbjv23c_three_cone_x <- model.matrix(three_cone ~ ., forty_broad_jump_vertical_2_three_cone)
fbjv23c_three_cone_y <- forty_broad_jump_vertical_2_three_cone$three_cone
fbjv23c_three_cone_x 
mean(fbjv23c_three_cone_y)

set.seed(2)
fbjv23c_three_cone_train <- sample(1:nrow(fbjv23c_three_cone_x), .8*nrow(fbjv23c_three_cone_x))
fbjv23c_three_cone_test <- (-fbjv23c_three_cone_train)
fbjv23c_three_cone_y.test <- fbjv23c_three_cone_y[fbjv23c_three_cone_test]

grid <- 10^seq(-5, 5, length = 100)

fbjv23c_three_cone_lasso.mod <- glmnet(fbjv23c_three_cone_x[fbjv23c_three_cone_train, ], fbjv23c_three_cone_y[fbjv23c_three_cone_train], alpha = 1,
    lambda = grid,intercept = TRUE ,standardize = TRUE)
plot(fbjv23c_three_cone_lasso.mod)

set.seed(1)
fbjv23c_three_cone_cv.out <- cv.glmnet(fbjv23c_three_cone_x[fbjv23c_three_cone_train, ], fbjv23c_three_cone_y[fbjv23c_three_cone_train], alpha = 1)
#plot(fbjv23c_three_cone_cv.out)
fbjv23c_three_cone_bestlam <- fbjv23c_three_cone_cv.out$lambda.min
#fbjv23c_three_cone_bestlam <- 1
fbjv23c_three_cone_lasso.pred <- predict(fbjv23c_three_cone_lasso.mod, s = fbjv23c_three_cone_bestlam,
    newx = fbjv23c_three_cone_x[fbjv23c_three_cone_test, ])
mean((fbjv23c_three_cone_lasso.pred - fbjv23c_three_cone_y.test)^2)

fbjv23c_three_cone_out <- glmnet(fbjv23c_three_cone_x, fbjv23c_three_cone_y, alpha = 1, lambda = fbjv23c_three_cone_bestlam )
coef(fbjv23c_three_cone_out)
fbjv23c_three_cone_lasso.coef <- predict(fbjv23c_three_cone_out, type = "coefficients",
    s = fbjv23c_three_cone_bestlam)[1:(ncol(forty_broad_jump_vertical_2_three_cone)+1), ]
fbjv23c_three_cone_lasso.coef
fbjv23c_three_cone_lasso.coef[fbjv23c_three_cone_lasso.coef != 0]

ggplot(forty_broad_jump_vertical_2_three_cone[-fbjv23c_three_cone_train,] %>% mutate(pred = fbjv23c_three_cone_lasso.pred),
       aes(x = pred, three_cone)) +
  geom_point()



fbjv23c_three_cone_x_scale <- model.matrix(scale(three_cone) ~ scale(broad_jump) + scale(vertical), forty_broad_jump_vertical_2_three_cone)
fbjv23c_three_cone_y_scale <- (forty_broad_jump_vertical_2_three_cone %>% mutate(three_cone = scale(three_cone)))$three_cone

set.seed(2)
fbjv23c_three_cone_train <- sample(1:nrow(fbjv23c_three_cone_x_scale), .8*nrow(fbjv23c_three_cone_x_scale))
fbjv23c_three_cone_test <- (-fbjv23c_three_cone_train)
fbjv23c_three_cone_y.test_scale <- fbjv23c_three_cone_y_scale[fbjv23c_three_cone_test]

fbjv23c_three_cone_lasso.mod_scale <- glmnet(fbjv23c_three_cone_x_scale[fbjv23c_three_cone_train, ], fbjv23c_three_cone_y_scale[fbjv23c_three_cone_train], alpha = 1,
    lambda = grid,intercept = TRUE ,standardize = TRUE)

set.seed(1)
fbjv23c_three_cone_cv.out_scale <- cv.glmnet(fbjv23c_three_cone_x_scale[fbjv23c_three_cone_train, ], fbjv23c_three_cone_y_scale[fbjv23c_three_cone_train], alpha = 1)
#plot(fbjv23c_three_cone_cv.out)
fbjv23c_three_cone_bestlam_scale <- fbjv23c_three_cone_cv.out_scale$lambda.min
#fbjv23c_three_cone_bestlam <- 1
fbjv23c_three_cone_lasso.pred_scale <- predict(fbjv23c_three_cone_lasso.mod_scale, s = fbjv23c_three_cone_bestlam_scale,
    newx = fbjv23c_three_cone_x_scale[fbjv23c_three_cone_test, ])
mean((fbjv23c_three_cone_lasso.pred_scale - fbjv23c_three_cone_y.test_scale)^2)
```

```{r}
forty_broad_jump_vertical_2_shuttle <- combineonly %>% select(forty, broad_jump, vertical, shuttle) %>% 
  filter(!is.na(forty) & !is.na(broad_jump) & !is.na(vertical) & !is.na(shuttle))


fbjv2s_shuttle_x <- model.matrix(shuttle ~ ., forty_broad_jump_vertical_2_shuttle)
fbjv2s_shuttle_y <- forty_broad_jump_vertical_2_shuttle$shuttle
fbjv2s_shuttle_x 
mean(fbjv2s_shuttle_y)

set.seed(2)
fbjv2s_shuttle_train <- sample(1:nrow(fbjv2s_shuttle_x), .8*nrow(fbjv2s_shuttle_x))
fbjv2s_shuttle_test <- (-fbjv2s_shuttle_train)
fbjv2s_shuttle_y.test <- fbjv2s_shuttle_y[fbjv2s_shuttle_test]

grid <- 10^seq(-5, 5, length = 100)

fbjv2s_shuttle_lasso.mod <- glmnet(fbjv2s_shuttle_x[fbjv2s_shuttle_train, ], fbjv2s_shuttle_y[fbjv2s_shuttle_train], alpha = 1,
    lambda = grid,intercept = TRUE ,standardize = TRUE)
plot(fbjv2s_shuttle_lasso.mod)

set.seed(1)
fbjv2s_shuttle_cv.out <- cv.glmnet(fbjv2s_shuttle_x[fbjv2s_shuttle_train, ], fbjv2s_shuttle_y[fbjv2s_shuttle_train], alpha = 1)
#plot(fbjv2s_shuttle_cv.out)
fbjv2s_shuttle_bestlam <- fbjv2s_shuttle_cv.out$lambda.min
#fbjv2s_shuttle_bestlam <- 1
fbjv2s_shuttle_lasso.pred <- predict(fbjv2s_shuttle_lasso.mod, s = fbjv2s_shuttle_bestlam,
    newx = fbjv2s_shuttle_x[fbjv2s_shuttle_test, ])
mean((fbjv2s_shuttle_lasso.pred - fbjv2s_shuttle_y.test)^2)

fbjv2s_shuttle_out <- glmnet(fbjv2s_shuttle_x, fbjv2s_shuttle_y, alpha = 1, lambda = fbjv2s_shuttle_bestlam )
coef(fbjv2s_shuttle_out)
fbjv2s_shuttle_lasso.coef <- predict(fbjv2s_shuttle_out, type = "coefficients",
    s = fbjv2s_shuttle_bestlam)[1:(ncol(forty_broad_jump_vertical_2_shuttle)+1), ]
fbjv2s_shuttle_lasso.coef
fbjv2s_shuttle_lasso.coef[fbjv2s_shuttle_lasso.coef != 0]

ggplot(forty_broad_jump_vertical_2_shuttle[-fbjv2s_shuttle_train,] %>% mutate(pred = fbjv2s_shuttle_lasso.pred),
       aes(x = pred, shuttle)) +
  geom_point()



fbjv2s_shuttle_x_scale <- model.matrix(scale(shuttle) ~ scale(broad_jump) + scale(vertical), forty_broad_jump_vertical_2_shuttle)
fbjv2s_shuttle_y_scale <- (forty_broad_jump_vertical_2_shuttle %>% mutate(shuttle = scale(shuttle)))$shuttle

set.seed(2)
fbjv2s_shuttle_train <- sample(1:nrow(fbjv2s_shuttle_x_scale), .8*nrow(fbjv2s_shuttle_x_scale))
fbjv2s_shuttle_test <- (-fbjv2s_shuttle_train)
fbjv2s_shuttle_y.test_scale <- fbjv2s_shuttle_y_scale[fbjv2s_shuttle_test]

fbjv2s_shuttle_lasso.mod_scale <- glmnet(fbjv2s_shuttle_x_scale[fbjv2s_shuttle_train, ], fbjv2s_shuttle_y_scale[fbjv2s_shuttle_train], alpha = 1,
    lambda = grid,intercept = TRUE ,standardize = TRUE)

set.seed(1)
fbjv2s_shuttle_cv.out_scale <- cv.glmnet(fbjv2s_shuttle_x_scale[fbjv2s_shuttle_train, ], fbjv2s_shuttle_y_scale[fbjv2s_shuttle_train], alpha = 1)
#plot(fbjv2s_shuttle_cv.out)
fbjv2s_shuttle_bestlam_scale <- fbjv2s_shuttle_cv.out_scale$lambda.min
#fbjv2s_shuttle_bestlam <- 1
fbjv2s_shuttle_lasso.pred_scale <- predict(fbjv2s_shuttle_lasso.mod_scale, s = fbjv2s_shuttle_bestlam_scale,
    newx = fbjv2s_shuttle_x_scale[fbjv2s_shuttle_test, ])
mean((fbjv2s_shuttle_lasso.pred_scale - fbjv2s_shuttle_y.test_scale)^2)
```

# If player only has forty, broad jump and vertical predict shuttle
```{r}
update10 <- update9 %>% mutate(shuttle = if_else(
                           !is.na(forty) & !is.na(vertical) & !is.na(broad_jump) & is.na(three_cone) & is.na(shuttle),
                           fbjv2s_shuttle_lasso.coef[fbjv2s_shuttle_lasso.coef != 0][1] +
                             fbjv2s_shuttle_lasso.coef[fbjv2s_shuttle_lasso.coef != 0][2] * forty +
                             fbjv2s_shuttle_lasso.coef[fbjv2s_shuttle_lasso.coef != 0][3] * broad_jump +
                             fbjv2s_shuttle_lasso.coef[fbjv2s_shuttle_lasso.coef != 0][4] * vertical,
                           shuttle
                         )) 
```

# Use forty, three cone, and shuttle to predict
```{r}
forty_three_cone_shuttle_2_vertical <- combineonly %>% select(forty, three_cone, shuttle, vertical) %>% 
  filter(!is.na(forty) & !is.na(three_cone) & !is.na(shuttle) & !is.na(vertical))


f3cs2v_vertical_x <- model.matrix(vertical ~ ., forty_three_cone_shuttle_2_vertical)
f3cs2v_vertical_y <- forty_three_cone_shuttle_2_vertical$vertical
f3cs2v_vertical_x 
mean(f3cs2v_vertical_y)

set.seed(2)
f3cs2v_vertical_train <- sample(1:nrow(f3cs2v_vertical_x), .8*nrow(f3cs2v_vertical_x))
f3cs2v_vertical_test <- (-f3cs2v_vertical_train)
f3cs2v_vertical_y.test <- f3cs2v_vertical_y[f3cs2v_vertical_test]

grid <- 10^seq(-5, 5, length = 100)

f3cs2v_vertical_lasso.mod <- glmnet(f3cs2v_vertical_x[f3cs2v_vertical_train, ], f3cs2v_vertical_y[f3cs2v_vertical_train], alpha = 1,
    lambda = grid,intercept = TRUE ,standardize = TRUE)
plot(f3cs2v_vertical_lasso.mod)

set.seed(1)
f3cs2v_vertical_cv.out <- cv.glmnet(f3cs2v_vertical_x[f3cs2v_vertical_train, ], f3cs2v_vertical_y[f3cs2v_vertical_train], alpha = 1)
#plot(f3cs2v_vertical_cv.out)
f3cs2v_vertical_bestlam <- f3cs2v_vertical_cv.out$lambda.min
#f3cs2v_vertical_bestlam <- 1
f3cs2v_vertical_lasso.pred <- predict(f3cs2v_vertical_lasso.mod, s = f3cs2v_vertical_bestlam,
    newx = f3cs2v_vertical_x[f3cs2v_vertical_test, ])
mean((f3cs2v_vertical_lasso.pred - f3cs2v_vertical_y.test)^2)

f3cs2v_vertical_out <- glmnet(f3cs2v_vertical_x, f3cs2v_vertical_y, alpha = 1, lambda = f3cs2v_vertical_bestlam )
coef(f3cs2v_vertical_out)
f3cs2v_vertical_lasso.coef <- predict(f3cs2v_vertical_out, type = "coefficients",
    s = f3cs2v_vertical_bestlam)[1:(ncol(forty_three_cone_shuttle_2_vertical)+1), ]
f3cs2v_vertical_lasso.coef
f3cs2v_vertical_lasso.coef[f3cs2v_vertical_lasso.coef != 0]

ggplot(forty_three_cone_shuttle_2_vertical[-f3cs2v_vertical_train,] %>% mutate(pred = f3cs2v_vertical_lasso.pred),
       aes(x = pred, vertical)) +
  geom_point()



f3cs2v_vertical_x_scale <- model.matrix(scale(vertical) ~ scale(three_cone) + scale(shuttle), forty_three_cone_shuttle_2_vertical)
f3cs2v_vertical_y_scale <- (forty_three_cone_shuttle_2_vertical %>% mutate(vertical = scale(vertical)))$vertical

set.seed(2)
f3cs2v_vertical_train <- sample(1:nrow(f3cs2v_vertical_x_scale), .8*nrow(f3cs2v_vertical_x_scale))
f3cs2v_vertical_test <- (-f3cs2v_vertical_train)
f3cs2v_vertical_y.test_scale <- f3cs2v_vertical_y_scale[f3cs2v_vertical_test]

f3cs2v_vertical_lasso.mod_scale <- glmnet(f3cs2v_vertical_x_scale[f3cs2v_vertical_train, ], f3cs2v_vertical_y_scale[f3cs2v_vertical_train], alpha = 1,
    lambda = grid,intercept = TRUE ,standardize = TRUE)

set.seed(1)
f3cs2v_vertical_cv.out_scale <- cv.glmnet(f3cs2v_vertical_x_scale[f3cs2v_vertical_train, ], f3cs2v_vertical_y_scale[f3cs2v_vertical_train], alpha = 1)
#plot(f3cs2v_vertical_cv.out)
f3cs2v_vertical_bestlam_scale <- f3cs2v_vertical_cv.out_scale$lambda.min
#f3cs2v_vertical_bestlam <- 1
f3cs2v_vertical_lasso.pred_scale <- predict(f3cs2v_vertical_lasso.mod_scale, s = f3cs2v_vertical_bestlam_scale,
    newx = f3cs2v_vertical_x_scale[f3cs2v_vertical_test, ])
mean((f3cs2v_vertical_lasso.pred_scale - f3cs2v_vertical_y.test_scale)^2)
```

```{r}
forty_three_cone_shuttle_2_broad_jump <- combineonly %>% select(forty, three_cone, shuttle, broad_jump) %>% 
  filter(!is.na(forty) & !is.na(three_cone) & !is.na(shuttle) & !is.na(broad_jump))


f3cs2bj_broad_jump_x <- model.matrix(broad_jump ~ ., forty_three_cone_shuttle_2_broad_jump)
f3cs2bj_broad_jump_y <- forty_three_cone_shuttle_2_broad_jump$broad_jump
f3cs2bj_broad_jump_x 
mean(f3cs2bj_broad_jump_y)

set.seed(2)
f3cs2bj_broad_jump_train <- sample(1:nrow(f3cs2bj_broad_jump_x), .8*nrow(f3cs2bj_broad_jump_x))
f3cs2bj_broad_jump_test <- (-f3cs2bj_broad_jump_train)
f3cs2bj_broad_jump_y.test <- f3cs2bj_broad_jump_y[f3cs2bj_broad_jump_test]

grid <- 10^seq(-5, 5, length = 100)

f3cs2bj_broad_jump_lasso.mod <- glmnet(f3cs2bj_broad_jump_x[f3cs2bj_broad_jump_train, ], f3cs2bj_broad_jump_y[f3cs2bj_broad_jump_train], alpha = 1,
    lambda = grid,intercept = TRUE ,standardize = TRUE)
plot(f3cs2bj_broad_jump_lasso.mod)

set.seed(1)
f3cs2bj_broad_jump_cv.out <- cv.glmnet(f3cs2bj_broad_jump_x[f3cs2bj_broad_jump_train, ], f3cs2bj_broad_jump_y[f3cs2bj_broad_jump_train], alpha = 1)
#plot(f3cs2bj_broad_jump_cv.out)
f3cs2bj_broad_jump_bestlam <- f3cs2bj_broad_jump_cv.out$lambda.min
#f3cs2bj_broad_jump_bestlam <- 1
f3cs2bj_broad_jump_lasso.pred <- predict(f3cs2bj_broad_jump_lasso.mod, s = f3cs2bj_broad_jump_bestlam,
    newx = f3cs2bj_broad_jump_x[f3cs2bj_broad_jump_test, ])
mean((f3cs2bj_broad_jump_lasso.pred - f3cs2bj_broad_jump_y.test)^2)

f3cs2bj_broad_jump_out <- glmnet(f3cs2bj_broad_jump_x, f3cs2bj_broad_jump_y, alpha = 1, lambda = f3cs2bj_broad_jump_bestlam )
coef(f3cs2bj_broad_jump_out)
f3cs2bj_broad_jump_lasso.coef <- predict(f3cs2bj_broad_jump_out, type = "coefficients",
    s = f3cs2bj_broad_jump_bestlam)[1:(ncol(forty_three_cone_shuttle_2_broad_jump)+1), ]
f3cs2bj_broad_jump_lasso.coef
f3cs2bj_broad_jump_lasso.coef[f3cs2bj_broad_jump_lasso.coef != 0]

ggplot(forty_three_cone_shuttle_2_broad_jump[-f3cs2bj_broad_jump_train,] %>% mutate(pred = f3cs2bj_broad_jump_lasso.pred),
       aes(x = pred, broad_jump)) +
  geom_point()



f3cs2bj_broad_jump_x_scale <- model.matrix(scale(broad_jump) ~ scale(three_cone) + scale(shuttle), forty_three_cone_shuttle_2_broad_jump)
f3cs2bj_broad_jump_y_scale <- (forty_three_cone_shuttle_2_broad_jump %>% mutate(broad_jump = scale(broad_jump)))$broad_jump

set.seed(2)
f3cs2bj_broad_jump_train <- sample(1:nrow(f3cs2bj_broad_jump_x_scale), .8*nrow(f3cs2bj_broad_jump_x_scale))
f3cs2bj_broad_jump_test <- (-f3cs2bj_broad_jump_train)
f3cs2bj_broad_jump_y.test_scale <- f3cs2bj_broad_jump_y_scale[f3cs2bj_broad_jump_test]

f3cs2bj_broad_jump_lasso.mod_scale <- glmnet(f3cs2bj_broad_jump_x_scale[f3cs2bj_broad_jump_train, ], f3cs2bj_broad_jump_y_scale[f3cs2bj_broad_jump_train], alpha = 1,
    lambda = grid,intercept = TRUE ,standardize = TRUE)

set.seed(1)
f3cs2bj_broad_jump_cv.out_scale <- cv.glmnet(f3cs2bj_broad_jump_x_scale[f3cs2bj_broad_jump_train, ], f3cs2bj_broad_jump_y_scale[f3cs2bj_broad_jump_train], alpha = 1)
#plot(f3cs2bj_broad_jump_cv.out)
f3cs2bj_broad_jump_bestlam_scale <- f3cs2bj_broad_jump_cv.out_scale$lambda.min
#f3cs2bj_broad_jump_bestlam <- 1
f3cs2bj_broad_jump_lasso.pred_scale <- predict(f3cs2bj_broad_jump_lasso.mod_scale, s = f3cs2bj_broad_jump_bestlam_scale,
    newx = f3cs2bj_broad_jump_x_scale[f3cs2bj_broad_jump_test, ])
mean((f3cs2bj_broad_jump_lasso.pred_scale - f3cs2bj_broad_jump_y.test_scale)^2)
```

# Use forty, 3 cone and shuttle to predict broad jump
```{r}
update11 <- update10 %>% mutate(broad_jump = if_else(
                           !is.na(forty) & is.na(vertical) & is.na(broad_jump) & !is.na(three_cone) & !is.na(shuttle),
                           f3cs2bj_broad_jump_lasso.coef[f3cs2bj_broad_jump_lasso.coef != 0][1] +
                             f3cs2bj_broad_jump_lasso.coef[f3cs2bj_broad_jump_lasso.coef != 0][2] * forty +
                             f3cs2bj_broad_jump_lasso.coef[f3cs2bj_broad_jump_lasso.coef != 0][3] * three_cone ,
                           broad_jump
                         )) 
```

# Use forty, vertical, and shuttle to predict
```{r}
forty_vertical_shuttle_2_three_cone <- combineonly %>% select(forty, vertical, shuttle, three_cone) %>% 
  filter(!is.na(forty) & !is.na(vertical) & !is.na(shuttle) & !is.na(three_cone))


fvs23c_three_cone_x <- model.matrix(three_cone ~ ., forty_vertical_shuttle_2_three_cone)
fvs23c_three_cone_y <- forty_vertical_shuttle_2_three_cone$three_cone
fvs23c_three_cone_x 
mean(fvs23c_three_cone_y)

set.seed(2)
fvs23c_three_cone_train <- sample(1:nrow(fvs23c_three_cone_x), .8*nrow(fvs23c_three_cone_x))
fvs23c_three_cone_test <- (-fvs23c_three_cone_train)
fvs23c_three_cone_y.test <- fvs23c_three_cone_y[fvs23c_three_cone_test]

grid <- 10^seq(-5, 5, length = 100)

fvs23c_three_cone_lasso.mod <- glmnet(fvs23c_three_cone_x[fvs23c_three_cone_train, ], fvs23c_three_cone_y[fvs23c_three_cone_train], alpha = 1,
    lambda = grid,intercept = TRUE ,standardize = TRUE)
plot(fvs23c_three_cone_lasso.mod)

set.seed(1)
fvs23c_three_cone_cv.out <- cv.glmnet(fvs23c_three_cone_x[fvs23c_three_cone_train, ], fvs23c_three_cone_y[fvs23c_three_cone_train], alpha = 1)
#plot(fvs23c_three_cone_cv.out)
fvs23c_three_cone_bestlam <- fvs23c_three_cone_cv.out$lambda.min
#fvs23c_three_cone_bestlam <- 1
fvs23c_three_cone_lasso.pred <- predict(fvs23c_three_cone_lasso.mod, s = fvs23c_three_cone_bestlam,
    newx = fvs23c_three_cone_x[fvs23c_three_cone_test, ])
mean((fvs23c_three_cone_lasso.pred - fvs23c_three_cone_y.test)^2)

fvs23c_three_cone_out <- glmnet(fvs23c_three_cone_x, fvs23c_three_cone_y, alpha = 1, lambda = fvs23c_three_cone_bestlam )
coef(fvs23c_three_cone_out)
fvs23c_three_cone_lasso.coef <- predict(fvs23c_three_cone_out, type = "coefficients",
    s = fvs23c_three_cone_bestlam)[1:(ncol(forty_vertical_shuttle_2_three_cone)+1), ]
fvs23c_three_cone_lasso.coef
fvs23c_three_cone_lasso.coef[fvs23c_three_cone_lasso.coef != 0]

ggplot(forty_vertical_shuttle_2_three_cone[-fvs23c_three_cone_train,] %>% mutate(pred = fvs23c_three_cone_lasso.pred),
       aes(x = pred, three_cone)) +
  geom_point()



fvs23c_three_cone_x_scale <- model.matrix(scale(three_cone) ~ scale(vertical) + scale(shuttle), forty_vertical_shuttle_2_three_cone)
fvs23c_three_cone_y_scale <- (forty_vertical_shuttle_2_three_cone %>% mutate(three_cone = scale(three_cone)))$three_cone

set.seed(2)
fvs23c_three_cone_train <- sample(1:nrow(fvs23c_three_cone_x_scale), .8*nrow(fvs23c_three_cone_x_scale))
fvs23c_three_cone_test <- (-fvs23c_three_cone_train)
fvs23c_three_cone_y.test_scale <- fvs23c_three_cone_y_scale[fvs23c_three_cone_test]

fvs23c_three_cone_lasso.mod_scale <- glmnet(fvs23c_three_cone_x_scale[fvs23c_three_cone_train, ], fvs23c_three_cone_y_scale[fvs23c_three_cone_train], alpha = 1,
    lambda = grid,intercept = TRUE ,standardize = TRUE)

set.seed(1)
fvs23c_three_cone_cv.out_scale <- cv.glmnet(fvs23c_three_cone_x_scale[fvs23c_three_cone_train, ], fvs23c_three_cone_y_scale[fvs23c_three_cone_train], alpha = 1)
#plot(fvs23c_three_cone_cv.out)
fvs23c_three_cone_bestlam_scale <- fvs23c_three_cone_cv.out_scale$lambda.min
#fvs23c_three_cone_bestlam <- 1
fvs23c_three_cone_lasso.pred_scale <- predict(fvs23c_three_cone_lasso.mod_scale, s = fvs23c_three_cone_bestlam_scale,
    newx = fvs23c_three_cone_x_scale[fvs23c_three_cone_test, ])
mean((fvs23c_three_cone_lasso.pred_scale - fvs23c_three_cone_y.test_scale)^2)
```

```{r}
forty_vertical_shuttle_2_broad_jump <- combineonly %>% select(forty, vertical, shuttle, broad_jump) %>% 
  filter(!is.na(forty) & !is.na(vertical) & !is.na(shuttle) & !is.na(broad_jump))


fvs2bj_broad_jump_x <- model.matrix(broad_jump ~ ., forty_vertical_shuttle_2_broad_jump)
fvs2bj_broad_jump_y <- forty_vertical_shuttle_2_broad_jump$broad_jump
fvs2bj_broad_jump_x 
mean(fvs2bj_broad_jump_y)

set.seed(2)
fvs2bj_broad_jump_train <- sample(1:nrow(fvs2bj_broad_jump_x), .8*nrow(fvs2bj_broad_jump_x))
fvs2bj_broad_jump_test <- (-fvs2bj_broad_jump_train)
fvs2bj_broad_jump_y.test <- fvs2bj_broad_jump_y[fvs2bj_broad_jump_test]

grid <- 10^seq(-5, 5, length = 100)

fvs2bj_broad_jump_lasso.mod <- glmnet(fvs2bj_broad_jump_x[fvs2bj_broad_jump_train, ], fvs2bj_broad_jump_y[fvs2bj_broad_jump_train], alpha = 1,
    lambda = grid,intercept = TRUE ,standardize = TRUE)
plot(fvs2bj_broad_jump_lasso.mod)

set.seed(1)
fvs2bj_broad_jump_cv.out <- cv.glmnet(fvs2bj_broad_jump_x[fvs2bj_broad_jump_train, ], fvs2bj_broad_jump_y[fvs2bj_broad_jump_train], alpha = 1)
#plot(fvs2bj_broad_jump_cv.out)
fvs2bj_broad_jump_bestlam <- fvs2bj_broad_jump_cv.out$lambda.min
#fvs2bj_broad_jump_bestlam <- 1
fvs2bj_broad_jump_lasso.pred <- predict(fvs2bj_broad_jump_lasso.mod, s = fvs2bj_broad_jump_bestlam,
    newx = fvs2bj_broad_jump_x[fvs2bj_broad_jump_test, ])
mean((fvs2bj_broad_jump_lasso.pred - fvs2bj_broad_jump_y.test)^2)

fvs2bj_broad_jump_out <- glmnet(fvs2bj_broad_jump_x, fvs2bj_broad_jump_y, alpha = 1, lambda = fvs2bj_broad_jump_bestlam )
coef(fvs2bj_broad_jump_out)
fvs2bj_broad_jump_lasso.coef <- predict(fvs2bj_broad_jump_out, type = "coefficients",
    s = fvs2bj_broad_jump_bestlam)[1:(ncol(forty_vertical_shuttle_2_broad_jump)+1), ]
fvs2bj_broad_jump_lasso.coef
fvs2bj_broad_jump_lasso.coef[fvs2bj_broad_jump_lasso.coef != 0]

ggplot(forty_vertical_shuttle_2_broad_jump[-fvs2bj_broad_jump_train,] %>% mutate(pred = fvs2bj_broad_jump_lasso.pred),
       aes(x = pred, broad_jump)) +
  geom_point()



fvs2bj_broad_jump_x_scale <- model.matrix(scale(broad_jump) ~ scale(vertical) + scale(shuttle), forty_vertical_shuttle_2_broad_jump)
fvs2bj_broad_jump_y_scale <- (forty_vertical_shuttle_2_broad_jump %>% mutate(broad_jump = scale(broad_jump)))$broad_jump

set.seed(2)
fvs2bj_broad_jump_train <- sample(1:nrow(fvs2bj_broad_jump_x_scale), .8*nrow(fvs2bj_broad_jump_x_scale))
fvs2bj_broad_jump_test <- (-fvs2bj_broad_jump_train)
fvs2bj_broad_jump_y.test_scale <- fvs2bj_broad_jump_y_scale[fvs2bj_broad_jump_test]

fvs2bj_broad_jump_lasso.mod_scale <- glmnet(fvs2bj_broad_jump_x_scale[fvs2bj_broad_jump_train, ], fvs2bj_broad_jump_y_scale[fvs2bj_broad_jump_train], alpha = 1,
    lambda = grid,intercept = TRUE ,standardize = TRUE)

set.seed(1)
fvs2bj_broad_jump_cv.out_scale <- cv.glmnet(fvs2bj_broad_jump_x_scale[fvs2bj_broad_jump_train, ], fvs2bj_broad_jump_y_scale[fvs2bj_broad_jump_train], alpha = 1)
#plot(fvs2bj_broad_jump_cv.out)
fvs2bj_broad_jump_bestlam_scale <- fvs2bj_broad_jump_cv.out_scale$lambda.min
#fvs2bj_broad_jump_bestlam <- 1
fvs2bj_broad_jump_lasso.pred_scale <- predict(fvs2bj_broad_jump_lasso.mod_scale, s = fvs2bj_broad_jump_bestlam_scale,
    newx = fvs2bj_broad_jump_x_scale[fvs2bj_broad_jump_test, ])
mean((fvs2bj_broad_jump_lasso.pred_scale - fvs2bj_broad_jump_y.test_scale)^2)
```

# Use forty, vertical and shuttle to predict broad jump
```{r}
update12 <- update11 %>% mutate(broad_jump = if_else(
                           !is.na(forty) & !is.na(vertical) & is.na(broad_jump) & is.na(three_cone) & !is.na(shuttle),
                           fvs2bj_broad_jump_lasso.coef[fvs2bj_broad_jump_lasso.coef != 0][1] +
                             fvs2bj_broad_jump_lasso.coef[fvs2bj_broad_jump_lasso.coef != 0][2] * forty +
                             fvs2bj_broad_jump_lasso.coef[fvs2bj_broad_jump_lasso.coef != 0][3] * vertical +
                             fvs2bj_broad_jump_lasso.coef[fvs2bj_broad_jump_lasso.coef != 0][4] * shuttle,
                           broad_jump
                         )) 
```

# Vertical, broad jump and three cone to predict
```{r}
vertical_broad_jump_three_cone_2_forty <- combineonly %>% select(vertical, broad_jump, three_cone, forty) %>% 
  filter(!is.na(vertical) & !is.na(broad_jump) & !is.na(three_cone) & !is.na(forty))


vbj3c2f_forty_x <- model.matrix(forty ~ ., vertical_broad_jump_three_cone_2_forty)
vbj3c2f_forty_y <- vertical_broad_jump_three_cone_2_forty$forty
vbj3c2f_forty_x 
mean(vbj3c2f_forty_y)

set.seed(2)
vbj3c2f_forty_train <- sample(1:nrow(vbj3c2f_forty_x), .8*nrow(vbj3c2f_forty_x))
vbj3c2f_forty_test <- (-vbj3c2f_forty_train)
vbj3c2f_forty_y.test <- vbj3c2f_forty_y[vbj3c2f_forty_test]

grid <- 10^seq(-5, 5, length = 100)

vbj3c2f_forty_lasso.mod <- glmnet(vbj3c2f_forty_x[vbj3c2f_forty_train, ], vbj3c2f_forty_y[vbj3c2f_forty_train], alpha = 1,
    lambda = grid,intercept = TRUE ,standardize = TRUE)
plot(vbj3c2f_forty_lasso.mod)

set.seed(1)
vbj3c2f_forty_cv.out <- cv.glmnet(vbj3c2f_forty_x[vbj3c2f_forty_train, ], vbj3c2f_forty_y[vbj3c2f_forty_train], alpha = 1)
#plot(vbj3c2f_forty_cv.out)
vbj3c2f_forty_bestlam <- vbj3c2f_forty_cv.out$lambda.min
#vbj3c2f_forty_bestlam <- 1
vbj3c2f_forty_lasso.pred <- predict(vbj3c2f_forty_lasso.mod, s = vbj3c2f_forty_bestlam,
    newx = vbj3c2f_forty_x[vbj3c2f_forty_test, ])
mean((vbj3c2f_forty_lasso.pred - vbj3c2f_forty_y.test)^2)

vbj3c2f_forty_out <- glmnet(vbj3c2f_forty_x, vbj3c2f_forty_y, alpha = 1, lambda = vbj3c2f_forty_bestlam )
coef(vbj3c2f_forty_out)
vbj3c2f_forty_lasso.coef <- predict(vbj3c2f_forty_out, type = "coefficients",
    s = vbj3c2f_forty_bestlam)[1:(ncol(vertical_broad_jump_three_cone_2_forty)+1), ]
vbj3c2f_forty_lasso.coef
vbj3c2f_forty_lasso.coef[vbj3c2f_forty_lasso.coef != 0]

ggplot(vertical_broad_jump_three_cone_2_forty[-vbj3c2f_forty_train,] %>% mutate(pred = vbj3c2f_forty_lasso.pred),
       aes(x = pred, forty)) +
  geom_point()



vbj3c2f_forty_x_scale <- model.matrix(scale(forty) ~ scale(broad_jump) + scale(three_cone), vertical_broad_jump_three_cone_2_forty)
vbj3c2f_forty_y_scale <- (vertical_broad_jump_three_cone_2_forty %>% mutate(forty = scale(forty)))$forty

set.seed(2)
vbj3c2f_forty_train <- sample(1:nrow(vbj3c2f_forty_x_scale), .8*nrow(vbj3c2f_forty_x_scale))
vbj3c2f_forty_test <- (-vbj3c2f_forty_train)
vbj3c2f_forty_y.test_scale <- vbj3c2f_forty_y_scale[vbj3c2f_forty_test]

vbj3c2f_forty_lasso.mod_scale <- glmnet(vbj3c2f_forty_x_scale[vbj3c2f_forty_train, ], vbj3c2f_forty_y_scale[vbj3c2f_forty_train], alpha = 1,
    lambda = grid,intercept = TRUE ,standardize = TRUE)

set.seed(1)
vbj3c2f_forty_cv.out_scale <- cv.glmnet(vbj3c2f_forty_x_scale[vbj3c2f_forty_train, ], vbj3c2f_forty_y_scale[vbj3c2f_forty_train], alpha = 1)
#plot(vbj3c2f_forty_cv.out)
vbj3c2f_forty_bestlam_scale <- vbj3c2f_forty_cv.out_scale$lambda.min
#vbj3c2f_forty_bestlam <- 1
vbj3c2f_forty_lasso.pred_scale <- predict(vbj3c2f_forty_lasso.mod_scale, s = vbj3c2f_forty_bestlam_scale,
    newx = vbj3c2f_forty_x_scale[vbj3c2f_forty_test, ])
mean((vbj3c2f_forty_lasso.pred_scale - vbj3c2f_forty_y.test_scale)^2)
```

```{r}
vertical_broad_jump_three_cone_2_shuttle <- combineonly %>% select(vertical, broad_jump, three_cone, shuttle) %>% 
  filter(!is.na(vertical) & !is.na(broad_jump) & !is.na(three_cone) & !is.na(shuttle))


vbj3c2s_shuttle_x <- model.matrix(shuttle ~ ., vertical_broad_jump_three_cone_2_shuttle)
vbj3c2s_shuttle_y <- vertical_broad_jump_three_cone_2_shuttle$shuttle
vbj3c2s_shuttle_x 
mean(vbj3c2s_shuttle_y)

set.seed(2)
vbj3c2s_shuttle_train <- sample(1:nrow(vbj3c2s_shuttle_x), .8*nrow(vbj3c2s_shuttle_x))
vbj3c2s_shuttle_test <- (-vbj3c2s_shuttle_train)
vbj3c2s_shuttle_y.test <- vbj3c2s_shuttle_y[vbj3c2s_shuttle_test]

grid <- 10^seq(-5, 5, length = 100)

vbj3c2s_shuttle_lasso.mod <- glmnet(vbj3c2s_shuttle_x[vbj3c2s_shuttle_train, ], vbj3c2s_shuttle_y[vbj3c2s_shuttle_train], alpha = 1,
    lambda = grid,intercept = TRUE ,standardize = TRUE)
plot(vbj3c2s_shuttle_lasso.mod)

set.seed(1)
vbj3c2s_shuttle_cv.out <- cv.glmnet(vbj3c2s_shuttle_x[vbj3c2s_shuttle_train, ], vbj3c2s_shuttle_y[vbj3c2s_shuttle_train], alpha = 1)
#plot(vbj3c2s_shuttle_cv.out)
vbj3c2s_shuttle_bestlam <- vbj3c2s_shuttle_cv.out$lambda.min
#vbj3c2s_shuttle_bestlam <- 1
vbj3c2s_shuttle_lasso.pred <- predict(vbj3c2s_shuttle_lasso.mod, s = vbj3c2s_shuttle_bestlam,
    newx = vbj3c2s_shuttle_x[vbj3c2s_shuttle_test, ])
mean((vbj3c2s_shuttle_lasso.pred - vbj3c2s_shuttle_y.test)^2)

vbj3c2s_shuttle_out <- glmnet(vbj3c2s_shuttle_x, vbj3c2s_shuttle_y, alpha = 1, lambda = vbj3c2s_shuttle_bestlam )
coef(vbj3c2s_shuttle_out)
vbj3c2s_shuttle_lasso.coef <- predict(vbj3c2s_shuttle_out, type = "coefficients",
    s = vbj3c2s_shuttle_bestlam)[1:(ncol(vertical_broad_jump_three_cone_2_shuttle)+1), ]
vbj3c2s_shuttle_lasso.coef
vbj3c2s_shuttle_lasso.coef[vbj3c2s_shuttle_lasso.coef != 0]

ggplot(vertical_broad_jump_three_cone_2_shuttle[-vbj3c2s_shuttle_train,] %>% mutate(pred = vbj3c2s_shuttle_lasso.pred),
       aes(x = pred, shuttle)) +
  geom_point()



vbj3c2s_shuttle_x_scale <- model.matrix(scale(shuttle) ~ scale(broad_jump) + scale(three_cone), vertical_broad_jump_three_cone_2_shuttle)
vbj3c2s_shuttle_y_scale <- (vertical_broad_jump_three_cone_2_shuttle %>% mutate(shuttle = scale(shuttle)))$shuttle

set.seed(2)
vbj3c2s_shuttle_train <- sample(1:nrow(vbj3c2s_shuttle_x_scale), .8*nrow(vbj3c2s_shuttle_x_scale))
vbj3c2s_shuttle_test <- (-vbj3c2s_shuttle_train)
vbj3c2s_shuttle_y.test_scale <- vbj3c2s_shuttle_y_scale[vbj3c2s_shuttle_test]

vbj3c2s_shuttle_lasso.mod_scale <- glmnet(vbj3c2s_shuttle_x_scale[vbj3c2s_shuttle_train, ], vbj3c2s_shuttle_y_scale[vbj3c2s_shuttle_train], alpha = 1,
    lambda = grid,intercept = TRUE ,standardize = TRUE)

set.seed(1)
vbj3c2s_shuttle_cv.out_scale <- cv.glmnet(vbj3c2s_shuttle_x_scale[vbj3c2s_shuttle_train, ], vbj3c2s_shuttle_y_scale[vbj3c2s_shuttle_train], alpha = 1)
#plot(vbj3c2s_shuttle_cv.out)
vbj3c2s_shuttle_bestlam_scale <- vbj3c2s_shuttle_cv.out_scale$lambda.min
#vbj3c2s_shuttle_bestlam <- 1
vbj3c2s_shuttle_lasso.pred_scale <- predict(vbj3c2s_shuttle_lasso.mod_scale, s = vbj3c2s_shuttle_bestlam_scale,
    newx = vbj3c2s_shuttle_x_scale[vbj3c2s_shuttle_test, ])
mean((vbj3c2s_shuttle_lasso.pred_scale - vbj3c2s_shuttle_y.test_scale)^2)
```

# Use vertical, broad jump and three cone to predict shuttle
```{r}
update13 <- update12 %>% mutate(shuttle = if_else(
                           is.na(forty) & !is.na(vertical) & !is.na(broad_jump) & !is.na(three_cone) & is.na(shuttle),
                           vbj3c2s_shuttle_lasso.coef[vbj3c2s_shuttle_lasso.coef != 0][1] +
                             vbj3c2s_shuttle_lasso.coef[vbj3c2s_shuttle_lasso.coef != 0][2] * vertical +
                             vbj3c2s_shuttle_lasso.coef[vbj3c2s_shuttle_lasso.coef != 0][3] * broad_jump +
                             vbj3c2s_shuttle_lasso.coef[vbj3c2s_shuttle_lasso.coef != 0][4] * three_cone,
                           shuttle
                         )) 
```

# Use forty, broad jump, and shuttle to predict
```{r}
forty_broad_jump_shuttle_2_three_cone <- combineonly %>% select(forty, broad_jump, shuttle, three_cone) %>% 
  filter(!is.na(forty) & !is.na(broad_jump) & !is.na(shuttle) & !is.na(three_cone))


fbjs23c_three_cone_x <- model.matrix(three_cone ~ ., forty_broad_jump_shuttle_2_three_cone)
fbjs23c_three_cone_y <- forty_broad_jump_shuttle_2_three_cone$three_cone
fbjs23c_three_cone_x 
mean(fbjs23c_three_cone_y)

set.seed(2)
fbjs23c_three_cone_train <- sample(1:nrow(fbjs23c_three_cone_x), .8*nrow(fbjs23c_three_cone_x))
fbjs23c_three_cone_test <- (-fbjs23c_three_cone_train)
fbjs23c_three_cone_y.test <- fbjs23c_three_cone_y[fbjs23c_three_cone_test]

grid <- 10^seq(-5, 5, length = 100)

fbjs23c_three_cone_lasso.mod <- glmnet(fbjs23c_three_cone_x[fbjs23c_three_cone_train, ], fbjs23c_three_cone_y[fbjs23c_three_cone_train], alpha = 1,
    lambda = grid,intercept = TRUE ,standardize = TRUE)
plot(fbjs23c_three_cone_lasso.mod)

set.seed(1)
fbjs23c_three_cone_cv.out <- cv.glmnet(fbjs23c_three_cone_x[fbjs23c_three_cone_train, ], fbjs23c_three_cone_y[fbjs23c_three_cone_train], alpha = 1)
#plot(fbjs23c_three_cone_cv.out)
fbjs23c_three_cone_bestlam <- fbjs23c_three_cone_cv.out$lambda.min
#fbjs23c_three_cone_bestlam <- 1
fbjs23c_three_cone_lasso.pred <- predict(fbjs23c_three_cone_lasso.mod, s = fbjs23c_three_cone_bestlam,
    newx = fbjs23c_three_cone_x[fbjs23c_three_cone_test, ])
mean((fbjs23c_three_cone_lasso.pred - fbjs23c_three_cone_y.test)^2)

fbjs23c_three_cone_out <- glmnet(fbjs23c_three_cone_x, fbjs23c_three_cone_y, alpha = 1, lambda = fbjs23c_three_cone_bestlam )
coef(fbjs23c_three_cone_out)
fbjs23c_three_cone_lasso.coef <- predict(fbjs23c_three_cone_out, type = "coefficients",
    s = fbjs23c_three_cone_bestlam)[1:(ncol(forty_broad_jump_shuttle_2_three_cone)+1), ]
fbjs23c_three_cone_lasso.coef
fbjs23c_three_cone_lasso.coef[fbjs23c_three_cone_lasso.coef != 0]

ggplot(forty_broad_jump_shuttle_2_three_cone[-fbjs23c_three_cone_train,] %>% mutate(pred = fbjs23c_three_cone_lasso.pred),
       aes(x = pred, three_cone)) +
  geom_point()



fbjs23c_three_cone_x_scale <- model.matrix(scale(three_cone) ~ scale(broad_jump) + scale(shuttle), forty_broad_jump_shuttle_2_three_cone)
fbjs23c_three_cone_y_scale <- (forty_broad_jump_shuttle_2_three_cone %>% mutate(three_cone = scale(three_cone)))$three_cone

set.seed(2)
fbjs23c_three_cone_train <- sample(1:nrow(fbjs23c_three_cone_x_scale), .8*nrow(fbjs23c_three_cone_x_scale))
fbjs23c_three_cone_test <- (-fbjs23c_three_cone_train)
fbjs23c_three_cone_y.test_scale <- fbjs23c_three_cone_y_scale[fbjs23c_three_cone_test]

fbjs23c_three_cone_lasso.mod_scale <- glmnet(fbjs23c_three_cone_x_scale[fbjs23c_three_cone_train, ], fbjs23c_three_cone_y_scale[fbjs23c_three_cone_train], alpha = 1,
    lambda = grid,intercept = TRUE ,standardize = TRUE)

set.seed(1)
fbjs23c_three_cone_cv.out_scale <- cv.glmnet(fbjs23c_three_cone_x_scale[fbjs23c_three_cone_train, ], fbjs23c_three_cone_y_scale[fbjs23c_three_cone_train], alpha = 1)
#plot(fbjs23c_three_cone_cv.out)
fbjs23c_three_cone_bestlam_scale <- fbjs23c_three_cone_cv.out_scale$lambda.min
#fbjs23c_three_cone_bestlam <- 1
fbjs23c_three_cone_lasso.pred_scale <- predict(fbjs23c_three_cone_lasso.mod_scale, s = fbjs23c_three_cone_bestlam_scale,
    newx = fbjs23c_three_cone_x_scale[fbjs23c_three_cone_test, ])
mean((fbjs23c_three_cone_lasso.pred_scale - fbjs23c_three_cone_y.test_scale)^2)
```

```{r}
forty_broad_jump_shuttle_2_vertical <- combineonly %>% select(forty, broad_jump, shuttle, vertical) %>% 
  filter(!is.na(forty) & !is.na(broad_jump) & !is.na(shuttle) & !is.na(vertical))


fbjs2v_vertical_x <- model.matrix(vertical ~ ., forty_broad_jump_shuttle_2_vertical)
fbjs2v_vertical_y <- forty_broad_jump_shuttle_2_vertical$vertical
fbjs2v_vertical_x 
mean(fbjs2v_vertical_y)

set.seed(2)
fbjs2v_vertical_train <- sample(1:nrow(fbjs2v_vertical_x), .8*nrow(fbjs2v_vertical_x))
fbjs2v_vertical_test <- (-fbjs2v_vertical_train)
fbjs2v_vertical_y.test <- fbjs2v_vertical_y[fbjs2v_vertical_test]

grid <- 10^seq(-5, 5, length = 100)

fbjs2v_vertical_lasso.mod <- glmnet(fbjs2v_vertical_x[fbjs2v_vertical_train, ], fbjs2v_vertical_y[fbjs2v_vertical_train], alpha = 1,
    lambda = grid,intercept = TRUE ,standardize = TRUE)
plot(fbjs2v_vertical_lasso.mod)

set.seed(1)
fbjs2v_vertical_cv.out <- cv.glmnet(fbjs2v_vertical_x[fbjs2v_vertical_train, ], fbjs2v_vertical_y[fbjs2v_vertical_train], alpha = 1)
#plot(fbjs2v_vertical_cv.out)
fbjs2v_vertical_bestlam <- fbjs2v_vertical_cv.out$lambda.min
#fbjs2v_vertical_bestlam <- 1
fbjs2v_vertical_lasso.pred <- predict(fbjs2v_vertical_lasso.mod, s = fbjs2v_vertical_bestlam,
    newx = fbjs2v_vertical_x[fbjs2v_vertical_test, ])
mean((fbjs2v_vertical_lasso.pred - fbjs2v_vertical_y.test)^2)

fbjs2v_vertical_out <- glmnet(fbjs2v_vertical_x, fbjs2v_vertical_y, alpha = 1, lambda = fbjs2v_vertical_bestlam )
coef(fbjs2v_vertical_out)
fbjs2v_vertical_lasso.coef <- predict(fbjs2v_vertical_out, type = "coefficients",
    s = fbjs2v_vertical_bestlam)[1:(ncol(forty_broad_jump_shuttle_2_vertical)+1), ]
fbjs2v_vertical_lasso.coef
fbjs2v_vertical_lasso.coef[fbjs2v_vertical_lasso.coef != 0]

ggplot(forty_broad_jump_shuttle_2_vertical[-fbjs2v_vertical_train,] %>% mutate(pred = fbjs2v_vertical_lasso.pred),
       aes(x = pred, vertical)) +
  geom_point()



fbjs2v_vertical_x_scale <- model.matrix(scale(vertical) ~ scale(broad_jump) + scale(shuttle), forty_broad_jump_shuttle_2_vertical)
fbjs2v_vertical_y_scale <- (forty_broad_jump_shuttle_2_vertical %>% mutate(vertical = scale(vertical)))$vertical

set.seed(2)
fbjs2v_vertical_train <- sample(1:nrow(fbjs2v_vertical_x_scale), .8*nrow(fbjs2v_vertical_x_scale))
fbjs2v_vertical_test <- (-fbjs2v_vertical_train)
fbjs2v_vertical_y.test_scale <- fbjs2v_vertical_y_scale[fbjs2v_vertical_test]

fbjs2v_vertical_lasso.mod_scale <- glmnet(fbjs2v_vertical_x_scale[fbjs2v_vertical_train, ], fbjs2v_vertical_y_scale[fbjs2v_vertical_train], alpha = 1,
    lambda = grid,intercept = TRUE ,standardize = TRUE)

set.seed(1)
fbjs2v_vertical_cv.out_scale <- cv.glmnet(fbjs2v_vertical_x_scale[fbjs2v_vertical_train, ], fbjs2v_vertical_y_scale[fbjs2v_vertical_train], alpha = 1)
#plot(fbjs2v_vertical_cv.out)
fbjs2v_vertical_bestlam_scale <- fbjs2v_vertical_cv.out_scale$lambda.min
#fbjs2v_vertical_bestlam <- 1
fbjs2v_vertical_lasso.pred_scale <- predict(fbjs2v_vertical_lasso.mod_scale, s = fbjs2v_vertical_bestlam_scale,
    newx = fbjs2v_vertical_x_scale[fbjs2v_vertical_test, ])
mean((fbjs2v_vertical_lasso.pred_scale - fbjs2v_vertical_y.test_scale)^2)
```


# Use forty, broad jump and shuttle to predict vertical
```{r}
update14 <- update13 %>% mutate(vertical = if_else(
                           !is.na(forty) & is.na(vertical) & !is.na(broad_jump) & is.na(three_cone) & !is.na(shuttle),
                           fbjs2v_vertical_lasso.coef[fbjs2v_vertical_lasso.coef != 0][1] +
                             fbjs2v_vertical_lasso.coef[fbjs2v_vertical_lasso.coef != 0][2] * forty +
                             fbjs2v_vertical_lasso.coef[fbjs2v_vertical_lasso.coef != 0][3] * broad_jump +
                             fbjs2v_vertical_lasso.coef[fbjs2v_vertical_lasso.coef != 0][4] * shuttle,
                           vertical
                         )) 
```

# Use vertical, broad jump, and shuttle to predict
```{r}
vertical_broad_jump_shuttle_2_three_cone <- combineonly %>% select(vertical, broad_jump, shuttle, three_cone) %>% 
  filter(!is.na(vertical) & !is.na(broad_jump) & !is.na(shuttle) & !is.na(three_cone))


vbjs23c_three_cone_x <- model.matrix(three_cone ~ ., vertical_broad_jump_shuttle_2_three_cone)
vbjs23c_three_cone_y <- vertical_broad_jump_shuttle_2_three_cone$three_cone
vbjs23c_three_cone_x 
mean(vbjs23c_three_cone_y)

set.seed(2)
vbjs23c_three_cone_train <- sample(1:nrow(vbjs23c_three_cone_x), .8*nrow(vbjs23c_three_cone_x))
vbjs23c_three_cone_test <- (-vbjs23c_three_cone_train)
vbjs23c_three_cone_y.test <- vbjs23c_three_cone_y[vbjs23c_three_cone_test]

grid <- 10^seq(-5, 5, length = 100)

vbjs23c_three_cone_lasso.mod <- glmnet(vbjs23c_three_cone_x[vbjs23c_three_cone_train, ], vbjs23c_three_cone_y[vbjs23c_three_cone_train], alpha = 1,
    lambda = grid,intercept = TRUE ,standardize = TRUE)
plot(vbjs23c_three_cone_lasso.mod)

set.seed(1)
vbjs23c_three_cone_cv.out <- cv.glmnet(vbjs23c_three_cone_x[vbjs23c_three_cone_train, ], vbjs23c_three_cone_y[vbjs23c_three_cone_train], alpha = 1)
#plot(vbjs23c_three_cone_cv.out)
vbjs23c_three_cone_bestlam <- vbjs23c_three_cone_cv.out$lambda.min
#vbjs23c_three_cone_bestlam <- 1
vbjs23c_three_cone_lasso.pred <- predict(vbjs23c_three_cone_lasso.mod, s = vbjs23c_three_cone_bestlam,
    newx = vbjs23c_three_cone_x[vbjs23c_three_cone_test, ])
mean((vbjs23c_three_cone_lasso.pred - vbjs23c_three_cone_y.test)^2)

vbjs23c_three_cone_out <- glmnet(vbjs23c_three_cone_x, vbjs23c_three_cone_y, alpha = 1, lambda = vbjs23c_three_cone_bestlam )
coef(vbjs23c_three_cone_out)
vbjs23c_three_cone_lasso.coef <- predict(vbjs23c_three_cone_out, type = "coefficients",
    s = vbjs23c_three_cone_bestlam)[1:(ncol(vertical_broad_jump_shuttle_2_three_cone)+1), ]
vbjs23c_three_cone_lasso.coef
vbjs23c_three_cone_lasso.coef[vbjs23c_three_cone_lasso.coef != 0]

ggplot(vertical_broad_jump_shuttle_2_three_cone[-vbjs23c_three_cone_train,] %>% mutate(pred = vbjs23c_three_cone_lasso.pred),
       aes(x = pred, three_cone)) +
  geom_point()



vbjs23c_three_cone_x_scale <- model.matrix(scale(three_cone) ~ scale(broad_jump) + scale(shuttle), vertical_broad_jump_shuttle_2_three_cone)
vbjs23c_three_cone_y_scale <- (vertical_broad_jump_shuttle_2_three_cone %>% mutate(three_cone = scale(three_cone)))$three_cone

set.seed(2)
vbjs23c_three_cone_train <- sample(1:nrow(vbjs23c_three_cone_x_scale), .8*nrow(vbjs23c_three_cone_x_scale))
vbjs23c_three_cone_test <- (-vbjs23c_three_cone_train)
vbjs23c_three_cone_y.test_scale <- vbjs23c_three_cone_y_scale[vbjs23c_three_cone_test]

vbjs23c_three_cone_lasso.mod_scale <- glmnet(vbjs23c_three_cone_x_scale[vbjs23c_three_cone_train, ], vbjs23c_three_cone_y_scale[vbjs23c_three_cone_train], alpha = 1,
    lambda = grid,intercept = TRUE ,standardize = TRUE)

set.seed(1)
vbjs23c_three_cone_cv.out_scale <- cv.glmnet(vbjs23c_three_cone_x_scale[vbjs23c_three_cone_train, ], vbjs23c_three_cone_y_scale[vbjs23c_three_cone_train], alpha = 1)
#plot(vbjs23c_three_cone_cv.out)
vbjs23c_three_cone_bestlam_scale <- vbjs23c_three_cone_cv.out_scale$lambda.min
#vbjs23c_three_cone_bestlam <- 1
vbjs23c_three_cone_lasso.pred_scale <- predict(vbjs23c_three_cone_lasso.mod_scale, s = vbjs23c_three_cone_bestlam_scale,
    newx = vbjs23c_three_cone_x_scale[vbjs23c_three_cone_test, ])
mean((vbjs23c_three_cone_lasso.pred_scale - vbjs23c_three_cone_y.test_scale)^2)
```

```{r}
vertical_broad_jump_shuttle_2_forty <- combineonly %>% select(vertical, broad_jump, shuttle, forty) %>% 
  filter(!is.na(vertical) & !is.na(broad_jump) & !is.na(shuttle) & !is.na(forty))


vbjs2f_forty_x <- model.matrix(forty ~ ., vertical_broad_jump_shuttle_2_forty)
vbjs2f_forty_y <- vertical_broad_jump_shuttle_2_forty$forty
vbjs2f_forty_x 
mean(vbjs2f_forty_y)

set.seed(2)
vbjs2f_forty_train <- sample(1:nrow(vbjs2f_forty_x), .8*nrow(vbjs2f_forty_x))
vbjs2f_forty_test <- (-vbjs2f_forty_train)
vbjs2f_forty_y.test <- vbjs2f_forty_y[vbjs2f_forty_test]

grid <- 10^seq(-5, 5, length = 100)

vbjs2f_forty_lasso.mod <- glmnet(vbjs2f_forty_x[vbjs2f_forty_train, ], vbjs2f_forty_y[vbjs2f_forty_train], alpha = 1,
    lambda = grid,intercept = TRUE ,standardize = TRUE)
plot(vbjs2f_forty_lasso.mod)

set.seed(1)
vbjs2f_forty_cv.out <- cv.glmnet(vbjs2f_forty_x[vbjs2f_forty_train, ], vbjs2f_forty_y[vbjs2f_forty_train], alpha = 1)
#plot(vbjs2f_forty_cv.out)
vbjs2f_forty_bestlam <- vbjs2f_forty_cv.out$lambda.min
#vbjs2f_forty_bestlam <- 1
vbjs2f_forty_lasso.pred <- predict(vbjs2f_forty_lasso.mod, s = vbjs2f_forty_bestlam,
    newx = vbjs2f_forty_x[vbjs2f_forty_test, ])
mean((vbjs2f_forty_lasso.pred - vbjs2f_forty_y.test)^2)

vbjs2f_forty_out <- glmnet(vbjs2f_forty_x, vbjs2f_forty_y, alpha = 1, lambda = vbjs2f_forty_bestlam )
coef(vbjs2f_forty_out)
vbjs2f_forty_lasso.coef <- predict(vbjs2f_forty_out, type = "coefficients",
    s = vbjs2f_forty_bestlam)[1:(ncol(vertical_broad_jump_shuttle_2_forty)+1), ]
vbjs2f_forty_lasso.coef
vbjs2f_forty_lasso.coef[vbjs2f_forty_lasso.coef != 0]

ggplot(vertical_broad_jump_shuttle_2_forty[-vbjs2f_forty_train,] %>% mutate(pred = vbjs2f_forty_lasso.pred),
       aes(x = pred, forty)) +
  geom_point()



vbjs2f_forty_x_scale <- model.matrix(scale(forty) ~ scale(broad_jump) + scale(shuttle), vertical_broad_jump_shuttle_2_forty)
vbjs2f_forty_y_scale <- (vertical_broad_jump_shuttle_2_forty %>% mutate(forty = scale(forty)))$forty

set.seed(2)
vbjs2f_forty_train <- sample(1:nrow(vbjs2f_forty_x_scale), .8*nrow(vbjs2f_forty_x_scale))
vbjs2f_forty_test <- (-vbjs2f_forty_train)
vbjs2f_forty_y.test_scale <- vbjs2f_forty_y_scale[vbjs2f_forty_test]

vbjs2f_forty_lasso.mod_scale <- glmnet(vbjs2f_forty_x_scale[vbjs2f_forty_train, ], vbjs2f_forty_y_scale[vbjs2f_forty_train], alpha = 1,
    lambda = grid,intercept = TRUE ,standardize = TRUE)

set.seed(1)
vbjs2f_forty_cv.out_scale <- cv.glmnet(vbjs2f_forty_x_scale[vbjs2f_forty_train, ], vbjs2f_forty_y_scale[vbjs2f_forty_train], alpha = 1)
#plot(vbjs2f_forty_cv.out)
vbjs2f_forty_bestlam_scale <- vbjs2f_forty_cv.out_scale$lambda.min
#vbjs2f_forty_bestlam <- 1
vbjs2f_forty_lasso.pred_scale <- predict(vbjs2f_forty_lasso.mod_scale, s = vbjs2f_forty_bestlam_scale,
    newx = vbjs2f_forty_x_scale[vbjs2f_forty_test, ])
mean((vbjs2f_forty_lasso.pred_scale - vbjs2f_forty_y.test_scale)^2)
```

# Use vertical, broad jump and shuttle to predict three cone
```{r}
update15 <- update14 %>% mutate(three_cone = if_else(
                           is.na(forty) & !is.na(vertical) & !is.na(broad_jump) & is.na(three_cone) & !is.na(shuttle),
                           vbjs23c_three_cone_lasso.coef[vbjs23c_three_cone_lasso.coef != 0][1] +
                             vbjs23c_three_cone_lasso.coef[vbjs23c_three_cone_lasso.coef != 0][2] * vertical +
                             vbjs23c_three_cone_lasso.coef[vbjs23c_three_cone_lasso.coef != 0][3] * broad_jump +
                             vbjs23c_three_cone_lasso.coef[vbjs23c_three_cone_lasso.coef != 0][4] * shuttle,
                           three_cone
                         )) 
```

# Use vertical, three cone and shuttle to predict
```{r}
vertical_three_cone_shuttle_2_forty <- combineonly %>% select(vertical, three_cone, shuttle, forty) %>% 
  filter(!is.na(vertical) & !is.na(three_cone) & !is.na(shuttle) & !is.na(forty))


v3cs2f_forty_x <- model.matrix(forty ~ ., vertical_three_cone_shuttle_2_forty)
v3cs2f_forty_y <- vertical_three_cone_shuttle_2_forty$forty
v3cs2f_forty_x 
mean(v3cs2f_forty_y)

set.seed(2)
v3cs2f_forty_train <- sample(1:nrow(v3cs2f_forty_x), .8*nrow(v3cs2f_forty_x))
v3cs2f_forty_test <- (-v3cs2f_forty_train)
v3cs2f_forty_y.test <- v3cs2f_forty_y[v3cs2f_forty_test]

grid <- 10^seq(-5, 5, length = 100)

v3cs2f_forty_lasso.mod <- glmnet(v3cs2f_forty_x[v3cs2f_forty_train, ], v3cs2f_forty_y[v3cs2f_forty_train], alpha = 1,
    lambda = grid,intercept = TRUE ,standardize = TRUE)
plot(v3cs2f_forty_lasso.mod)

set.seed(1)
v3cs2f_forty_cv.out <- cv.glmnet(v3cs2f_forty_x[v3cs2f_forty_train, ], v3cs2f_forty_y[v3cs2f_forty_train], alpha = 1)
#plot(v3cs2f_forty_cv.out)
v3cs2f_forty_bestlam <- v3cs2f_forty_cv.out$lambda.min
#v3cs2f_forty_bestlam <- 1
v3cs2f_forty_lasso.pred <- predict(v3cs2f_forty_lasso.mod, s = v3cs2f_forty_bestlam,
    newx = v3cs2f_forty_x[v3cs2f_forty_test, ])
mean((v3cs2f_forty_lasso.pred - v3cs2f_forty_y.test)^2)

v3cs2f_forty_out <- glmnet(v3cs2f_forty_x, v3cs2f_forty_y, alpha = 1, lambda = v3cs2f_forty_bestlam )
coef(v3cs2f_forty_out)
v3cs2f_forty_lasso.coef <- predict(v3cs2f_forty_out, type = "coefficients",
    s = v3cs2f_forty_bestlam)[1:(ncol(vertical_three_cone_shuttle_2_forty)+1), ]
v3cs2f_forty_lasso.coef
v3cs2f_forty_lasso.coef[v3cs2f_forty_lasso.coef != 0]

ggplot(vertical_three_cone_shuttle_2_forty[-v3cs2f_forty_train,] %>% mutate(pred = v3cs2f_forty_lasso.pred),
       aes(x = pred, forty)) +
  geom_point()



v3cs2f_forty_x_scale <- model.matrix(scale(forty) ~ scale(three_cone) + scale(shuttle), vertical_three_cone_shuttle_2_forty)
v3cs2f_forty_y_scale <- (vertical_three_cone_shuttle_2_forty %>% mutate(forty = scale(forty)))$forty

set.seed(2)
v3cs2f_forty_train <- sample(1:nrow(v3cs2f_forty_x_scale), .8*nrow(v3cs2f_forty_x_scale))
v3cs2f_forty_test <- (-v3cs2f_forty_train)
v3cs2f_forty_y.test_scale <- v3cs2f_forty_y_scale[v3cs2f_forty_test]

v3cs2f_forty_lasso.mod_scale <- glmnet(v3cs2f_forty_x_scale[v3cs2f_forty_train, ], v3cs2f_forty_y_scale[v3cs2f_forty_train], alpha = 1,
    lambda = grid,intercept = TRUE ,standardize = TRUE)

set.seed(1)
v3cs2f_forty_cv.out_scale <- cv.glmnet(v3cs2f_forty_x_scale[v3cs2f_forty_train, ], v3cs2f_forty_y_scale[v3cs2f_forty_train], alpha = 1)
#plot(v3cs2f_forty_cv.out)
v3cs2f_forty_bestlam_scale <- v3cs2f_forty_cv.out_scale$lambda.min
#v3cs2f_forty_bestlam <- 1
v3cs2f_forty_lasso.pred_scale <- predict(v3cs2f_forty_lasso.mod_scale, s = v3cs2f_forty_bestlam_scale,
    newx = v3cs2f_forty_x_scale[v3cs2f_forty_test, ])
mean((v3cs2f_forty_lasso.pred_scale - v3cs2f_forty_y.test_scale)^2)
```

```{r}
vertical_three_cone_shuttle_2_broad_jump <- combineonly %>% select(vertical, three_cone, shuttle, broad_jump) %>% 
  filter(!is.na(vertical) & !is.na(three_cone) & !is.na(shuttle) & !is.na(broad_jump))


v3cs2bj_broad_jump_x <- model.matrix(broad_jump ~ ., vertical_three_cone_shuttle_2_broad_jump)
v3cs2bj_broad_jump_y <- vertical_three_cone_shuttle_2_broad_jump$broad_jump
v3cs2bj_broad_jump_x 
mean(v3cs2bj_broad_jump_y)

set.seed(2)
v3cs2bj_broad_jump_train <- sample(1:nrow(v3cs2bj_broad_jump_x), .8*nrow(v3cs2bj_broad_jump_x))
v3cs2bj_broad_jump_test <- (-v3cs2bj_broad_jump_train)
v3cs2bj_broad_jump_y.test <- v3cs2bj_broad_jump_y[v3cs2bj_broad_jump_test]

grid <- 10^seq(-5, 5, length = 100)

v3cs2bj_broad_jump_lasso.mod <- glmnet(v3cs2bj_broad_jump_x[v3cs2bj_broad_jump_train, ], v3cs2bj_broad_jump_y[v3cs2bj_broad_jump_train], alpha = 1,
    lambda = grid,intercept = TRUE ,standardize = TRUE)
plot(v3cs2bj_broad_jump_lasso.mod)

set.seed(1)
v3cs2bj_broad_jump_cv.out <- cv.glmnet(v3cs2bj_broad_jump_x[v3cs2bj_broad_jump_train, ], v3cs2bj_broad_jump_y[v3cs2bj_broad_jump_train], alpha = 1)
#plot(v3cs2bj_broad_jump_cv.out)
v3cs2bj_broad_jump_bestlam <- v3cs2bj_broad_jump_cv.out$lambda.min
#v3cs2bj_broad_jump_bestlam <- 1
v3cs2bj_broad_jump_lasso.pred <- predict(v3cs2bj_broad_jump_lasso.mod, s = v3cs2bj_broad_jump_bestlam,
    newx = v3cs2bj_broad_jump_x[v3cs2bj_broad_jump_test, ])
mean((v3cs2bj_broad_jump_lasso.pred - v3cs2bj_broad_jump_y.test)^2)

v3cs2bj_broad_jump_out <- glmnet(v3cs2bj_broad_jump_x, v3cs2bj_broad_jump_y, alpha = 1, lambda = v3cs2bj_broad_jump_bestlam )
coef(v3cs2bj_broad_jump_out)
v3cs2bj_broad_jump_lasso.coef <- predict(v3cs2bj_broad_jump_out, type = "coefficients",
    s = v3cs2bj_broad_jump_bestlam)[1:(ncol(vertical_three_cone_shuttle_2_broad_jump)+1), ]
v3cs2bj_broad_jump_lasso.coef
v3cs2bj_broad_jump_lasso.coef[v3cs2bj_broad_jump_lasso.coef != 0]

ggplot(vertical_three_cone_shuttle_2_broad_jump[-v3cs2bj_broad_jump_train,] %>% mutate(pred = v3cs2bj_broad_jump_lasso.pred),
       aes(x = pred, broad_jump)) +
  geom_point()



v3cs2bj_broad_jump_x_scale <- model.matrix(scale(broad_jump) ~ scale(three_cone) + scale(shuttle), vertical_three_cone_shuttle_2_broad_jump)
v3cs2bj_broad_jump_y_scale <- (vertical_three_cone_shuttle_2_broad_jump %>% mutate(broad_jump = scale(broad_jump)))$broad_jump

set.seed(2)
v3cs2bj_broad_jump_train <- sample(1:nrow(v3cs2bj_broad_jump_x_scale), .8*nrow(v3cs2bj_broad_jump_x_scale))
v3cs2bj_broad_jump_test <- (-v3cs2bj_broad_jump_train)
v3cs2bj_broad_jump_y.test_scale <- v3cs2bj_broad_jump_y_scale[v3cs2bj_broad_jump_test]

v3cs2bj_broad_jump_lasso.mod_scale <- glmnet(v3cs2bj_broad_jump_x_scale[v3cs2bj_broad_jump_train, ], v3cs2bj_broad_jump_y_scale[v3cs2bj_broad_jump_train], alpha = 1,
    lambda = grid,intercept = TRUE ,standardize = TRUE)

set.seed(1)
v3cs2bj_broad_jump_cv.out_scale <- cv.glmnet(v3cs2bj_broad_jump_x_scale[v3cs2bj_broad_jump_train, ], v3cs2bj_broad_jump_y_scale[v3cs2bj_broad_jump_train], alpha = 1)
#plot(v3cs2bj_broad_jump_cv.out)
v3cs2bj_broad_jump_bestlam_scale <- v3cs2bj_broad_jump_cv.out_scale$lambda.min
#v3cs2bj_broad_jump_bestlam <- 1
v3cs2bj_broad_jump_lasso.pred_scale <- predict(v3cs2bj_broad_jump_lasso.mod_scale, s = v3cs2bj_broad_jump_bestlam_scale,
    newx = v3cs2bj_broad_jump_x_scale[v3cs2bj_broad_jump_test, ])
mean((v3cs2bj_broad_jump_lasso.pred_scale - v3cs2bj_broad_jump_y.test_scale)^2)
```

# If player only has vertical, three cone and shuttle predict forty
```{r}
update16 <- update15 %>% mutate(forty = if_else(
                           is.na(forty) & !is.na(vertical) & is.na(broad_jump) & !is.na(three_cone) & !is.na(shuttle),
                           v3cs2f_forty_lasso.coef[v3cs2f_forty_lasso.coef != 0][1] +
                             v3cs2f_forty_lasso.coef[v3cs2f_forty_lasso.coef != 0][2] * vertical +
                             v3cs2f_forty_lasso.coef[v3cs2f_forty_lasso.coef != 0][3] * three_cone +
                             v3cs2f_forty_lasso.coef[v3cs2f_forty_lasso.coef != 0][4] * shuttle,
                           forty
                         )) 
```

# Use forty, vertical, broad jump and three cone to predict shuttle
```{r}
forty_vertical_broad_jump_three_cone_2_shuttle <- combineonly %>% select(forty, vertical, broad_jump, three_cone, shuttle) %>% 
  filter(!is.na(forty) & !is.na(vertical) & !is.na(broad_jump) & !is.na(three_cone) & !is.na(shuttle))


fvbj3c2s_shuttle_x <- model.matrix(shuttle ~ ., forty_vertical_broad_jump_three_cone_2_shuttle)
fvbj3c2s_shuttle_y <- forty_vertical_broad_jump_three_cone_2_shuttle$shuttle
fvbj3c2s_shuttle_x 
mean(fvbj3c2s_shuttle_y)

set.seed(2)
fvbj3c2s_shuttle_train <- sample(1:nrow(fvbj3c2s_shuttle_x), .8*nrow(fvbj3c2s_shuttle_x))
fvbj3c2s_shuttle_test <- (-fvbj3c2s_shuttle_train)
fvbj3c2s_shuttle_y.test <- fvbj3c2s_shuttle_y[fvbj3c2s_shuttle_test]

grid <- 10^seq(-5, 5, length = 100)

fvbj3c2s_shuttle_lasso.mod <- glmnet(fvbj3c2s_shuttle_x[fvbj3c2s_shuttle_train, ], fvbj3c2s_shuttle_y[fvbj3c2s_shuttle_train], alpha = 1,
    lambda = grid,intercept = TRUE ,standardize = TRUE)
plot(fvbj3c2s_shuttle_lasso.mod)

set.seed(1)
fvbj3c2s_shuttle_cv.out <- cv.glmnet(fvbj3c2s_shuttle_x[fvbj3c2s_shuttle_train, ], fvbj3c2s_shuttle_y[fvbj3c2s_shuttle_train], alpha = 1)
#plot(fvbj3c2s_shuttle_cv.out)
fvbj3c2s_shuttle_bestlam <- fvbj3c2s_shuttle_cv.out$lambda.min
#fvbj3c2s_shuttle_bestlam <- 1
fvbj3c2s_shuttle_lasso.pred <- predict(fvbj3c2s_shuttle_lasso.mod, s = fvbj3c2s_shuttle_bestlam,
    newx = fvbj3c2s_shuttle_x[fvbj3c2s_shuttle_test, ])
mean((fvbj3c2s_shuttle_lasso.pred - fvbj3c2s_shuttle_y.test)^2)

fvbj3c2s_shuttle_out <- glmnet(fvbj3c2s_shuttle_x, fvbj3c2s_shuttle_y, alpha = 1, lambda = fvbj3c2s_shuttle_bestlam )
coef(fvbj3c2s_shuttle_out)
fvbj3c2s_shuttle_lasso.coef <- predict(fvbj3c2s_shuttle_out, type = "coefficients",
    s = fvbj3c2s_shuttle_bestlam)[1:(ncol(forty_vertical_broad_jump_three_cone_2_shuttle)+1), ]
fvbj3c2s_shuttle_lasso.coef
fvbj3c2s_shuttle_lasso.coef[fvbj3c2s_shuttle_lasso.coef != 0]

ggplot(forty_vertical_broad_jump_three_cone_2_shuttle[-fvbj3c2s_shuttle_train,] %>% mutate(pred = fvbj3c2s_shuttle_lasso.pred),
       aes(x = pred, shuttle)) +
  geom_point()



fvbj3c2s_shuttle_x_scale <- model.matrix(scale(shuttle) ~ scale(broad_jump) + scale(three_cone), forty_vertical_broad_jump_three_cone_2_shuttle)
fvbj3c2s_shuttle_y_scale <- (forty_vertical_broad_jump_three_cone_2_shuttle %>% mutate(shuttle = scale(shuttle)))$shuttle

set.seed(2)
fvbj3c2s_shuttle_train <- sample(1:nrow(fvbj3c2s_shuttle_x_scale), .8*nrow(fvbj3c2s_shuttle_x_scale))
fvbj3c2s_shuttle_test <- (-fvbj3c2s_shuttle_train)
fvbj3c2s_shuttle_y.test_scale <- fvbj3c2s_shuttle_y_scale[fvbj3c2s_shuttle_test]

fvbj3c2s_shuttle_lasso.mod_scale <- glmnet(fvbj3c2s_shuttle_x_scale[fvbj3c2s_shuttle_train, ], fvbj3c2s_shuttle_y_scale[fvbj3c2s_shuttle_train], alpha = 1,
    lambda = grid,intercept = TRUE ,standardize = TRUE)

set.seed(1)
fvbj3c2s_shuttle_cv.out_scale <- cv.glmnet(fvbj3c2s_shuttle_x_scale[fvbj3c2s_shuttle_train, ], fvbj3c2s_shuttle_y_scale[fvbj3c2s_shuttle_train], alpha = 1)
#plot(fvbj3c2s_shuttle_cv.out)
fvbj3c2s_shuttle_bestlam_scale <- fvbj3c2s_shuttle_cv.out_scale$lambda.min
#fvbj3c2s_shuttle_bestlam <- 1
fvbj3c2s_shuttle_lasso.pred_scale <- predict(fvbj3c2s_shuttle_lasso.mod_scale, s = fvbj3c2s_shuttle_bestlam_scale,
    newx = fvbj3c2s_shuttle_x_scale[fvbj3c2s_shuttle_test, ])
mean((fvbj3c2s_shuttle_lasso.pred_scale - fvbj3c2s_shuttle_y.test_scale)^2)
```

# Use vertical, broad jump and three cone to predict shuttle
```{r}
update17 <- update16 %>% mutate(shuttle = if_else(
                           !is.na(forty) & !is.na(vertical) & !is.na(broad_jump) & !is.na(three_cone) & is.na(shuttle),
                           fvbj3c2s_shuttle_lasso.coef[fvbj3c2s_shuttle_lasso.coef != 0][1] +
                             fvbj3c2s_shuttle_lasso.coef[fvbj3c2s_shuttle_lasso.coef != 0][2] * forty +
                             fvbj3c2s_shuttle_lasso.coef[fvbj3c2s_shuttle_lasso.coef != 0][3] * vertical +
                             fvbj3c2s_shuttle_lasso.coef[fvbj3c2s_shuttle_lasso.coef != 0][4] * broad_jump +
                             fvbj3c2s_shuttle_lasso.coef[fvbj3c2s_shuttle_lasso.coef != 0][5] * three_cone,
                           shuttle
                         )) 
```

# Use forty, vertical, broad jump and three_cone to predict three cone
```{r}
forty_vertical_broad_jump_shuttle_2_three_cone <- combineonly %>% select(forty, vertical, broad_jump, shuttle, three_cone) %>% 
  filter(!is.na(forty) & !is.na(vertical) & !is.na(broad_jump) & !is.na(shuttle) & !is.na(three_cone))


fvbjs23c_three_cone_x <- model.matrix(three_cone ~ ., forty_vertical_broad_jump_shuttle_2_three_cone)
fvbjs23c_three_cone_y <- forty_vertical_broad_jump_shuttle_2_three_cone$three_cone
fvbjs23c_three_cone_x 
mean(fvbjs23c_three_cone_y)

set.seed(2)
fvbjs23c_three_cone_train <- sample(1:nrow(fvbjs23c_three_cone_x), .8*nrow(fvbjs23c_three_cone_x))
fvbjs23c_three_cone_test <- (-fvbjs23c_three_cone_train)
fvbjs23c_three_cone_y.test <- fvbjs23c_three_cone_y[fvbjs23c_three_cone_test]

grid <- 10^seq(-5, 5, length = 100)

fvbjs23c_three_cone_lasso.mod <- glmnet(fvbjs23c_three_cone_x[fvbjs23c_three_cone_train, ], fvbjs23c_three_cone_y[fvbjs23c_three_cone_train], alpha = 1,
    lambda = grid,intercept = TRUE ,standardize = TRUE)
plot(fvbjs23c_three_cone_lasso.mod)

set.seed(1)
fvbjs23c_three_cone_cv.out <- cv.glmnet(fvbjs23c_three_cone_x[fvbjs23c_three_cone_train, ], fvbjs23c_three_cone_y[fvbjs23c_three_cone_train], alpha = 1)
#plot(fvbjs23c_three_cone_cv.out)
fvbjs23c_three_cone_bestlam <- fvbjs23c_three_cone_cv.out$lambda.min
#fvbjs23c_three_cone_bestlam <- 1
fvbjs23c_three_cone_lasso.pred <- predict(fvbjs23c_three_cone_lasso.mod, s = fvbjs23c_three_cone_bestlam,
    newx = fvbjs23c_three_cone_x[fvbjs23c_three_cone_test, ])
mean((fvbjs23c_three_cone_lasso.pred - fvbjs23c_three_cone_y.test)^2)

fvbjs23c_three_cone_out <- glmnet(fvbjs23c_three_cone_x, fvbjs23c_three_cone_y, alpha = 1, lambda = fvbjs23c_three_cone_bestlam )
coef(fvbjs23c_three_cone_out)
fvbjs23c_three_cone_lasso.coef <- predict(fvbjs23c_three_cone_out, type = "coefficients",
    s = fvbjs23c_three_cone_bestlam)[1:(ncol(forty_vertical_broad_jump_shuttle_2_three_cone)+1), ]
fvbjs23c_three_cone_lasso.coef
fvbjs23c_three_cone_lasso.coef[fvbjs23c_three_cone_lasso.coef != 0]

ggplot(forty_vertical_broad_jump_shuttle_2_three_cone[-fvbjs23c_three_cone_train,] %>% mutate(pred = fvbjs23c_three_cone_lasso.pred),
       aes(x = pred, three_cone)) +
  geom_point()



fvbjs23c_three_cone_x_scale <- model.matrix(scale(three_cone) ~ scale(broad_jump) + scale(shuttle), forty_vertical_broad_jump_shuttle_2_three_cone)
fvbjs23c_three_cone_y_scale <- (forty_vertical_broad_jump_shuttle_2_three_cone %>% mutate(three_cone = scale(three_cone)))$three_cone

set.seed(2)
fvbjs23c_three_cone_train <- sample(1:nrow(fvbjs23c_three_cone_x_scale), .8*nrow(fvbjs23c_three_cone_x_scale))
fvbjs23c_three_cone_test <- (-fvbjs23c_three_cone_train)
fvbjs23c_three_cone_y.test_scale <- fvbjs23c_three_cone_y_scale[fvbjs23c_three_cone_test]

fvbjs23c_three_cone_lasso.mod_scale <- glmnet(fvbjs23c_three_cone_x_scale[fvbjs23c_three_cone_train, ], fvbjs23c_three_cone_y_scale[fvbjs23c_three_cone_train], alpha = 1,
    lambda = grid,intercept = TRUE ,standardize = TRUE)

set.seed(1)
fvbjs23c_three_cone_cv.out_scale <- cv.glmnet(fvbjs23c_three_cone_x_scale[fvbjs23c_three_cone_train, ], fvbjs23c_three_cone_y_scale[fvbjs23c_three_cone_train], alpha = 1)
#plot(fvbjs23c_three_cone_cv.out)
fvbjs23c_three_cone_bestlam_scale <- fvbjs23c_three_cone_cv.out_scale$lambda.min
#fvbjs23c_three_cone_bestlam <- 1
fvbjs23c_three_cone_lasso.pred_scale <- predict(fvbjs23c_three_cone_lasso.mod_scale, s = fvbjs23c_three_cone_bestlam_scale,
    newx = fvbjs23c_three_cone_x_scale[fvbjs23c_three_cone_test, ])
mean((fvbjs23c_three_cone_lasso.pred_scale - fvbjs23c_three_cone_y.test_scale)^2)
```

# Use vertical, broad jump and three cone to predict three_cone
```{r}
update18 <- update17 %>% mutate(three_cone = if_else(
                           !is.na(forty) & !is.na(vertical) & !is.na(broad_jump) & !is.na(shuttle) & is.na(three_cone),
                           fvbjs23c_three_cone_lasso.coef[fvbjs23c_three_cone_lasso.coef != 0][1] +
                             fvbjs23c_three_cone_lasso.coef[fvbjs23c_three_cone_lasso.coef != 0][2] * forty +
                             fvbjs23c_three_cone_lasso.coef[fvbjs23c_three_cone_lasso.coef != 0][3] * vertical +
                             fvbjs23c_three_cone_lasso.coef[fvbjs23c_three_cone_lasso.coef != 0][4] * broad_jump +
                             fvbjs23c_three_cone_lasso.coef[fvbjs23c_three_cone_lasso.coef != 0][5] * shuttle,
                           three_cone
                         )) 
```

# Use forty, vertical, three_cone and shuttle to predict broad jump
```{r}
forty_vertical_three_cone_shuttle_2_broad_jump <- combineonly %>% select(forty, vertical, three_cone, shuttle, broad_jump) %>% 
  filter(!is.na(forty) & !is.na(vertical) & !is.na(three_cone) & !is.na(shuttle) & !is.na(broad_jump))


f2v3cs2bj_broad_jump_x <- model.matrix(broad_jump ~ ., forty_vertical_three_cone_shuttle_2_broad_jump)
f2v3cs2bj_broad_jump_y <- forty_vertical_three_cone_shuttle_2_broad_jump$broad_jump
f2v3cs2bj_broad_jump_x 
mean(f2v3cs2bj_broad_jump_y)

set.seed(2)
f2v3cs2bj_broad_jump_train <- sample(1:nrow(f2v3cs2bj_broad_jump_x), .8*nrow(f2v3cs2bj_broad_jump_x))
f2v3cs2bj_broad_jump_test <- (-f2v3cs2bj_broad_jump_train)
f2v3cs2bj_broad_jump_y.test <- f2v3cs2bj_broad_jump_y[f2v3cs2bj_broad_jump_test]

grid <- 10^seq(-5, 5, length = 100)

f2v3cs2bj_broad_jump_lasso.mod <- glmnet(f2v3cs2bj_broad_jump_x[f2v3cs2bj_broad_jump_train, ], f2v3cs2bj_broad_jump_y[f2v3cs2bj_broad_jump_train], alpha = 1,
    lambda = grid,intercept = TRUE ,standardize = TRUE)
plot(f2v3cs2bj_broad_jump_lasso.mod)

set.seed(1)
f2v3cs2bj_broad_jump_cv.out <- cv.glmnet(f2v3cs2bj_broad_jump_x[f2v3cs2bj_broad_jump_train, ], f2v3cs2bj_broad_jump_y[f2v3cs2bj_broad_jump_train], alpha = 1)
#plot(f2v3cs2bj_broad_jump_cv.out)
f2v3cs2bj_broad_jump_bestlam <- f2v3cs2bj_broad_jump_cv.out$lambda.min
#f2v3cs2bj_broad_jump_bestlam <- 1
f2v3cs2bj_broad_jump_lasso.pred <- predict(f2v3cs2bj_broad_jump_lasso.mod, s = f2v3cs2bj_broad_jump_bestlam,
    newx = f2v3cs2bj_broad_jump_x[f2v3cs2bj_broad_jump_test, ])
mean((f2v3cs2bj_broad_jump_lasso.pred - f2v3cs2bj_broad_jump_y.test)^2)

f2v3cs2bj_broad_jump_out <- glmnet(f2v3cs2bj_broad_jump_x, f2v3cs2bj_broad_jump_y, alpha = 1, lambda = f2v3cs2bj_broad_jump_bestlam )
coef(f2v3cs2bj_broad_jump_out)
f2v3cs2bj_broad_jump_lasso.coef <- predict(f2v3cs2bj_broad_jump_out, type = "coefficients",
    s = f2v3cs2bj_broad_jump_bestlam)[1:(ncol(forty_vertical_three_cone_shuttle_2_broad_jump)+1), ]
f2v3cs2bj_broad_jump_lasso.coef
f2v3cs2bj_broad_jump_lasso.coef[f2v3cs2bj_broad_jump_lasso.coef != 0]

ggplot(forty_vertical_three_cone_shuttle_2_broad_jump[-f2v3cs2bj_broad_jump_train,] %>% mutate(pred = f2v3cs2bj_broad_jump_lasso.pred),
       aes(x = pred, broad_jump)) +
  geom_point()



f2v3cs2bj_broad_jump_x_scale <- model.matrix(scale(broad_jump) ~ scale(three_cone) + scale(shuttle), forty_vertical_three_cone_shuttle_2_broad_jump)
f2v3cs2bj_broad_jump_y_scale <- (forty_vertical_three_cone_shuttle_2_broad_jump %>% mutate(broad_jump = scale(broad_jump)))$broad_jump

set.seed(2)
f2v3cs2bj_broad_jump_train <- sample(1:nrow(f2v3cs2bj_broad_jump_x_scale), .8*nrow(f2v3cs2bj_broad_jump_x_scale))
f2v3cs2bj_broad_jump_test <- (-f2v3cs2bj_broad_jump_train)
f2v3cs2bj_broad_jump_y.test_scale <- f2v3cs2bj_broad_jump_y_scale[f2v3cs2bj_broad_jump_test]

f2v3cs2bj_broad_jump_lasso.mod_scale <- glmnet(f2v3cs2bj_broad_jump_x_scale[f2v3cs2bj_broad_jump_train, ], f2v3cs2bj_broad_jump_y_scale[f2v3cs2bj_broad_jump_train], alpha = 1,
    lambda = grid,intercept = TRUE ,standardize = TRUE)

set.seed(1)
f2v3cs2bj_broad_jump_cv.out_scale <- cv.glmnet(f2v3cs2bj_broad_jump_x_scale[f2v3cs2bj_broad_jump_train, ], f2v3cs2bj_broad_jump_y_scale[f2v3cs2bj_broad_jump_train], alpha = 1)
#plot(f2v3cs2bj_broad_jump_cv.out)
f2v3cs2bj_broad_jump_bestlam_scale <- f2v3cs2bj_broad_jump_cv.out_scale$lambda.min
#f2v3cs2bj_broad_jump_bestlam <- 1
f2v3cs2bj_broad_jump_lasso.pred_scale <- predict(f2v3cs2bj_broad_jump_lasso.mod_scale, s = f2v3cs2bj_broad_jump_bestlam_scale,
    newx = f2v3cs2bj_broad_jump_x_scale[f2v3cs2bj_broad_jump_test, ])
mean((f2v3cs2bj_broad_jump_lasso.pred_scale - f2v3cs2bj_broad_jump_y.test_scale)^2)
```

# Use forty, vertical, three cone and shuttle to predict broad jump
```{r}
update19 <- update18 %>% mutate(broad_jump = if_else(
                           !is.na(forty) & !is.na(vertical) & !is.na(three_cone) & !is.na(shuttle) & is.na(broad_jump),
                           f2v3cs2bj_broad_jump_lasso.coef[f2v3cs2bj_broad_jump_lasso.coef != 0][1] +
                             f2v3cs2bj_broad_jump_lasso.coef[f2v3cs2bj_broad_jump_lasso.coef != 0][2] * forty +
                             f2v3cs2bj_broad_jump_lasso.coef[f2v3cs2bj_broad_jump_lasso.coef != 0][3] * vertical +
                             f2v3cs2bj_broad_jump_lasso.coef[f2v3cs2bj_broad_jump_lasso.coef != 0][4] * three_cone +
                             f2v3cs2bj_broad_jump_lasso.coef[f2v3cs2bj_broad_jump_lasso.coef != 0][5] * shuttle,
                           broad_jump
                         )) 
```


# Use forty, broad jump, three_cone and shuttle to predict vertical
```{r}
forty_broad_jump_three_cone_shuttle_2_vertical <- combineonly %>% select(forty, broad_jump, three_cone, shuttle, vertical) %>% 
  filter(!is.na(forty) & !is.na(broad_jump) & !is.na(three_cone) & !is.na(shuttle) & !is.na(vertical))


fbj3cs2v_vertical_x <- model.matrix(vertical ~ ., forty_broad_jump_three_cone_shuttle_2_vertical)
fbj3cs2v_vertical_y <- forty_broad_jump_three_cone_shuttle_2_vertical$vertical
fbj3cs2v_vertical_x 
mean(fbj3cs2v_vertical_y)

set.seed(2)
fbj3cs2v_vertical_train <- sample(1:nrow(fbj3cs2v_vertical_x), .8*nrow(fbj3cs2v_vertical_x))
fbj3cs2v_vertical_test <- (-fbj3cs2v_vertical_train)
fbj3cs2v_vertical_y.test <- fbj3cs2v_vertical_y[fbj3cs2v_vertical_test]

grid <- 10^seq(-5, 5, length = 100)

fbj3cs2v_vertical_lasso.mod <- glmnet(fbj3cs2v_vertical_x[fbj3cs2v_vertical_train, ], fbj3cs2v_vertical_y[fbj3cs2v_vertical_train], alpha = 1,
    lambda = grid,intercept = TRUE ,standardize = TRUE)
plot(fbj3cs2v_vertical_lasso.mod)

set.seed(1)
fbj3cs2v_vertical_cv.out <- cv.glmnet(fbj3cs2v_vertical_x[fbj3cs2v_vertical_train, ], fbj3cs2v_vertical_y[fbj3cs2v_vertical_train], alpha = 1)
#plot(fbj3cs2v_vertical_cv.out)
fbj3cs2v_vertical_bestlam <- fbj3cs2v_vertical_cv.out$lambda.min
#fbj3cs2v_vertical_bestlam <- 1
fbj3cs2v_vertical_lasso.pred <- predict(fbj3cs2v_vertical_lasso.mod, s = fbj3cs2v_vertical_bestlam,
    newx = fbj3cs2v_vertical_x[fbj3cs2v_vertical_test, ])
mean((fbj3cs2v_vertical_lasso.pred - fbj3cs2v_vertical_y.test)^2)

fbj3cs2v_vertical_out <- glmnet(fbj3cs2v_vertical_x, fbj3cs2v_vertical_y, alpha = 1, lambda = fbj3cs2v_vertical_bestlam )
coef(fbj3cs2v_vertical_out)
fbj3cs2v_vertical_lasso.coef <- predict(fbj3cs2v_vertical_out, type = "coefficients",
    s = fbj3cs2v_vertical_bestlam)[1:(ncol(forty_broad_jump_three_cone_shuttle_2_vertical)+1), ]
fbj3cs2v_vertical_lasso.coef
fbj3cs2v_vertical_lasso.coef[fbj3cs2v_vertical_lasso.coef != 0]

ggplot(forty_broad_jump_three_cone_shuttle_2_vertical[-fbj3cs2v_vertical_train,] %>% mutate(pred = fbj3cs2v_vertical_lasso.pred),
       aes(x = pred, vertical)) +
  geom_point()



fbj3cs2v_vertical_x_scale <- model.matrix(scale(vertical) ~ scale(three_cone) + scale(shuttle), forty_broad_jump_three_cone_shuttle_2_vertical)
fbj3cs2v_vertical_y_scale <- (forty_broad_jump_three_cone_shuttle_2_vertical %>% mutate(vertical = scale(vertical)))$vertical

set.seed(2)
fbj3cs2v_vertical_train <- sample(1:nrow(fbj3cs2v_vertical_x_scale), .8*nrow(fbj3cs2v_vertical_x_scale))
fbj3cs2v_vertical_test <- (-fbj3cs2v_vertical_train)
fbj3cs2v_vertical_y.test_scale <- fbj3cs2v_vertical_y_scale[fbj3cs2v_vertical_test]

fbj3cs2v_vertical_lasso.mod_scale <- glmnet(fbj3cs2v_vertical_x_scale[fbj3cs2v_vertical_train, ], fbj3cs2v_vertical_y_scale[fbj3cs2v_vertical_train], alpha = 1,
    lambda = grid,intercept = TRUE ,standardize = TRUE)

set.seed(1)
fbj3cs2v_vertical_cv.out_scale <- cv.glmnet(fbj3cs2v_vertical_x_scale[fbj3cs2v_vertical_train, ], fbj3cs2v_vertical_y_scale[fbj3cs2v_vertical_train], alpha = 1)
#plot(fbj3cs2v_vertical_cv.out)
fbj3cs2v_vertical_bestlam_scale <- fbj3cs2v_vertical_cv.out_scale$lambda.min
#fbj3cs2v_vertical_bestlam <- 1
fbj3cs2v_vertical_lasso.pred_scale <- predict(fbj3cs2v_vertical_lasso.mod_scale, s = fbj3cs2v_vertical_bestlam_scale,
    newx = fbj3cs2v_vertical_x_scale[fbj3cs2v_vertical_test, ])
mean((fbj3cs2v_vertical_lasso.pred_scale - fbj3cs2v_vertical_y.test_scale)^2)
```

# Use forty, broad jump, three cone and shuttle to predict vertical
```{r}
update20 <- update19 %>% mutate(vertical = if_else(
                           !is.na(forty) & is.na(vertical) & !is.na(three_cone) & !is.na(shuttle) & !is.na(broad_jump),
                           fbj3cs2v_vertical_lasso.coef[fbj3cs2v_vertical_lasso.coef != 0][1] +
                             fbj3cs2v_vertical_lasso.coef[fbj3cs2v_vertical_lasso.coef != 0][2] * forty +
                             fbj3cs2v_vertical_lasso.coef[fbj3cs2v_vertical_lasso.coef != 0][3] * broad_jump +
                             fbj3cs2v_vertical_lasso.coef[fbj3cs2v_vertical_lasso.coef != 0][4] * shuttle,
                           vertical
                         )) 
```

# Use vertical, broad jump, three_cone and shuttle to predict forty
```{r}
vertical_broad_jump_three_cone_shuttle_2_forty <- combineonly %>% select(vertical, broad_jump, three_cone, shuttle, forty) %>% 
  filter(!is.na(vertical) & !is.na(broad_jump) & !is.na(three_cone) & !is.na(shuttle) & !is.na(forty))


vbj3cs2f_forty_x <- model.matrix(forty ~ ., vertical_broad_jump_three_cone_shuttle_2_forty)
vbj3cs2f_forty_y <- vertical_broad_jump_three_cone_shuttle_2_forty$forty
vbj3cs2f_forty_x 
mean(vbj3cs2f_forty_y)

set.seed(2)
vbj3cs2f_forty_train <- sample(1:nrow(vbj3cs2f_forty_x), .8*nrow(vbj3cs2f_forty_x))
vbj3cs2f_forty_test <- (-vbj3cs2f_forty_train)
vbj3cs2f_forty_y.test <- vbj3cs2f_forty_y[vbj3cs2f_forty_test]

grid <- 10^seq(-5, 5, length = 100)

vbj3cs2f_forty_lasso.mod <- glmnet(vbj3cs2f_forty_x[vbj3cs2f_forty_train, ], vbj3cs2f_forty_y[vbj3cs2f_forty_train], alpha = 1,
    lambda = grid,intercept = TRUE ,standardize = TRUE)
plot(vbj3cs2f_forty_lasso.mod)

set.seed(1)
vbj3cs2f_forty_cv.out <- cv.glmnet(vbj3cs2f_forty_x[vbj3cs2f_forty_train, ], vbj3cs2f_forty_y[vbj3cs2f_forty_train], alpha = 1)
#plot(vbj3cs2f_forty_cv.out)
vbj3cs2f_forty_bestlam <- vbj3cs2f_forty_cv.out$lambda.min
#vbj3cs2f_forty_bestlam <- 1
vbj3cs2f_forty_lasso.pred <- predict(vbj3cs2f_forty_lasso.mod, s = vbj3cs2f_forty_bestlam,
    newx = vbj3cs2f_forty_x[vbj3cs2f_forty_test, ])
mean((vbj3cs2f_forty_lasso.pred - vbj3cs2f_forty_y.test)^2)

vbj3cs2f_forty_out <- glmnet(vbj3cs2f_forty_x, vbj3cs2f_forty_y, alpha = 1, lambda = vbj3cs2f_forty_bestlam )
coef(vbj3cs2f_forty_out)
vbj3cs2f_forty_lasso.coef <- predict(vbj3cs2f_forty_out, type = "coefficients",
    s = vbj3cs2f_forty_bestlam)[1:(ncol(vertical_broad_jump_three_cone_shuttle_2_forty)+1), ]
vbj3cs2f_forty_lasso.coef
vbj3cs2f_forty_lasso.coef[vbj3cs2f_forty_lasso.coef != 0]

ggplot(vertical_broad_jump_three_cone_shuttle_2_forty[-vbj3cs2f_forty_train,] %>% mutate(pred = vbj3cs2f_forty_lasso.pred),
       aes(x = pred, forty)) +
  geom_point()



vbj3cs2f_forty_x_scale <- model.matrix(scale(forty) ~ scale(three_cone) + scale(shuttle), vertical_broad_jump_three_cone_shuttle_2_forty)
vbj3cs2f_forty_y_scale <- (vertical_broad_jump_three_cone_shuttle_2_forty %>% mutate(forty = scale(forty)))$forty

set.seed(2)
vbj3cs2f_forty_train <- sample(1:nrow(vbj3cs2f_forty_x_scale), .8*nrow(vbj3cs2f_forty_x_scale))
vbj3cs2f_forty_test <- (-vbj3cs2f_forty_train)
vbj3cs2f_forty_y.test_scale <- vbj3cs2f_forty_y_scale[vbj3cs2f_forty_test]

vbj3cs2f_forty_lasso.mod_scale <- glmnet(vbj3cs2f_forty_x_scale[vbj3cs2f_forty_train, ], vbj3cs2f_forty_y_scale[vbj3cs2f_forty_train], alpha = 1,
    lambda = grid,intercept = TRUE ,standardize = TRUE)

set.seed(1)
vbj3cs2f_forty_cv.out_scale <- cv.glmnet(vbj3cs2f_forty_x_scale[vbj3cs2f_forty_train, ], vbj3cs2f_forty_y_scale[vbj3cs2f_forty_train], alpha = 1)
#plot(vbj3cs2f_forty_cv.out)
vbj3cs2f_forty_bestlam_scale <- vbj3cs2f_forty_cv.out_scale$lambda.min
#vbj3cs2f_forty_bestlam <- 1
vbj3cs2f_forty_lasso.pred_scale <- predict(vbj3cs2f_forty_lasso.mod_scale, s = vbj3cs2f_forty_bestlam_scale,
    newx = vbj3cs2f_forty_x_scale[vbj3cs2f_forty_test, ])
mean((vbj3cs2f_forty_lasso.pred_scale - vbj3cs2f_forty_y.test_scale)^2)
```

# Use vertical, broad jump, three cone and shuttle to predict forty
```{r}
combinepredicted <- update20 %>% mutate(forty = if_else(
                           is.na(forty) & !is.na(vertical) & !is.na(three_cone) & !is.na(shuttle) & !is.na(broad_jump),
                           vbj3cs2f_forty_lasso.coef[vbj3cs2f_forty_lasso.coef != 0][1] +
                             vbj3cs2f_forty_lasso.coef[vbj3cs2f_forty_lasso.coef != 0][2] * vertical +
                             vbj3cs2f_forty_lasso.coef[vbj3cs2f_forty_lasso.coef != 0][3] * broad_jump +
                             vbj3cs2f_forty_lasso.coef[vbj3cs2f_forty_lasso.coef != 0][4] * three_cone +
                             vbj3cs2f_forty_lasso.coef[vbj3cs2f_forty_lasso.coef != 0][5] * shuttle,
                           forty
                         )) 
```


```{r}
view(combinepredicted[rowSums(is.na(combinepredicted)) > 0, ])
```




__ALL STATS__

# Use forty to predict
```{r}
forty_2_vertical <- combinecollege %>% select(-player, -three_cone, -broad_jump, -shuttle) %>% filter(!is.na(forty) & ! is.na(vertical))


f2v_vertical_x <- model.matrix(vertical ~ ., forty_2_vertical)
f2v_vertical_y <- forty_2_vertical$vertical
f2v_vertical_x 
mean(f2v_vertical_y)

set.seed(2)
f2v_vertical_train <- sample(1:nrow(f2v_vertical_x), .8*nrow(f2v_vertical_x))
f2v_vertical_test <- (-f2v_vertical_train)
f2v_vertical_y.test <- f2v_vertical_y[f2v_vertical_test]

grid <- 10^seq(-5, 5, length = 100)

f2v_vertical_lasso.mod <- glmnet(f2v_vertical_x[f2v_vertical_train, ], f2v_vertical_y[f2v_vertical_train], alpha = 1,
    lambda = grid,intercept = TRUE ,standardize = TRUE)
plot(f2v_vertical_lasso.mod)

set.seed(1)
f2v_vertical_cv.out <- cv.glmnet(f2v_vertical_x[f2v_vertical_train, ], f2v_vertical_y[f2v_vertical_train], alpha = 1)
#plot(f2v_vertical_cv.out)
f2v_vertical_bestlam <- f2v_vertical_cv.out$lambda.min
#f2v_vertical_bestlam <- 1
f2v_vertical_lasso.pred <- predict(f2v_vertical_lasso.mod, s = f2v_vertical_bestlam,
    newx = f2v_vertical_x[f2v_vertical_test, ])
mean((f2v_vertical_lasso.pred - f2v_vertical_y.test)^2)

f2v_vertical_out <- glmnet(f2v_vertical_x, f2v_vertical_y, alpha = 1, lambda = f2v_vertical_bestlam )
coef(f2v_vertical_out)
f2v_vertical_lasso.coef <- predict(f2v_vertical_out, type = "coefficients",
    s = f2v_vertical_bestlam)[1:(ncol(forty_2_vertical)+1), ]
f2v_vertical_lasso.coef
f2v_vertical_lasso.coef[f2v_vertical_lasso.coef != 0]

ggplot(forty_2_vertical[-f2v_vertical_train,] %>% mutate(pred = f2v_vertical_lasso.pred),
       aes(x = pred, vertical)) +
  geom_point()



f2v_vertical_x_scale <- model.matrix(scale(vertical) ~ scale(forty), forty_2_vertical)
f2v_vertical_y_scale <- (forty_2_vertical %>% mutate(vertical = scale(vertical)))$vertical

set.seed(2)
f2v_vertical_train <- sample(1:nrow(f2v_vertical_x_scale), .8*nrow(f2v_vertical_x_scale))
f2v_vertical_test <- (-f2v_vertical_train)
f2v_vertical_y.test_scale <- f2v_vertical_y_scale[f2v_vertical_test]

f2v_vertical_lasso.mod_scale <- glmnet(f2v_vertical_x_scale[f2v_vertical_train, ], f2v_vertical_y_scale[f2v_vertical_train], alpha = 1,
    lambda = grid,intercept = TRUE ,standardize = TRUE)

set.seed(1)
f2v_vertical_cv.out_scale <- cv.glmnet(f2v_vertical_x_scale[f2v_vertical_train, ], f2v_vertical_y_scale[f2v_vertical_train], alpha = 1)
#plot(f2v_vertical_cv.out)
f2v_vertical_bestlam_scale <- f2v_vertical_cv.out_scale$lambda.min
#f2v_vertical_bestlam <- 1
f2v_vertical_lasso.pred_scale <- predict(f2v_vertical_lasso.mod_scale, s = f2v_vertical_bestlam_scale,
    newx = f2v_vertical_x_scale[f2v_vertical_test, ])
mean((f2v_vertical_lasso.pred_scale - f2v_vertical_y.test_scale)^2)
```

```{r}
forty_2_broad_jump <- combinecollege %>% select(-player, -vertical, -three_cone, -shuttle) %>% filter(!is.na(forty) & ! is.na(broad_jump))


f2bj_broad_jump_x <- model.matrix(broad_jump ~ ., forty_2_broad_jump)
f2bj_broad_jump_y <- forty_2_broad_jump$broad_jump
f2bj_broad_jump_x 
mean(f2bj_broad_jump_y)

set.seed(2)
f2bj_broad_jump_train <- sample(1:nrow(f2bj_broad_jump_x), .8*nrow(f2bj_broad_jump_x))
f2bj_broad_jump_test <- (-f2bj_broad_jump_train)
f2bj_broad_jump_y.test <- f2bj_broad_jump_y[f2bj_broad_jump_test]

grid <- 10^seq(-5, 5, length = 100)

f2bj_broad_jump_lasso.mod <- glmnet(f2bj_broad_jump_x[f2bj_broad_jump_train, ], f2bj_broad_jump_y[f2bj_broad_jump_train], alpha = 1,
    lambda = grid,intercept = TRUE ,standardize = TRUE)
plot(f2bj_broad_jump_lasso.mod)

set.seed(1)
f2bj_broad_jump_cv.out <- cv.glmnet(f2bj_broad_jump_x[f2bj_broad_jump_train, ], f2bj_broad_jump_y[f2bj_broad_jump_train], alpha = 1)
#plot(f2bj_broad_jump_cv.out)
f2bj_broad_jump_bestlam <- f2bj_broad_jump_cv.out$lambda.min
#f2bj_broad_jump_bestlam <- 1
f2bj_broad_jump_lasso.pred <- predict(f2bj_broad_jump_lasso.mod, s = f2bj_broad_jump_bestlam,
    newx = f2bj_broad_jump_x[f2bj_broad_jump_test, ])
mean((f2bj_broad_jump_lasso.pred - f2bj_broad_jump_y.test)^2)

f2bj_broad_jump_out <- glmnet(f2bj_broad_jump_x, f2bj_broad_jump_y, alpha = 1, lambda = f2bj_broad_jump_bestlam )
coef(f2bj_broad_jump_out)
f2bj_broad_jump_lasso.coef <- predict(f2bj_broad_jump_out, type = "coefficients",
    s = f2bj_broad_jump_bestlam)[1:(ncol(forty_2_broad_jump)+1), ]
f2bj_broad_jump_lasso.coef
f2bj_broad_jump_lasso.coef[f2bj_broad_jump_lasso.coef != 0]

ggplot(forty_2_broad_jump[-f2bj_broad_jump_train,] %>% mutate(pred = f2bj_broad_jump_lasso.pred),
       aes(x = pred, broad_jump)) +
  geom_point()



f2bj_broad_jump_x_scale <- model.matrix(scale(broad_jump) ~ scale(forty), forty_2_broad_jump)
f2bj_broad_jump_y_scale <- (forty_2_broad_jump %>% mutate(broad_jump = scale(broad_jump)))$broad_jump

set.seed(2)
f2bj_broad_jump_train <- sample(1:nrow(f2bj_broad_jump_x_scale), .8*nrow(f2bj_broad_jump_x_scale))
f2bj_broad_jump_test <- (-f2bj_broad_jump_train)
f2bj_broad_jump_y.test_scale <- f2bj_broad_jump_y_scale[f2bj_broad_jump_test]

f2bj_broad_jump_lasso.mod_scale <- glmnet(f2bj_broad_jump_x_scale[f2bj_broad_jump_train, ], f2bj_broad_jump_y_scale[f2bj_broad_jump_train], alpha = 1,
    lambda = grid,intercept = TRUE ,standardize = TRUE)

set.seed(1)
f2bj_broad_jump_cv.out_scale <- cv.glmnet(f2bj_broad_jump_x_scale[f2bj_broad_jump_train, ], f2bj_broad_jump_y_scale[f2bj_broad_jump_train], alpha = 1)
#plot(f2bj_broad_jump_cv.out)
f2bj_broad_jump_bestlam_scale <- f2bj_broad_jump_cv.out_scale$lambda.min
#f2bj_broad_jump_bestlam <- 1
f2bj_broad_jump_lasso.pred_scale <- predict(f2bj_broad_jump_lasso.mod_scale, s = f2bj_broad_jump_bestlam_scale,
    newx = f2bj_broad_jump_x_scale[f2bj_broad_jump_test, ])
mean((f2bj_broad_jump_lasso.pred_scale - f2bj_broad_jump_y.test_scale)^2)
```

```{r}
forty_2_three_cone <- combinecollege %>% select(-player, -vertical, -broad_jump, -shuttle) %>% filter(!is.na(forty) & ! is.na(three_cone))


f23c_three_cone_x <- model.matrix(three_cone ~ ., forty_2_three_cone)
f23c_three_cone_y <- forty_2_three_cone$three_cone
f23c_three_cone_x 
mean(f23c_three_cone_y)

set.seed(2)
f23c_three_cone_train <- sample(1:nrow(f23c_three_cone_x), .8*nrow(f23c_three_cone_x))
f23c_three_cone_test <- (-f23c_three_cone_train)
f23c_three_cone_y.test <- f23c_three_cone_y[f23c_three_cone_test]

grid <- 10^seq(-5, 5, length = 100)

f23c_three_cone_lasso.mod <- glmnet(f23c_three_cone_x[f23c_three_cone_train, ], f23c_three_cone_y[f23c_three_cone_train], alpha = 1,
    lambda = grid,intercept = TRUE ,standardize = TRUE)
plot(f23c_three_cone_lasso.mod)

set.seed(1)
f23c_three_cone_cv.out <- cv.glmnet(f23c_three_cone_x[f23c_three_cone_train, ], f23c_three_cone_y[f23c_three_cone_train], alpha = 1)
#plot(f23c_three_cone_cv.out)
f23c_three_cone_bestlam <- f23c_three_cone_cv.out$lambda.min
#f23c_three_cone_bestlam <- 1
f23c_three_cone_lasso.pred <- predict(f23c_three_cone_lasso.mod, s = f23c_three_cone_bestlam,
    newx = f23c_three_cone_x[f23c_three_cone_test, ])
mean((f23c_three_cone_lasso.pred - f23c_three_cone_y.test)^2)

f23c_three_cone_out <- glmnet(f23c_three_cone_x, f23c_three_cone_y, alpha = 1, lambda = f23c_three_cone_bestlam )
coef(f23c_three_cone_out)
f23c_three_cone_lasso.coef <- predict(f23c_three_cone_out, type = "coefficients",
    s = f23c_three_cone_bestlam)[1:(ncol(forty_2_three_cone)+1), ]
f23c_three_cone_lasso.coef
f23c_three_cone_lasso.coef[f23c_three_cone_lasso.coef != 0]

ggplot(forty_2_three_cone[-f23c_three_cone_train,] %>% mutate(pred = f23c_three_cone_lasso.pred),
       aes(x = pred, three_cone)) +
  geom_point()



f23c_three_cone_x_scale <- model.matrix(scale(three_cone) ~ scale(forty), forty_2_three_cone)
f23c_three_cone_y_scale <- (forty_2_three_cone %>% mutate(three_cone = scale(three_cone)))$three_cone

set.seed(2)
f23c_three_cone_train <- sample(1:nrow(f23c_three_cone_x_scale), .8*nrow(f23c_three_cone_x_scale))
f23c_three_cone_test <- (-f23c_three_cone_train)
f23c_three_cone_y.test_scale <- f23c_three_cone_y_scale[f23c_three_cone_test]

f23c_three_cone_lasso.mod_scale <- glmnet(f23c_three_cone_x_scale[f23c_three_cone_train, ], f23c_three_cone_y_scale[f23c_three_cone_train], alpha = 1,
    lambda = grid,intercept = TRUE ,standardize = TRUE)

set.seed(1)
f23c_three_cone_cv.out_scale <- cv.glmnet(f23c_three_cone_x_scale[f23c_three_cone_train, ], f23c_three_cone_y_scale[f23c_three_cone_train], alpha = 1)
#plot(f23c_three_cone_cv.out)
f23c_three_cone_bestlam_scale <- f23c_three_cone_cv.out_scale$lambda.min
#f23c_three_cone_bestlam <- 1
f23c_three_cone_lasso.pred_scale <- predict(f23c_three_cone_lasso.mod_scale, s = f23c_three_cone_bestlam_scale,
    newx = f23c_three_cone_x_scale[f23c_three_cone_test, ])
mean((f23c_three_cone_lasso.pred_scale - f23c_three_cone_y.test_scale)^2)
```

```{r}
forty_2_shuttle <- combinecollege %>% select(-player, -vertical, -three_cone, -broad_jump) %>% filter(!is.na(forty) & ! is.na(shuttle))


f2s_shuttle_x <- model.matrix(shuttle ~ ., forty_2_shuttle)
f2s_shuttle_y <- forty_2_shuttle$shuttle
f2s_shuttle_x 
mean(f2s_shuttle_y)

set.seed(2)
f2s_shuttle_train <- sample(1:nrow(f2s_shuttle_x), .8*nrow(f2s_shuttle_x))
f2s_shuttle_test <- (-f2s_shuttle_train)
f2s_shuttle_y.test <- f2s_shuttle_y[f2s_shuttle_test]

grid <- 10^seq(-5, 5, length = 100)

f2s_shuttle_lasso.mod <- glmnet(f2s_shuttle_x[f2s_shuttle_train, ], f2s_shuttle_y[f2s_shuttle_train], alpha = 1,
    lambda = grid,intercept = TRUE ,standardize = TRUE)
plot(f2s_shuttle_lasso.mod)

set.seed(1)
f2s_shuttle_cv.out <- cv.glmnet(f2s_shuttle_x[f2s_shuttle_train, ], f2s_shuttle_y[f2s_shuttle_train], alpha = 1)
#plot(f2s_shuttle_cv.out)
f2s_shuttle_bestlam <- f2s_shuttle_cv.out$lambda.min
#f2s_shuttle_bestlam <- 1
f2s_shuttle_lasso.pred <- predict(f2s_shuttle_lasso.mod, s = f2s_shuttle_bestlam,
    newx = f2s_shuttle_x[f2s_shuttle_test, ])
mean((f2s_shuttle_lasso.pred - f2s_shuttle_y.test)^2)

f2s_shuttle_out <- glmnet(f2s_shuttle_x, f2s_shuttle_y, alpha = 1, lambda = f2s_shuttle_bestlam )
coef(f2s_shuttle_out)
f2s_shuttle_lasso.coef <- predict(f2s_shuttle_out, type = "coefficients",
    s = f2s_shuttle_bestlam)[1:(ncol(forty_2_shuttle)+1), ]
f2s_shuttle_lasso.coef
f2s_shuttle_lasso.coef[f2s_shuttle_lasso.coef != 0]

ggplot(forty_2_shuttle[-f2s_shuttle_train,] %>% mutate(pred = f2s_shuttle_lasso.pred),
       aes(x = pred, shuttle)) +
  geom_point()



f2s_shuttle_x_scale <- model.matrix(scale(shuttle) ~ scale(forty), forty_2_shuttle)
f2s_shuttle_y_scale <- (forty_2_shuttle %>% mutate(shuttle = scale(shuttle)))$shuttle

set.seed(2)
f2s_shuttle_train <- sample(1:nrow(f2s_shuttle_x_scale), .8*nrow(f2s_shuttle_x_scale))
f2s_shuttle_test <- (-f2s_shuttle_train)
f2s_shuttle_y.test_scale <- f2s_shuttle_y_scale[f2s_shuttle_test]

f2s_shuttle_lasso.mod_scale <- glmnet(f2s_shuttle_x_scale[f2s_shuttle_train, ], f2s_shuttle_y_scale[f2s_shuttle_train], alpha = 1,
    lambda = grid,intercept = TRUE ,standardize = TRUE)

set.seed(1)
f2s_shuttle_cv.out_scale <- cv.glmnet(f2s_shuttle_x_scale[f2s_shuttle_train, ], f2s_shuttle_y_scale[f2s_shuttle_train], alpha = 1)
#plot(f2s_shuttle_cv.out)
f2s_shuttle_bestlam_scale <- f2s_shuttle_cv.out_scale$lambda.min
#f2s_shuttle_bestlam <- 1
f2s_shuttle_lasso.pred_scale <- predict(f2s_shuttle_lasso.mod_scale, s = f2s_shuttle_bestlam_scale,
    newx = f2s_shuttle_x_scale[f2s_shuttle_test, ])
mean((f2s_shuttle_lasso.pred_scale - f2s_shuttle_y.test_scale)^2)
```

# If player only has forty predict vertical
```{r}
update1 <- combinecollege %>% mutate(vertical = if_else(
                           !is.na(forty) & is.na(vertical) & is.na(broad_jump) & is.na(three_cone) & is.na(shuttle),
                           f2v_vertical_lasso.coef[f2v_vertical_lasso.coef != 0][1] +
                             f2v_vertical_lasso.coef[f2v_vertical_lasso.coef != 0][2] * weight +
                             f2v_vertical_lasso.coef[f2v_vertical_lasso.coef != 0][3] * forty +
                             f2v_vertical_lasso.coef[f2v_vertical_lasso.coef != 0][4] * RecAvg +
                             f2v_vertical_lasso.coef[f2v_vertical_lasso.coef != 0][5] * RecTD +
                             f2v_vertical_lasso.coef[f2v_vertical_lasso.coef != 0][6] * TotTD,
                           vertical
                         )) 
```

# Use three cone to predict
```{r}
three_cone_2_forty <- combinecollege %>% select(-player, -vertical, -broad_jump, -shuttle) %>% filter(!is.na(three_cone) & ! is.na(forty))


tc2f_forty_x <- model.matrix(forty ~ ., three_cone_2_forty)
tc2f_forty_y <- three_cone_2_forty$forty
tc2f_forty_x 
mean(tc2f_forty_y)

set.seed(2)
tc2f_forty_train <- sample(1:nrow(tc2f_forty_x), .8*nrow(tc2f_forty_x))
tc2f_forty_test <- (-tc2f_forty_train)
tc2f_forty_y.test <- tc2f_forty_y[tc2f_forty_test]

grid <- 10^seq(-5, 5, length = 100)

tc2f_forty_lasso.mod <- glmnet(tc2f_forty_x[tc2f_forty_train, ], tc2f_forty_y[tc2f_forty_train], alpha = 1,
    lambda = grid,intercept = TRUE ,standardize = TRUE)
plot(tc2f_forty_lasso.mod)

set.seed(1)
tc2f_forty_cv.out <- cv.glmnet(tc2f_forty_x[tc2f_forty_train, ], tc2f_forty_y[tc2f_forty_train], alpha = 1)
#plot(tc2f_forty_cv.out)
tc2f_forty_bestlam <- tc2f_forty_cv.out$lambda.min
#tc2f_forty_bestlam <- 1
tc2f_forty_lasso.pred <- predict(tc2f_forty_lasso.mod, s = tc2f_forty_bestlam,
    newx = tc2f_forty_x[tc2f_forty_test, ])
mean((tc2f_forty_lasso.pred - tc2f_forty_y.test)^2)

tc2f_forty_out <- glmnet(tc2f_forty_x, tc2f_forty_y, alpha = 1, lambda = tc2f_forty_bestlam )
coef(tc2f_forty_out)
tc2f_forty_lasso.coef <- predict(tc2f_forty_out, type = "coefficients",
    s = tc2f_forty_bestlam)[1:(ncol(three_cone_2_forty)+1), ]
tc2f_forty_lasso.coef
tc2f_forty_lasso.coef[tc2f_forty_lasso.coef != 0]

ggplot(three_cone_2_forty[-tc2f_forty_train,] %>% mutate(pred = tc2f_forty_lasso.pred),
       aes(x = pred, forty)) +
  geom_point()



tc2f_forty_x_scale <- model.matrix(scale(forty) ~ scale(three_cone), three_cone_2_forty)
tc2f_forty_y_scale <- (three_cone_2_forty %>% mutate(forty = scale(forty)))$forty

set.seed(2)
tc2f_forty_train <- sample(1:nrow(tc2f_forty_x_scale), .8*nrow(tc2f_forty_x_scale))
tc2f_forty_test <- (-tc2f_forty_train)
tc2f_forty_y.test_scale <- tc2f_forty_y_scale[tc2f_forty_test]

tc2f_forty_lasso.mod_scale <- glmnet(tc2f_forty_x_scale[tc2f_forty_train, ], tc2f_forty_y_scale[tc2f_forty_train], alpha = 1,
    lambda = grid,intercept = TRUE ,standardize = TRUE)

set.seed(1)
tc2f_forty_cv.out_scale <- cv.glmnet(tc2f_forty_x_scale[tc2f_forty_train, ], tc2f_forty_y_scale[tc2f_forty_train], alpha = 1)
#plot(tc2f_forty_cv.out)
tc2f_forty_bestlam_scale <- tc2f_forty_cv.out_scale$lambda.min
#tc2f_forty_bestlam <- 1
tc2f_forty_lasso.pred_scale <- predict(tc2f_forty_lasso.mod_scale, s = tc2f_forty_bestlam_scale,
    newx = tc2f_forty_x_scale[tc2f_forty_test, ])
mean((tc2f_forty_lasso.pred_scale - tc2f_forty_y.test_scale)^2)
```

```{r}
three_cone_2_vertical <- combinecollege %>% select(-player, -forty, -broad_jump, -shuttle) %>% filter(!is.na(three_cone) & ! is.na(vertical))


tc2v_vertical_x <- model.matrix(vertical ~ ., three_cone_2_vertical)
tc2v_vertical_y <- three_cone_2_vertical$vertical
tc2v_vertical_x 
mean(tc2v_vertical_y)

set.seed(2)
tc2v_vertical_train <- sample(1:nrow(tc2v_vertical_x), .8*nrow(tc2v_vertical_x))
tc2v_vertical_test <- (-tc2v_vertical_train)
tc2v_vertical_y.test <- tc2v_vertical_y[tc2v_vertical_test]

grid <- 10^seq(-5, 5, length = 100)

tc2v_vertical_lasso.mod <- glmnet(tc2v_vertical_x[tc2v_vertical_train, ], tc2v_vertical_y[tc2v_vertical_train], alpha = 1,
    lambda = grid,intercept = TRUE ,standardize = TRUE)
plot(tc2v_vertical_lasso.mod)

set.seed(1)
tc2v_vertical_cv.out <- cv.glmnet(tc2v_vertical_x[tc2v_vertical_train, ], tc2v_vertical_y[tc2v_vertical_train], alpha = 1)
#plot(tc2v_vertical_cv.out)
tc2v_vertical_bestlam <- tc2v_vertical_cv.out$lambda.min
#tc2v_vertical_bestlam <- 1
tc2v_vertical_lasso.pred <- predict(tc2v_vertical_lasso.mod, s = tc2v_vertical_bestlam,
    newx = tc2v_vertical_x[tc2v_vertical_test, ])
mean((tc2v_vertical_lasso.pred - tc2v_vertical_y.test)^2)

tc2v_vertical_out <- glmnet(tc2v_vertical_x, tc2v_vertical_y, alpha = 1, lambda = tc2v_vertical_bestlam )
coef(tc2v_vertical_out)
tc2v_vertical_lasso.coef <- predict(tc2v_vertical_out, type = "coefficients",
    s = tc2v_vertical_bestlam)[1:(ncol(three_cone_2_vertical)+1), ]
tc2v_vertical_lasso.coef
tc2v_vertical_lasso.coef[tc2v_vertical_lasso.coef != 0]

ggplot(three_cone_2_vertical[-tc2v_vertical_train,] %>% mutate(pred = tc2v_vertical_lasso.pred),
       aes(x = pred, vertical)) +
  geom_point()



tc2v_vertical_x_scale <- model.matrix(scale(vertical) ~ scale(three_cone), three_cone_2_vertical)
tc2v_vertical_y_scale <- (three_cone_2_vertical %>% mutate(vertical = scale(vertical)))$vertical

set.seed(2)
tc2v_vertical_train <- sample(1:nrow(tc2v_vertical_x_scale), .8*nrow(tc2v_vertical_x_scale))
tc2v_vertical_test <- (-tc2v_vertical_train)
tc2v_vertical_y.test_scale <- tc2v_vertical_y_scale[tc2v_vertical_test]

tc2v_vertical_lasso.mod_scale <- glmnet(tc2v_vertical_x_scale[tc2v_vertical_train, ], tc2v_vertical_y_scale[tc2v_vertical_train], alpha = 1,
    lambda = grid,intercept = TRUE ,standardize = TRUE)

set.seed(1)
tc2v_vertical_cv.out_scale <- cv.glmnet(tc2v_vertical_x_scale[tc2v_vertical_train, ], tc2v_vertical_y_scale[tc2v_vertical_train], alpha = 1)
#plot(tc2v_vertical_cv.out)
tc2v_vertical_bestlam_scale <- tc2v_vertical_cv.out_scale$lambda.min
#tc2v_vertical_bestlam <- 1
tc2v_vertical_lasso.pred_scale <- predict(tc2v_vertical_lasso.mod_scale, s = tc2v_vertical_bestlam_scale,
    newx = tc2v_vertical_x_scale[tc2v_vertical_test, ])
mean((tc2v_vertical_lasso.pred_scale - tc2v_vertical_y.test_scale)^2)
```

```{r}
three_cone_2_broad_jump <- combinecollege %>% select(-player, -vertical, -forty, -shuttle) %>% filter(!is.na(three_cone) & ! is.na(broad_jump))


tc2bj_broad_jump_x <- model.matrix(broad_jump ~ ., three_cone_2_broad_jump)
tc2bj_broad_jump_y <- three_cone_2_broad_jump$broad_jump
tc2bj_broad_jump_x 
mean(tc2bj_broad_jump_y)

set.seed(2)
tc2bj_broad_jump_train <- sample(1:nrow(tc2bj_broad_jump_x), .8*nrow(tc2bj_broad_jump_x))
tc2bj_broad_jump_test <- (-tc2bj_broad_jump_train)
tc2bj_broad_jump_y.test <- tc2bj_broad_jump_y[tc2bj_broad_jump_test]

grid <- 10^seq(-5, 5, length = 100)

tc2bj_broad_jump_lasso.mod <- glmnet(tc2bj_broad_jump_x[tc2bj_broad_jump_train, ], tc2bj_broad_jump_y[tc2bj_broad_jump_train], alpha = 1,
    lambda = grid,intercept = TRUE ,standardize = TRUE)
plot(tc2bj_broad_jump_lasso.mod)

set.seed(1)
tc2bj_broad_jump_cv.out <- cv.glmnet(tc2bj_broad_jump_x[tc2bj_broad_jump_train, ], tc2bj_broad_jump_y[tc2bj_broad_jump_train], alpha = 1)
#plot(tc2bj_broad_jump_cv.out)
tc2bj_broad_jump_bestlam <- tc2bj_broad_jump_cv.out$lambda.min
#tc2bj_broad_jump_bestlam <- 1
tc2bj_broad_jump_lasso.pred <- predict(tc2bj_broad_jump_lasso.mod, s = tc2bj_broad_jump_bestlam,
    newx = tc2bj_broad_jump_x[tc2bj_broad_jump_test, ])
mean((tc2bj_broad_jump_lasso.pred - tc2bj_broad_jump_y.test)^2)

tc2bj_broad_jump_out <- glmnet(tc2bj_broad_jump_x, tc2bj_broad_jump_y, alpha = 1, lambda = tc2bj_broad_jump_bestlam )
coef(tc2bj_broad_jump_out)
tc2bj_broad_jump_lasso.coef <- predict(tc2bj_broad_jump_out, type = "coefficients",
    s = tc2bj_broad_jump_bestlam)[1:(ncol(three_cone_2_broad_jump)+1), ]
tc2bj_broad_jump_lasso.coef
tc2bj_broad_jump_lasso.coef[tc2bj_broad_jump_lasso.coef != 0]

ggplot(three_cone_2_broad_jump[-tc2bj_broad_jump_train,] %>% mutate(pred = tc2bj_broad_jump_lasso.pred),
       aes(x = pred, broad_jump)) +
  geom_point()



tc2bj_broad_jump_x_scale <- model.matrix(scale(broad_jump) ~ scale(three_cone), three_cone_2_broad_jump)
tc2bj_broad_jump_y_scale <- (three_cone_2_broad_jump %>% mutate(broad_jump = scale(broad_jump)))$broad_jump

set.seed(2)
tc2bj_broad_jump_train <- sample(1:nrow(tc2bj_broad_jump_x_scale), .8*nrow(tc2bj_broad_jump_x_scale))
tc2bj_broad_jump_test <- (-tc2bj_broad_jump_train)
tc2bj_broad_jump_y.test_scale <- tc2bj_broad_jump_y_scale[tc2bj_broad_jump_test]

tc2bj_broad_jump_lasso.mod_scale <- glmnet(tc2bj_broad_jump_x_scale[tc2bj_broad_jump_train, ], tc2bj_broad_jump_y_scale[tc2bj_broad_jump_train], alpha = 1,
    lambda = grid,intercept = TRUE ,standardize = TRUE)

set.seed(1)
tc2bj_broad_jump_cv.out_scale <- cv.glmnet(tc2bj_broad_jump_x_scale[tc2bj_broad_jump_train, ], tc2bj_broad_jump_y_scale[tc2bj_broad_jump_train], alpha = 1)
#plot(tc2bj_broad_jump_cv.out)
tc2bj_broad_jump_bestlam_scale <- tc2bj_broad_jump_cv.out_scale$lambda.min
#tc2bj_broad_jump_bestlam <- 1
tc2bj_broad_jump_lasso.pred_scale <- predict(tc2bj_broad_jump_lasso.mod_scale, s = tc2bj_broad_jump_bestlam_scale,
    newx = tc2bj_broad_jump_x_scale[tc2bj_broad_jump_test, ])
mean((tc2bj_broad_jump_lasso.pred_scale - tc2bj_broad_jump_y.test_scale)^2)
```


```{r}
three_cone_2_shuttle <- combinecollege %>% select(-player, -vertical, -broad_jump, -forty) %>% filter(!is.na(three_cone) & ! is.na(shuttle))


tc2s_shuttle_x <- model.matrix(shuttle ~ ., three_cone_2_shuttle)
tc2s_shuttle_y <- three_cone_2_shuttle$shuttle
tc2s_shuttle_x 
mean(tc2s_shuttle_y)

set.seed(2)
tc2s_shuttle_train <- sample(1:nrow(tc2s_shuttle_x), .8*nrow(tc2s_shuttle_x))
tc2s_shuttle_test <- (-tc2s_shuttle_train)
tc2s_shuttle_y.test <- tc2s_shuttle_y[tc2s_shuttle_test]

grid <- 10^seq(-5, 5, length = 100)

tc2s_shuttle_lasso.mod <- glmnet(tc2s_shuttle_x[tc2s_shuttle_train, ], tc2s_shuttle_y[tc2s_shuttle_train], alpha = 1,
    lambda = grid,intercept = TRUE ,standardize = TRUE)
plot(tc2s_shuttle_lasso.mod)

set.seed(1)
tc2s_shuttle_cv.out <- cv.glmnet(tc2s_shuttle_x[tc2s_shuttle_train, ], tc2s_shuttle_y[tc2s_shuttle_train], alpha = 1)
#plot(tc2s_shuttle_cv.out)
tc2s_shuttle_bestlam <- tc2s_shuttle_cv.out$lambda.min
#tc2s_shuttle_bestlam <- 1
tc2s_shuttle_lasso.pred <- predict(tc2s_shuttle_lasso.mod, s = tc2s_shuttle_bestlam,
    newx = tc2s_shuttle_x[tc2s_shuttle_test, ])
mean((tc2s_shuttle_lasso.pred - tc2s_shuttle_y.test)^2)

tc2s_shuttle_out <- glmnet(tc2s_shuttle_x, tc2s_shuttle_y, alpha = 1, lambda = tc2s_shuttle_bestlam )
coef(tc2s_shuttle_out)
tc2s_shuttle_lasso.coef <- predict(tc2s_shuttle_out, type = "coefficients",
    s = tc2s_shuttle_bestlam)[1:(ncol(three_cone_2_shuttle)+1), ]
tc2s_shuttle_lasso.coef
tc2s_shuttle_lasso.coef[tc2s_shuttle_lasso.coef != 0]

ggplot(three_cone_2_shuttle[-tc2s_shuttle_train,] %>% mutate(pred = tc2s_shuttle_lasso.pred),
       aes(x = pred, shuttle)) +
  geom_point()



tc2s_shuttle_x_scale <- model.matrix(scale(shuttle) ~ scale(three_cone), three_cone_2_shuttle)
tc2s_shuttle_y_scale <- (three_cone_2_shuttle %>% mutate(shuttle = scale(shuttle)))$shuttle

set.seed(2)
tc2s_shuttle_train <- sample(1:nrow(tc2s_shuttle_x_scale), .8*nrow(tc2s_shuttle_x_scale))
tc2s_shuttle_test <- (-tc2s_shuttle_train)
tc2s_shuttle_y.test_scale <- tc2s_shuttle_y_scale[tc2s_shuttle_test]

tc2s_shuttle_lasso.mod_scale <- glmnet(tc2s_shuttle_x_scale[tc2s_shuttle_train, ], tc2s_shuttle_y_scale[tc2s_shuttle_train], alpha = 1,
    lambda = grid,intercept = TRUE ,standardize = TRUE)

set.seed(1)
tc2s_shuttle_cv.out_scale <- cv.glmnet(tc2s_shuttle_x_scale[tc2s_shuttle_train, ], tc2s_shuttle_y_scale[tc2s_shuttle_train], alpha = 1)
#plot(tc2s_shuttle_cv.out)
tc2s_shuttle_bestlam_scale <- tc2s_shuttle_cv.out_scale$lambda.min
#tc2s_shuttle_bestlam <- 1
tc2s_shuttle_lasso.pred_scale <- predict(tc2s_shuttle_lasso.mod_scale, s = tc2s_shuttle_bestlam_scale,
    newx = tc2s_shuttle_x_scale[tc2s_shuttle_test, ])
mean((tc2s_shuttle_lasso.pred_scale - tc2s_shuttle_y.test_scale)^2)
```

# If player only has three cone predict shuttle
```{r}
update2 <- update1 %>% mutate(shuttle = if_else(
                           is.na(forty) & is.na(vertical) & is.na(broad_jump) & !is.na(three_cone) & is.na(shuttle),
                           tc2s_shuttle_lasso.coef[tc2s_shuttle_lasso.coef != 0][1] +
                             tc2s_shuttle_lasso.coef[tc2s_shuttle_lasso.coef != 0][2] * three_cone +
                             tc2s_shuttle_lasso.coef[tc2s_shuttle_lasso.coef != 0][3] * TotTD,
                           shuttle
                         )) 
```

# Use forty and vertical to predict
```{r}
forty_vertical_2_broad_jump <- combinecollege %>% select(-player, -three_cone, -shuttle) %>% 
  filter(!is.na(forty) & !is.na(vertical) & !is.na(broad_jump))


fv2bj_broad_jump_x <- model.matrix(broad_jump ~ ., forty_vertical_2_broad_jump)
fv2bj_broad_jump_y <- forty_vertical_2_broad_jump$broad_jump
fv2bj_broad_jump_x 
mean(fv2bj_broad_jump_y)

set.seed(2)
fv2bj_broad_jump_train <- sample(1:nrow(fv2bj_broad_jump_x), .8*nrow(fv2bj_broad_jump_x))
fv2bj_broad_jump_test <- (-fv2bj_broad_jump_train)
fv2bj_broad_jump_y.test <- fv2bj_broad_jump_y[fv2bj_broad_jump_test]

grid <- 10^seq(-5, 5, length = 100)

fv2bj_broad_jump_lasso.mod <- glmnet(fv2bj_broad_jump_x[fv2bj_broad_jump_train, ], fv2bj_broad_jump_y[fv2bj_broad_jump_train], alpha = 1,
    lambda = grid,intercept = TRUE ,standardize = TRUE)
plot(fv2bj_broad_jump_lasso.mod)

set.seed(1)
fv2bj_broad_jump_cv.out <- cv.glmnet(fv2bj_broad_jump_x[fv2bj_broad_jump_train, ], fv2bj_broad_jump_y[fv2bj_broad_jump_train], alpha = 1)
#plot(fv2bj_broad_jump_cv.out)
fv2bj_broad_jump_bestlam <- fv2bj_broad_jump_cv.out$lambda.min
#fv2bj_broad_jump_bestlam <- 1
fv2bj_broad_jump_lasso.pred <- predict(fv2bj_broad_jump_lasso.mod, s = fv2bj_broad_jump_bestlam,
    newx = fv2bj_broad_jump_x[fv2bj_broad_jump_test, ])
mean((fv2bj_broad_jump_lasso.pred - fv2bj_broad_jump_y.test)^2)

fv2bj_broad_jump_out <- glmnet(fv2bj_broad_jump_x, fv2bj_broad_jump_y, alpha = 1, lambda = fv2bj_broad_jump_bestlam )
coef(fv2bj_broad_jump_out)
fv2bj_broad_jump_lasso.coef <- predict(fv2bj_broad_jump_out, type = "coefficients",
    s = fv2bj_broad_jump_bestlam)[1:(ncol(forty_2_broad_jump)+2), ]
fv2bj_broad_jump_lasso.coef
fv2bj_broad_jump_lasso.coef[fv2bj_broad_jump_lasso.coef != 0]

ggplot(forty_vertical_2_broad_jump[-fv2bj_broad_jump_train,] %>% mutate(pred = fv2bj_broad_jump_lasso.pred),
       aes(x = pred, broad_jump)) +
  geom_point()



fv2bj_broad_jump_x_scale <- model.matrix(scale(broad_jump) ~ scale(forty) + scale(vertical), forty_vertical_2_broad_jump)
fv2bj_broad_jump_y_scale <- (forty_vertical_2_broad_jump %>% mutate(broad_jump = scale(broad_jump)))$broad_jump

set.seed(2)
fv2bj_broad_jump_train <- sample(1:nrow(fv2bj_broad_jump_x_scale), .8*nrow(fv2bj_broad_jump_x_scale))
fv2bj_broad_jump_test <- (-fv2bj_broad_jump_train)
fv2bj_broad_jump_y.test_scale <- fv2bj_broad_jump_y_scale[fv2bj_broad_jump_test]

fv2bj_broad_jump_lasso.mod_scale <- glmnet(fv2bj_broad_jump_x_scale[fv2bj_broad_jump_train, ], fv2bj_broad_jump_y_scale[fv2bj_broad_jump_train], alpha = 1,
    lambda = grid,intercept = TRUE ,standardize = TRUE)

set.seed(1)
fv2bj_broad_jump_cv.out_scale <- cv.glmnet(fv2bj_broad_jump_x_scale[fv2bj_broad_jump_train, ], fv2bj_broad_jump_y_scale[fv2bj_broad_jump_train], alpha = 1)
#plot(fv2bj_broad_jump_cv.out)
fv2bj_broad_jump_bestlam_scale <- fv2bj_broad_jump_cv.out_scale$lambda.min
#fv2bj_broad_jump_bestlam <- 1
fv2bj_broad_jump_lasso.pred_scale <- predict(fv2bj_broad_jump_lasso.mod_scale, s = fv2bj_broad_jump_bestlam_scale,
    newx = fv2bj_broad_jump_x_scale[fv2bj_broad_jump_test, ])
mean((fv2bj_broad_jump_lasso.pred_scale - fv2bj_broad_jump_y.test_scale)^2)
```

```{r}
forty_vertical_2_three_cone <- combinecollege %>% select(-player, -broad_jump, -shuttle) %>% 
  filter(!is.na(forty) & !is.na(vertical) & !is.na(three_cone))


fv23c_three_cone_x <- model.matrix(three_cone ~ ., forty_vertical_2_three_cone)
fv23c_three_cone_y <- forty_vertical_2_three_cone$three_cone
fv23c_three_cone_x 
mean(fv23c_three_cone_y)

set.seed(2)
fv23c_three_cone_train <- sample(1:nrow(fv23c_three_cone_x), .8*nrow(fv23c_three_cone_x))
fv23c_three_cone_test <- (-fv23c_three_cone_train)
fv23c_three_cone_y.test <- fv23c_three_cone_y[fv23c_three_cone_test]

grid <- 10^seq(-5, 5, length = 100)

fv23c_three_cone_lasso.mod <- glmnet(fv23c_three_cone_x[fv23c_three_cone_train, ], fv23c_three_cone_y[fv23c_three_cone_train], alpha = 1,
    lambda = grid,intercept = TRUE ,standardize = TRUE)
plot(fv23c_three_cone_lasso.mod)

set.seed(1)
fv23c_three_cone_cv.out <- cv.glmnet(fv23c_three_cone_x[fv23c_three_cone_train, ], fv23c_three_cone_y[fv23c_three_cone_train], alpha = 1)
#plot(fv23c_three_cone_cv.out)
fv23c_three_cone_bestlam <- fv23c_three_cone_cv.out$lambda.min
#fv23c_three_cone_bestlam <- 1
fv23c_three_cone_lasso.pred <- predict(fv23c_three_cone_lasso.mod, s = fv23c_three_cone_bestlam,
    newx = fv23c_three_cone_x[fv23c_three_cone_test, ])
mean((fv23c_three_cone_lasso.pred - fv23c_three_cone_y.test)^2)

fv23c_three_cone_out <- glmnet(fv23c_three_cone_x, fv23c_three_cone_y, alpha = 1, lambda = fv23c_three_cone_bestlam )
coef(fv23c_three_cone_out)
fv23c_three_cone_lasso.coef <- predict(fv23c_three_cone_out, type = "coefficients",
    s = fv23c_three_cone_bestlam)[1:(ncol(forty_2_three_cone)+2), ]
fv23c_three_cone_lasso.coef
fv23c_three_cone_lasso.coef[fv23c_three_cone_lasso.coef != 0]

ggplot(forty_vertical_2_three_cone[-fv23c_three_cone_train,] %>% mutate(pred = fv23c_three_cone_lasso.pred),
       aes(x = pred, three_cone)) +
  geom_point()



fv23c_three_cone_x_scale <- model.matrix(scale(three_cone) ~ scale(forty) + scale(vertical), forty_vertical_2_three_cone)
fv23c_three_cone_y_scale <- (forty_vertical_2_three_cone %>% mutate(three_cone = scale(three_cone)))$three_cone

set.seed(2)
fv23c_three_cone_train <- sample(1:nrow(fv23c_three_cone_x_scale), .8*nrow(fv23c_three_cone_x_scale))
fv23c_three_cone_test <- (-fv23c_three_cone_train)
fv23c_three_cone_y.test_scale <- fv23c_three_cone_y_scale[fv23c_three_cone_test]

fv23c_three_cone_lasso.mod_scale <- glmnet(fv23c_three_cone_x_scale[fv23c_three_cone_train, ], fv23c_three_cone_y_scale[fv23c_three_cone_train], alpha = 1,
    lambda = grid,intercept = TRUE ,standardize = TRUE)

set.seed(1)
fv23c_three_cone_cv.out_scale <- cv.glmnet(fv23c_three_cone_x_scale[fv23c_three_cone_train, ], fv23c_three_cone_y_scale[fv23c_three_cone_train], alpha = 1)
#plot(fv23c_three_cone_cv.out)
fv23c_three_cone_bestlam_scale <- fv23c_three_cone_cv.out_scale$lambda.min
#fv23c_three_cone_bestlam <- 1
fv23c_three_cone_lasso.pred_scale <- predict(fv23c_three_cone_lasso.mod_scale, s = fv23c_three_cone_bestlam_scale,
    newx = fv23c_three_cone_x_scale[fv23c_three_cone_test, ])
mean((fv23c_three_cone_lasso.pred_scale - fv23c_three_cone_y.test_scale)^2)
```

```{r}
forty_vertical_2_shuttle <- combinecollege %>% select(-player, -three_cone, -broad_jump) %>% 
  filter(!is.na(forty) & !is.na(vertical) & !is.na(shuttle))


fv2s_shuttle_x <- model.matrix(shuttle ~ ., forty_vertical_2_shuttle)
fv2s_shuttle_y <- forty_vertical_2_shuttle$shuttle
fv2s_shuttle_x 
mean(fv2s_shuttle_y)

set.seed(2)
fv2s_shuttle_train <- sample(1:nrow(fv2s_shuttle_x), .8*nrow(fv2s_shuttle_x))
fv2s_shuttle_test <- (-fv2s_shuttle_train)
fv2s_shuttle_y.test <- fv2s_shuttle_y[fv2s_shuttle_test]

grid <- 10^seq(-5, 5, length = 100)

fv2s_shuttle_lasso.mod <- glmnet(fv2s_shuttle_x[fv2s_shuttle_train, ], fv2s_shuttle_y[fv2s_shuttle_train], alpha = 1,
    lambda = grid,intercept = TRUE ,standardize = TRUE)
plot(fv2s_shuttle_lasso.mod)

set.seed(1)
fv2s_shuttle_cv.out <- cv.glmnet(fv2s_shuttle_x[fv2s_shuttle_train, ], fv2s_shuttle_y[fv2s_shuttle_train], alpha = 1)
#plot(fv2s_shuttle_cv.out)
fv2s_shuttle_bestlam <- fv2s_shuttle_cv.out$lambda.min
#fv2s_shuttle_bestlam <- 1
fv2s_shuttle_lasso.pred <- predict(fv2s_shuttle_lasso.mod, s = fv2s_shuttle_bestlam,
    newx = fv2s_shuttle_x[fv2s_shuttle_test, ])
mean((fv2s_shuttle_lasso.pred - fv2s_shuttle_y.test)^2)

fv2s_shuttle_out <- glmnet(fv2s_shuttle_x, fv2s_shuttle_y, alpha = 1, lambda = fv2s_shuttle_bestlam )
coef(fv2s_shuttle_out)
fv2s_shuttle_lasso.coef <- predict(fv2s_shuttle_out, type = "coefficients",
    s = fv2s_shuttle_bestlam)[1:(ncol(forty_2_shuttle)+2), ]
fv2s_shuttle_lasso.coef
fv2s_shuttle_lasso.coef[fv2s_shuttle_lasso.coef != 0]

ggplot(forty_vertical_2_shuttle[-fv2s_shuttle_train,] %>% mutate(pred = fv2s_shuttle_lasso.pred),
       aes(x = pred, shuttle)) +
  geom_point()



fv2s_shuttle_x_scale <- model.matrix(scale(shuttle) ~ scale(forty) + scale(vertical), forty_vertical_2_shuttle)
fv2s_shuttle_y_scale <- (forty_vertical_2_shuttle %>% mutate(shuttle = scale(shuttle)))$shuttle

set.seed(2)
fv2s_shuttle_train <- sample(1:nrow(fv2s_shuttle_x_scale), .8*nrow(fv2s_shuttle_x_scale))
fv2s_shuttle_test <- (-fv2s_shuttle_train)
fv2s_shuttle_y.test_scale <- fv2s_shuttle_y_scale[fv2s_shuttle_test]

fv2s_shuttle_lasso.mod_scale <- glmnet(fv2s_shuttle_x_scale[fv2s_shuttle_train, ], fv2s_shuttle_y_scale[fv2s_shuttle_train], alpha = 1,
    lambda = grid,intercept = TRUE ,standardize = TRUE)

set.seed(1)
fv2s_shuttle_cv.out_scale <- cv.glmnet(fv2s_shuttle_x_scale[fv2s_shuttle_train, ], fv2s_shuttle_y_scale[fv2s_shuttle_train], alpha = 1)
#plot(fv2s_shuttle_cv.out)
fv2s_shuttle_bestlam_scale <- fv2s_shuttle_cv.out_scale$lambda.min
#fv2s_shuttle_bestlam <- 1
fv2s_shuttle_lasso.pred_scale <- predict(fv2s_shuttle_lasso.mod_scale, s = fv2s_shuttle_bestlam_scale,
    newx = fv2s_shuttle_x_scale[fv2s_shuttle_test, ])
mean((fv2s_shuttle_lasso.pred_scale - fv2s_shuttle_y.test_scale)^2)
```

# If player only has forty and vertical predict three cone
```{r}
update3 <- update2 %>% mutate(three_cone = if_else(
                           !is.na(forty) & !is.na(vertical) & is.na(broad_jump) & is.na(three_cone) & is.na(shuttle),
                           fv23c_three_cone_lasso.coef[fv23c_three_cone_lasso.coef != 0][1] +
                             fv23c_three_cone_lasso.coef[fv23c_three_cone_lasso.coef != 0][2] * weight +
                             fv23c_three_cone_lasso.coef[fv23c_three_cone_lasso.coef != 0][3] * forty +
                             fv23c_three_cone_lasso.coef[fv23c_three_cone_lasso.coef != 0][4] * vertical +
                             fv23c_three_cone_lasso.coef[fv23c_three_cone_lasso.coef != 0][5] * G +
                             fv23c_three_cone_lasso.coef[fv23c_three_cone_lasso.coef != 0][6] * Rec +
                             fv23c_three_cone_lasso.coef[fv23c_three_cone_lasso.coef != 0][7] * RecTD +
                             fv23c_three_cone_lasso.coef[fv23c_three_cone_lasso.coef != 0][8] * RushAtt +
                             fv23c_three_cone_lasso.coef[fv23c_three_cone_lasso.coef != 0][9] * RushYds,
                           three_cone
                         )) 
```

# Use forty and broad jump to predict
```{r}
forty_broad_jump_2_vertical <- combinecollege %>% select(-player, -three_cone, -shuttle) %>% 
  filter(!is.na(forty) & !is.na(broad_jump) & !is.na(vertical))


fbj2v_vertical_x <- model.matrix(vertical ~ ., forty_broad_jump_2_vertical)
fbj2v_vertical_y <- forty_broad_jump_2_vertical$vertical
fbj2v_vertical_x 
mean(fbj2v_vertical_y)

set.seed(2)
fbj2v_vertical_train <- sample(1:nrow(fbj2v_vertical_x), .8*nrow(fbj2v_vertical_x))
fbj2v_vertical_test <- (-fbj2v_vertical_train)
fbj2v_vertical_y.test <- fbj2v_vertical_y[fbj2v_vertical_test]

grid <- 10^seq(-5, 5, length = 100)

fbj2v_vertical_lasso.mod <- glmnet(fbj2v_vertical_x[fbj2v_vertical_train, ], fbj2v_vertical_y[fbj2v_vertical_train], alpha = 1,
    lambda = grid,intercept = TRUE ,standardize = TRUE)
plot(fbj2v_vertical_lasso.mod)

set.seed(1)
fbj2v_vertical_cv.out <- cv.glmnet(fbj2v_vertical_x[fbj2v_vertical_train, ], fbj2v_vertical_y[fbj2v_vertical_train], alpha = 1)
#plot(fbj2v_vertical_cv.out)
fbj2v_vertical_bestlam <- fbj2v_vertical_cv.out$lambda.min
#fbj2v_vertical_bestlam <- 1
fbj2v_vertical_lasso.pred <- predict(fbj2v_vertical_lasso.mod, s = fbj2v_vertical_bestlam,
    newx = fbj2v_vertical_x[fbj2v_vertical_test, ])
mean((fbj2v_vertical_lasso.pred - fbj2v_vertical_y.test)^2)

fbj2v_vertical_out <- glmnet(fbj2v_vertical_x, fbj2v_vertical_y, alpha = 1, lambda = fbj2v_vertical_bestlam )
coef(fbj2v_vertical_out)
fbj2v_vertical_lasso.coef <- predict(fbj2v_vertical_out, type = "coefficients",
    s = fbj2v_vertical_bestlam)[1:(ncol(forty_2_vertical)+2), ]
fbj2v_vertical_lasso.coef
fbj2v_vertical_lasso.coef[fbj2v_vertical_lasso.coef != 0]

ggplot(forty_broad_jump_2_vertical[-fbj2v_vertical_train,] %>% mutate(pred = fbj2v_vertical_lasso.pred),
       aes(x = pred, vertical)) +
  geom_point()



fbj2v_vertical_x_scale <- model.matrix(scale(vertical) ~ scale(forty) + scale(broad_jump), forty_broad_jump_2_vertical)
fbj2v_vertical_y_scale <- (forty_broad_jump_2_vertical %>% mutate(vertical = scale(vertical)))$vertical

set.seed(2)
fbj2v_vertical_train <- sample(1:nrow(fbj2v_vertical_x_scale), .8*nrow(fbj2v_vertical_x_scale))
fbj2v_vertical_test <- (-fbj2v_vertical_train)
fbj2v_vertical_y.test_scale <- fbj2v_vertical_y_scale[fbj2v_vertical_test]

fbj2v_vertical_lasso.mod_scale <- glmnet(fbj2v_vertical_x_scale[fbj2v_vertical_train, ], fbj2v_vertical_y_scale[fbj2v_vertical_train], alpha = 1,
    lambda = grid,intercept = TRUE ,standardize = TRUE)

set.seed(1)
fbj2v_vertical_cv.out_scale <- cv.glmnet(fbj2v_vertical_x_scale[fbj2v_vertical_train, ], fbj2v_vertical_y_scale[fbj2v_vertical_train], alpha = 1)
#plot(fbj2v_vertical_cv.out)
fbj2v_vertical_bestlam_scale <- fbj2v_vertical_cv.out_scale$lambda.min
#fbj2v_vertical_bestlam <- 1
fbj2v_vertical_lasso.pred_scale <- predict(fbj2v_vertical_lasso.mod_scale, s = fbj2v_vertical_bestlam_scale,
    newx = fbj2v_vertical_x_scale[fbj2v_vertical_test, ])
mean((fbj2v_vertical_lasso.pred_scale - fbj2v_vertical_y.test_scale)^2)
```

```{r}
forty_broad_jump_2_three_cone <- combinecollege %>% select(-player, -vertical, -shuttle) %>% 
  filter(!is.na(forty) & !is.na(broad_jump) & !is.na(three_cone))


fbj23c_three_cone_x <- model.matrix(three_cone ~ ., forty_broad_jump_2_three_cone)
fbj23c_three_cone_y <- forty_broad_jump_2_three_cone$three_cone
fbj23c_three_cone_x 
mean(fbj23c_three_cone_y)

set.seed(2)
fbj23c_three_cone_train <- sample(1:nrow(fbj23c_three_cone_x), .8*nrow(fbj23c_three_cone_x))
fbj23c_three_cone_test <- (-fbj23c_three_cone_train)
fbj23c_three_cone_y.test <- fbj23c_three_cone_y[fbj23c_three_cone_test]

grid <- 10^seq(-5, 5, length = 100)

fbj23c_three_cone_lasso.mod <- glmnet(fbj23c_three_cone_x[fbj23c_three_cone_train, ], fbj23c_three_cone_y[fbj23c_three_cone_train], alpha = 1,
    lambda = grid,intercept = TRUE ,standardize = TRUE)
plot(fbj23c_three_cone_lasso.mod)

set.seed(1)
fbj23c_three_cone_cv.out <- cv.glmnet(fbj23c_three_cone_x[fbj23c_three_cone_train, ], fbj23c_three_cone_y[fbj23c_three_cone_train], alpha = 1)
#plot(fbj23c_three_cone_cv.out)
fbj23c_three_cone_bestlam <- fbj23c_three_cone_cv.out$lambda.min
#fbj23c_three_cone_bestlam <- 1
fbj23c_three_cone_lasso.pred <- predict(fbj23c_three_cone_lasso.mod, s = fbj23c_three_cone_bestlam,
    newx = fbj23c_three_cone_x[fbj23c_three_cone_test, ])
mean((fbj23c_three_cone_lasso.pred - fbj23c_three_cone_y.test)^2)

fbj23c_three_cone_out <- glmnet(fbj23c_three_cone_x, fbj23c_three_cone_y, alpha = 1, lambda = fbj23c_three_cone_bestlam )
coef(fbj23c_three_cone_out)
fbj23c_three_cone_lasso.coef <- predict(fbj23c_three_cone_out, type = "coefficients",
    s = fbj23c_three_cone_bestlam)[1:(ncol(forty_2_three_cone)+2), ]
fbj23c_three_cone_lasso.coef
fbj23c_three_cone_lasso.coef[fbj23c_three_cone_lasso.coef != 0]

ggplot(forty_broad_jump_2_three_cone[-fbj23c_three_cone_train,] %>% mutate(pred = fbj23c_three_cone_lasso.pred),
       aes(x = pred, three_cone)) +
  geom_point()



fbj23c_three_cone_x_scale <- model.matrix(scale(three_cone) ~ scale(forty) + scale(broad_jump), forty_broad_jump_2_three_cone)
fbj23c_three_cone_y_scale <- (forty_broad_jump_2_three_cone %>% mutate(three_cone = scale(three_cone)))$three_cone

set.seed(2)
fbj23c_three_cone_train <- sample(1:nrow(fbj23c_three_cone_x_scale), .8*nrow(fbj23c_three_cone_x_scale))
fbj23c_three_cone_test <- (-fbj23c_three_cone_train)
fbj23c_three_cone_y.test_scale <- fbj23c_three_cone_y_scale[fbj23c_three_cone_test]

fbj23c_three_cone_lasso.mod_scale <- glmnet(fbj23c_three_cone_x_scale[fbj23c_three_cone_train, ], fbj23c_three_cone_y_scale[fbj23c_three_cone_train], alpha = 1,
    lambda = grid,intercept = TRUE ,standardize = TRUE)

set.seed(1)
fbj23c_three_cone_cv.out_scale <- cv.glmnet(fbj23c_three_cone_x_scale[fbj23c_three_cone_train, ], fbj23c_three_cone_y_scale[fbj23c_three_cone_train], alpha = 1)
#plot(fbj23c_three_cone_cv.out)
fbj23c_three_cone_bestlam_scale <- fbj23c_three_cone_cv.out_scale$lambda.min
#fbj23c_three_cone_bestlam <- 1
fbj23c_three_cone_lasso.pred_scale <- predict(fbj23c_three_cone_lasso.mod_scale, s = fbj23c_three_cone_bestlam_scale,
    newx = fbj23c_three_cone_x_scale[fbj23c_three_cone_test, ])
mean((fbj23c_three_cone_lasso.pred_scale - fbj23c_three_cone_y.test_scale)^2)
```

```{r}
forty_broad_jump_2_shuttle <- combinecollege %>% select(-player, -three_cone, -vertical) %>% 
  filter(!is.na(forty) & !is.na(broad_jump) & !is.na(shuttle))


fbj2s_shuttle_x <- model.matrix(shuttle ~ ., forty_broad_jump_2_shuttle)
fbj2s_shuttle_y <- forty_broad_jump_2_shuttle$shuttle
fbj2s_shuttle_x 
mean(fbj2s_shuttle_y)

set.seed(2)
fbj2s_shuttle_train <- sample(1:nrow(fbj2s_shuttle_x), .8*nrow(fbj2s_shuttle_x))
fbj2s_shuttle_test <- (-fbj2s_shuttle_train)
fbj2s_shuttle_y.test <- fbj2s_shuttle_y[fbj2s_shuttle_test]

grid <- 10^seq(-5, 5, length = 100)

fbj2s_shuttle_lasso.mod <- glmnet(fbj2s_shuttle_x[fbj2s_shuttle_train, ], fbj2s_shuttle_y[fbj2s_shuttle_train], alpha = 1,
    lambda = grid,intercept = TRUE ,standardize = TRUE)
plot(fbj2s_shuttle_lasso.mod)

set.seed(1)
fbj2s_shuttle_cv.out <- cv.glmnet(fbj2s_shuttle_x[fbj2s_shuttle_train, ], fbj2s_shuttle_y[fbj2s_shuttle_train], alpha = 1)
#plot(fbj2s_shuttle_cv.out)
fbj2s_shuttle_bestlam <- fbj2s_shuttle_cv.out$lambda.min
#fbj2s_shuttle_bestlam <- 1
fbj2s_shuttle_lasso.pred <- predict(fbj2s_shuttle_lasso.mod, s = fbj2s_shuttle_bestlam,
    newx = fbj2s_shuttle_x[fbj2s_shuttle_test, ])
mean((fbj2s_shuttle_lasso.pred - fbj2s_shuttle_y.test)^2)

fbj2s_shuttle_out <- glmnet(fbj2s_shuttle_x, fbj2s_shuttle_y, alpha = 1, lambda = fbj2s_shuttle_bestlam )
coef(fbj2s_shuttle_out)
fbj2s_shuttle_lasso.coef <- predict(fbj2s_shuttle_out, type = "coefficients",
    s = fbj2s_shuttle_bestlam)[1:(ncol(forty_2_shuttle)+2), ]
fbj2s_shuttle_lasso.coef
fbj2s_shuttle_lasso.coef[fbj2s_shuttle_lasso.coef != 0]

ggplot(forty_broad_jump_2_shuttle[-fbj2s_shuttle_train,] %>% mutate(pred = fbj2s_shuttle_lasso.pred),
       aes(x = pred, shuttle)) +
  geom_point()



fbj2s_shuttle_x_scale <- model.matrix(scale(shuttle) ~ scale(forty) + scale(broad_jump), forty_broad_jump_2_shuttle)
fbj2s_shuttle_y_scale <- (forty_broad_jump_2_shuttle %>% mutate(shuttle = scale(shuttle)))$shuttle

set.seed(2)
fbj2s_shuttle_train <- sample(1:nrow(fbj2s_shuttle_x_scale), .8*nrow(fbj2s_shuttle_x_scale))
fbj2s_shuttle_test <- (-fbj2s_shuttle_train)
fbj2s_shuttle_y.test_scale <- fbj2s_shuttle_y_scale[fbj2s_shuttle_test]

fbj2s_shuttle_lasso.mod_scale <- glmnet(fbj2s_shuttle_x_scale[fbj2s_shuttle_train, ], fbj2s_shuttle_y_scale[fbj2s_shuttle_train], alpha = 1,
    lambda = grid,intercept = TRUE ,standardize = TRUE)

set.seed(1)
fbj2s_shuttle_cv.out_scale <- cv.glmnet(fbj2s_shuttle_x_scale[fbj2s_shuttle_train, ], fbj2s_shuttle_y_scale[fbj2s_shuttle_train], alpha = 1)
#plot(fbj2s_shuttle_cv.out)
fbj2s_shuttle_bestlam_scale <- fbj2s_shuttle_cv.out_scale$lambda.min
#fbj2s_shuttle_bestlam <- 1
fbj2s_shuttle_lasso.pred_scale <- predict(fbj2s_shuttle_lasso.mod_scale, s = fbj2s_shuttle_bestlam_scale,
    newx = fbj2s_shuttle_x_scale[fbj2s_shuttle_test, ])
mean((fbj2s_shuttle_lasso.pred_scale - fbj2s_shuttle_y.test_scale)^2)
```

# If player only has forty and broad jump predict vertical
```{r}
update4 <- update3 %>% mutate(vertical = if_else(
                           !is.na(forty) & is.na(vertical) & !is.na(broad_jump) & is.na(three_cone) & is.na(shuttle),
                           fbj2v_vertical_lasso.coef[fbj2v_vertical_lasso.coef != 0][1] +
                             fbj2v_vertical_lasso.coef[fbj2v_vertical_lasso.coef != 0][2] * height +
                             fbj2v_vertical_lasso.coef[fbj2v_vertical_lasso.coef != 0][3] * forty + 
                             fbj2v_vertical_lasso.coef[fbj2v_vertical_lasso.coef != 0][4] * broad_jump +
                             fbj2v_vertical_lasso.coef[fbj2v_vertical_lasso.coef != 0][5] * G,
                           vertical
                         )) 
```

# Use vertical and broad jump to predict
```{r}
broad_jump_vertical_2_forty <- combinecollege %>% select(-player, -three_cone, -shuttle) %>% 
  filter(!is.na(broad_jump) & !is.na(vertical) & !is.na(forty))


bjv2f_forty_x <- model.matrix(forty ~ ., broad_jump_vertical_2_forty)
bjv2f_forty_y <- broad_jump_vertical_2_forty$forty
bjv2f_forty_x 
mean(bjv2f_forty_y)

set.seed(2)
bjv2f_forty_train <- sample(1:nrow(bjv2f_forty_x), .8*nrow(bjv2f_forty_x))
bjv2f_forty_test <- (-bjv2f_forty_train)
bjv2f_forty_y.test <- bjv2f_forty_y[bjv2f_forty_test]

grid <- 10^seq(-5, 5, length = 100)

bjv2f_forty_lasso.mod <- glmnet(bjv2f_forty_x[bjv2f_forty_train, ], bjv2f_forty_y[bjv2f_forty_train], alpha = 1,
    lambda = grid,intercept = TRUE ,standardize = TRUE)
plot(bjv2f_forty_lasso.mod)

set.seed(1)
bjv2f_forty_cv.out <- cv.glmnet(bjv2f_forty_x[bjv2f_forty_train, ], bjv2f_forty_y[bjv2f_forty_train], alpha = 1)
#plot(bjv2f_forty_cv.out)
bjv2f_forty_bestlam <- bjv2f_forty_cv.out$lambda.min
#bjv2f_forty_bestlam <- 1
bjv2f_forty_lasso.pred <- predict(bjv2f_forty_lasso.mod, s = bjv2f_forty_bestlam,
    newx = bjv2f_forty_x[bjv2f_forty_test, ])
mean((bjv2f_forty_lasso.pred - bjv2f_forty_y.test)^2)

bjv2f_forty_out <- glmnet(bjv2f_forty_x, bjv2f_forty_y, alpha = 1, lambda = bjv2f_forty_bestlam )
coef(bjv2f_forty_out)
bjv2f_forty_lasso.coef <- predict(bjv2f_forty_out, type = "coefficients",
    s = bjv2f_forty_bestlam)[1:(ncol(broad_jump_vertical_2_forty)+1), ]
bjv2f_forty_lasso.coef
bjv2f_forty_lasso.coef[bjv2f_forty_lasso.coef != 0]

ggplot(broad_jump_vertical_2_forty[-bjv2f_forty_train,] %>% mutate(pred = bjv2f_forty_lasso.pred),
       aes(x = pred, forty)) +
  geom_point()



bjv2f_forty_x_scale <- model.matrix(scale(forty) ~ scale(broad_jump) + scale(vertical), broad_jump_vertical_2_forty)
bjv2f_forty_y_scale <- (broad_jump_vertical_2_forty %>% mutate(forty = scale(forty)))$forty

set.seed(2)
bjv2f_forty_train <- sample(1:nrow(bjv2f_forty_x_scale), .8*nrow(bjv2f_forty_x_scale))
bjv2f_forty_test <- (-bjv2f_forty_train)
bjv2f_forty_y.test_scale <- bjv2f_forty_y_scale[bjv2f_forty_test]

bjv2f_forty_lasso.mod_scale <- glmnet(bjv2f_forty_x_scale[bjv2f_forty_train, ], bjv2f_forty_y_scale[bjv2f_forty_train], alpha = 1,
    lambda = grid,intercept = TRUE ,standardize = TRUE)

set.seed(1)
bjv2f_forty_cv.out_scale <- cv.glmnet(bjv2f_forty_x_scale[bjv2f_forty_train, ], bjv2f_forty_y_scale[bjv2f_forty_train], alpha = 1)
#plot(bjv2f_forty_cv.out)
bjv2f_forty_bestlam_scale <- bjv2f_forty_cv.out_scale$lambda.min
#bjv2f_forty_bestlam <- 1
bjv2f_forty_lasso.pred_scale <- predict(bjv2f_forty_lasso.mod_scale, s = bjv2f_forty_bestlam_scale,
    newx = bjv2f_forty_x_scale[bjv2f_forty_test, ])
mean((bjv2f_forty_lasso.pred_scale - bjv2f_forty_y.test_scale)^2)
```

```{r}
broad_jump_vertical_2_three_cone <- combinecollege %>% select(-player, -forty, -shuttle) %>% 
  filter(!is.na(broad_jump) & !is.na(vertical) & !is.na(three_cone))


bjv23c_three_cone_x <- model.matrix(three_cone ~ ., broad_jump_vertical_2_three_cone)
bjv23c_three_cone_y <- broad_jump_vertical_2_three_cone$three_cone
bjv23c_three_cone_x 
mean(bjv23c_three_cone_y)

set.seed(2)
bjv23c_three_cone_train <- sample(1:nrow(bjv23c_three_cone_x), .8*nrow(bjv23c_three_cone_x))
bjv23c_three_cone_test <- (-bjv23c_three_cone_train)
bjv23c_three_cone_y.test <- bjv23c_three_cone_y[bjv23c_three_cone_test]

grid <- 10^seq(-5, 5, length = 100)

bjv23c_three_cone_lasso.mod <- glmnet(bjv23c_three_cone_x[bjv23c_three_cone_train, ], bjv23c_three_cone_y[bjv23c_three_cone_train], alpha = 1,
    lambda = grid,intercept = TRUE ,standardize = TRUE)
plot(bjv23c_three_cone_lasso.mod)

set.seed(1)
bjv23c_three_cone_cv.out <- cv.glmnet(bjv23c_three_cone_x[bjv23c_three_cone_train, ], bjv23c_three_cone_y[bjv23c_three_cone_train], alpha = 1)
#plot(bjv23c_three_cone_cv.out)
bjv23c_three_cone_bestlam <- bjv23c_three_cone_cv.out$lambda.min
#bjv23c_three_cone_bestlam <- 1
bjv23c_three_cone_lasso.pred <- predict(bjv23c_three_cone_lasso.mod, s = bjv23c_three_cone_bestlam,
    newx = bjv23c_three_cone_x[bjv23c_three_cone_test, ])
mean((bjv23c_three_cone_lasso.pred - bjv23c_three_cone_y.test)^2)

bjv23c_three_cone_out <- glmnet(bjv23c_three_cone_x, bjv23c_three_cone_y, alpha = 1, lambda = bjv23c_three_cone_bestlam )
coef(bjv23c_three_cone_out)
bjv23c_three_cone_lasso.coef <- predict(bjv23c_three_cone_out, type = "coefficients",
    s = bjv23c_three_cone_bestlam)[1:(ncol(broad_jump_vertical_2_three_cone)+1), ]
bjv23c_three_cone_lasso.coef
bjv23c_three_cone_lasso.coef[bjv23c_three_cone_lasso.coef != 0]

ggplot(broad_jump_vertical_2_three_cone[-bjv23c_three_cone_train,] %>% mutate(pred = bjv23c_three_cone_lasso.pred),
       aes(x = pred, three_cone)) +
  geom_point()



bjv23c_three_cone_x_scale <- model.matrix(scale(three_cone) ~ scale(broad_jump) + scale(vertical), broad_jump_vertical_2_three_cone)
bjv23c_three_cone_y_scale <- (broad_jump_vertical_2_three_cone %>% mutate(three_cone = scale(three_cone)))$three_cone

set.seed(2)
bjv23c_three_cone_train <- sample(1:nrow(bjv23c_three_cone_x_scale), .8*nrow(bjv23c_three_cone_x_scale))
bjv23c_three_cone_test <- (-bjv23c_three_cone_train)
bjv23c_three_cone_y.test_scale <- bjv23c_three_cone_y_scale[bjv23c_three_cone_test]

bjv23c_three_cone_lasso.mod_scale <- glmnet(bjv23c_three_cone_x_scale[bjv23c_three_cone_train, ], bjv23c_three_cone_y_scale[bjv23c_three_cone_train], alpha = 1,
    lambda = grid,intercept = TRUE ,standardize = TRUE)

set.seed(1)
bjv23c_three_cone_cv.out_scale <- cv.glmnet(bjv23c_three_cone_x_scale[bjv23c_three_cone_train, ], bjv23c_three_cone_y_scale[bjv23c_three_cone_train], alpha = 1)
#plot(bjv23c_three_cone_cv.out)
bjv23c_three_cone_bestlam_scale <- bjv23c_three_cone_cv.out_scale$lambda.min
#bjv23c_three_cone_bestlam <- 1
bjv23c_three_cone_lasso.pred_scale <- predict(bjv23c_three_cone_lasso.mod_scale, s = bjv23c_three_cone_bestlam_scale,
    newx = bjv23c_three_cone_x_scale[bjv23c_three_cone_test, ])
mean((bjv23c_three_cone_lasso.pred_scale - bjv23c_three_cone_y.test_scale)^2)
```

```{r}
broad_jump_vertical_2_shuttle <- combinecollege %>% select(-player, -three_cone, -forty) %>% 
  filter(!is.na(broad_jump) & !is.na(vertical) & !is.na(shuttle))


bjv2s_shuttle_x <- model.matrix(shuttle ~ ., broad_jump_vertical_2_shuttle)
bjv2s_shuttle_y <- broad_jump_vertical_2_shuttle$shuttle
bjv2s_shuttle_x 
mean(bjv2s_shuttle_y)

set.seed(2)
bjv2s_shuttle_train <- sample(1:nrow(bjv2s_shuttle_x), .8*nrow(bjv2s_shuttle_x))
bjv2s_shuttle_test <- (-bjv2s_shuttle_train)
bjv2s_shuttle_y.test <- bjv2s_shuttle_y[bjv2s_shuttle_test]

grid <- 10^seq(-5, 5, length = 100)

bjv2s_shuttle_lasso.mod <- glmnet(bjv2s_shuttle_x[bjv2s_shuttle_train, ], bjv2s_shuttle_y[bjv2s_shuttle_train], alpha = 1,
    lambda = grid,intercept = TRUE ,standardize = TRUE)
plot(bjv2s_shuttle_lasso.mod)

set.seed(1)
bjv2s_shuttle_cv.out <- cv.glmnet(bjv2s_shuttle_x[bjv2s_shuttle_train, ], bjv2s_shuttle_y[bjv2s_shuttle_train], alpha = 1)
#plot(bjv2s_shuttle_cv.out)
bjv2s_shuttle_bestlam <- bjv2s_shuttle_cv.out$lambda.min
#bjv2s_shuttle_bestlam <- 1
bjv2s_shuttle_lasso.pred <- predict(bjv2s_shuttle_lasso.mod, s = bjv2s_shuttle_bestlam,
    newx = bjv2s_shuttle_x[bjv2s_shuttle_test, ])
mean((bjv2s_shuttle_lasso.pred - bjv2s_shuttle_y.test)^2)

bjv2s_shuttle_out <- glmnet(bjv2s_shuttle_x, bjv2s_shuttle_y, alpha = 1, lambda = bjv2s_shuttle_bestlam )
coef(bjv2s_shuttle_out)
bjv2s_shuttle_lasso.coef <- predict(bjv2s_shuttle_out, type = "coefficients",
    s = bjv2s_shuttle_bestlam)[1:(ncol(broad_jump_vertical_2_shuttle)+1), ]
bjv2s_shuttle_lasso.coef
bjv2s_shuttle_lasso.coef[bjv2s_shuttle_lasso.coef != 0]

ggplot(broad_jump_vertical_2_shuttle[-bjv2s_shuttle_train,] %>% mutate(pred = bjv2s_shuttle_lasso.pred),
       aes(x = pred, shuttle)) +
  geom_point()



bjv2s_shuttle_x_scale <- model.matrix(scale(shuttle) ~ scale(broad_jump) + scale(vertical), broad_jump_vertical_2_shuttle)
bjv2s_shuttle_y_scale <- (broad_jump_vertical_2_shuttle %>% mutate(shuttle = scale(shuttle)))$shuttle

set.seed(2)
bjv2s_shuttle_train <- sample(1:nrow(bjv2s_shuttle_x_scale), .8*nrow(bjv2s_shuttle_x_scale))
bjv2s_shuttle_test <- (-bjv2s_shuttle_train)
bjv2s_shuttle_y.test_scale <- bjv2s_shuttle_y_scale[bjv2s_shuttle_test]

bjv2s_shuttle_lasso.mod_scale <- glmnet(bjv2s_shuttle_x_scale[bjv2s_shuttle_train, ], bjv2s_shuttle_y_scale[bjv2s_shuttle_train], alpha = 1,
    lambda = grid,intercept = TRUE ,standardize = TRUE)

set.seed(1)
bjv2s_shuttle_cv.out_scale <- cv.glmnet(bjv2s_shuttle_x_scale[bjv2s_shuttle_train, ], bjv2s_shuttle_y_scale[bjv2s_shuttle_train], alpha = 1)
#plot(bjv2s_shuttle_cv.out)
bjv2s_shuttle_bestlam_scale <- bjv2s_shuttle_cv.out_scale$lambda.min
#bjv2s_shuttle_bestlam <- 1
bjv2s_shuttle_lasso.pred_scale <- predict(bjv2s_shuttle_lasso.mod_scale, s = bjv2s_shuttle_bestlam_scale,
    newx = bjv2s_shuttle_x_scale[bjv2s_shuttle_test, ])
mean((bjv2s_shuttle_lasso.pred_scale - bjv2s_shuttle_y.test_scale)^2)
```

# If player only has broad jump and vertical predict shuttle
```{r}
update5 <- update4 %>% mutate(shuttle = if_else(
                           is.na(forty) & !is.na(vertical) & !is.na(broad_jump) & is.na(three_cone) & is.na(shuttle),
                           bjv2s_shuttle_lasso.coef[bjv2s_shuttle_lasso.coef != 0][1] +
                             bjv2s_shuttle_lasso.coef[bjv2s_shuttle_lasso.coef != 0][2] * weight +
                             bjv2s_shuttle_lasso.coef[bjv2s_shuttle_lasso.coef != 0][3] * vertical +
                             bjv2s_shuttle_lasso.coef[bjv2s_shuttle_lasso.coef != 0][4] * Rec +
                             bjv2s_shuttle_lasso.coef[bjv2s_shuttle_lasso.coef != 0][5] * RecAvg +
                             bjv2s_shuttle_lasso.coef[bjv2s_shuttle_lasso.coef != 0][6] * TotTD,
                           shuttle
                         )) 
```

# Use forty and three cone to predict
```{r}
forty_three_cone_2_vertical <- combinecollege %>% select(-player, -broad_jump, -shuttle) %>% 
  filter(!is.na(forty) & !is.na(three_cone) & !is.na(vertical))


f3c2v_vertical_x <- model.matrix(vertical ~ ., forty_three_cone_2_vertical)
f3c2v_vertical_y <- forty_three_cone_2_vertical$vertical
f3c2v_vertical_x 
mean(f3c2v_vertical_y)

set.seed(2)
f3c2v_vertical_train <- sample(1:nrow(f3c2v_vertical_x), .8*nrow(f3c2v_vertical_x))
f3c2v_vertical_test <- (-f3c2v_vertical_train)
f3c2v_vertical_y.test <- f3c2v_vertical_y[f3c2v_vertical_test]

grid <- 10^seq(-5, 5, length = 100)

f3c2v_vertical_lasso.mod <- glmnet(f3c2v_vertical_x[f3c2v_vertical_train, ], f3c2v_vertical_y[f3c2v_vertical_train], alpha = 1,
    lambda = grid,intercept = TRUE ,standardize = TRUE)
plot(f3c2v_vertical_lasso.mod)

set.seed(1)
f3c2v_vertical_cv.out <- cv.glmnet(f3c2v_vertical_x[f3c2v_vertical_train, ], f3c2v_vertical_y[f3c2v_vertical_train], alpha = 1)
#plot(f3c2v_vertical_cv.out)
f3c2v_vertical_bestlam <- f3c2v_vertical_cv.out$lambda.min
#f3c2v_vertical_bestlam <- 1
f3c2v_vertical_lasso.pred <- predict(f3c2v_vertical_lasso.mod, s = f3c2v_vertical_bestlam,
    newx = f3c2v_vertical_x[f3c2v_vertical_test, ])
mean((f3c2v_vertical_lasso.pred - f3c2v_vertical_y.test)^2)

f3c2v_vertical_out <- glmnet(f3c2v_vertical_x, f3c2v_vertical_y, alpha = 1, lambda = f3c2v_vertical_bestlam )
coef(f3c2v_vertical_out)
f3c2v_vertical_lasso.coef <- predict(f3c2v_vertical_out, type = "coefficients",
    s = f3c2v_vertical_bestlam)[1:(ncol(forty_2_vertical)+2), ]
f3c2v_vertical_lasso.coef
f3c2v_vertical_lasso.coef[f3c2v_vertical_lasso.coef != 0]

ggplot(forty_three_cone_2_vertical[-f3c2v_vertical_train,] %>% mutate(pred = f3c2v_vertical_lasso.pred),
       aes(x = pred, vertical)) +
  geom_point()



f3c2v_vertical_x_scale <- model.matrix(scale(vertical) ~ scale(forty) + scale(three_cone), forty_three_cone_2_vertical)
f3c2v_vertical_y_scale <- (forty_three_cone_2_vertical %>% mutate(vertical = scale(vertical)))$vertical

set.seed(2)
f3c2v_vertical_train <- sample(1:nrow(f3c2v_vertical_x_scale), .8*nrow(f3c2v_vertical_x_scale))
f3c2v_vertical_test <- (-f3c2v_vertical_train)
f3c2v_vertical_y.test_scale <- f3c2v_vertical_y_scale[f3c2v_vertical_test]

f3c2v_vertical_lasso.mod_scale <- glmnet(f3c2v_vertical_x_scale[f3c2v_vertical_train, ], f3c2v_vertical_y_scale[f3c2v_vertical_train], alpha = 1,
    lambda = grid,intercept = TRUE ,standardize = TRUE)

set.seed(1)
f3c2v_vertical_cv.out_scale <- cv.glmnet(f3c2v_vertical_x_scale[f3c2v_vertical_train, ], f3c2v_vertical_y_scale[f3c2v_vertical_train], alpha = 1)
#plot(f3c2v_vertical_cv.out)
f3c2v_vertical_bestlam_scale <- f3c2v_vertical_cv.out_scale$lambda.min
#f3c2v_vertical_bestlam <- 1
f3c2v_vertical_lasso.pred_scale <- predict(f3c2v_vertical_lasso.mod_scale, s = f3c2v_vertical_bestlam_scale,
    newx = f3c2v_vertical_x_scale[f3c2v_vertical_test, ])
mean((f3c2v_vertical_lasso.pred_scale - f3c2v_vertical_y.test_scale)^2)
```

```{r}
forty_three_cone_2_broad_jump <- combinecollege %>% select(-player, -vertical, -shuttle) %>% 
  filter(!is.na(forty) & !is.na(three_cone) & !is.na(broad_jump))


f3c2bj_broad_jump_x <- model.matrix(broad_jump ~ ., forty_three_cone_2_broad_jump)
f3c2bj_broad_jump_y <- forty_three_cone_2_broad_jump$broad_jump
f3c2bj_broad_jump_x 
mean(f3c2bj_broad_jump_y)

set.seed(2)
f3c2bj_broad_jump_train <- sample(1:nrow(f3c2bj_broad_jump_x), .8*nrow(f3c2bj_broad_jump_x))
f3c2bj_broad_jump_test <- (-f3c2bj_broad_jump_train)
f3c2bj_broad_jump_y.test <- f3c2bj_broad_jump_y[f3c2bj_broad_jump_test]

grid <- 10^seq(-5, 5, length = 100)

f3c2bj_broad_jump_lasso.mod <- glmnet(f3c2bj_broad_jump_x[f3c2bj_broad_jump_train, ], f3c2bj_broad_jump_y[f3c2bj_broad_jump_train], alpha = 1,
    lambda = grid,intercept = TRUE ,standardize = TRUE)
plot(f3c2bj_broad_jump_lasso.mod)

set.seed(1)
f3c2bj_broad_jump_cv.out <- cv.glmnet(f3c2bj_broad_jump_x[f3c2bj_broad_jump_train, ], f3c2bj_broad_jump_y[f3c2bj_broad_jump_train], alpha = 1)
#plot(f3c2bj_broad_jump_cv.out)
f3c2bj_broad_jump_bestlam <- f3c2bj_broad_jump_cv.out$lambda.min
#f3c2bj_broad_jump_bestlam <- 1
f3c2bj_broad_jump_lasso.pred <- predict(f3c2bj_broad_jump_lasso.mod, s = f3c2bj_broad_jump_bestlam,
    newx = f3c2bj_broad_jump_x[f3c2bj_broad_jump_test, ])
mean((f3c2bj_broad_jump_lasso.pred - f3c2bj_broad_jump_y.test)^2)

f3c2bj_broad_jump_out <- glmnet(f3c2bj_broad_jump_x, f3c2bj_broad_jump_y, alpha = 1, lambda = f3c2bj_broad_jump_bestlam )
coef(f3c2bj_broad_jump_out)
f3c2bj_broad_jump_lasso.coef <- predict(f3c2bj_broad_jump_out, type = "coefficients",
    s = f3c2bj_broad_jump_bestlam)[1:(ncol(forty_2_broad_jump)+2), ]
f3c2bj_broad_jump_lasso.coef
f3c2bj_broad_jump_lasso.coef[f3c2bj_broad_jump_lasso.coef != 0]

ggplot(forty_three_cone_2_broad_jump[-f3c2bj_broad_jump_train,] %>% mutate(pred = f3c2bj_broad_jump_lasso.pred),
       aes(x = pred, broad_jump)) +
  geom_point()



f3c2bj_broad_jump_x_scale <- model.matrix(scale(broad_jump) ~ scale(forty) + scale(three_cone), forty_three_cone_2_broad_jump)
f3c2bj_broad_jump_y_scale <- (forty_three_cone_2_broad_jump %>% mutate(broad_jump = scale(broad_jump)))$broad_jump

set.seed(2)
f3c2bj_broad_jump_train <- sample(1:nrow(f3c2bj_broad_jump_x_scale), .8*nrow(f3c2bj_broad_jump_x_scale))
f3c2bj_broad_jump_test <- (-f3c2bj_broad_jump_train)
f3c2bj_broad_jump_y.test_scale <- f3c2bj_broad_jump_y_scale[f3c2bj_broad_jump_test]

f3c2bj_broad_jump_lasso.mod_scale <- glmnet(f3c2bj_broad_jump_x_scale[f3c2bj_broad_jump_train, ], f3c2bj_broad_jump_y_scale[f3c2bj_broad_jump_train], alpha = 1,
    lambda = grid,intercept = TRUE ,standardize = TRUE)

set.seed(1)
f3c2bj_broad_jump_cv.out_scale <- cv.glmnet(f3c2bj_broad_jump_x_scale[f3c2bj_broad_jump_train, ], f3c2bj_broad_jump_y_scale[f3c2bj_broad_jump_train], alpha = 1)
#plot(f3c2bj_broad_jump_cv.out)
f3c2bj_broad_jump_bestlam_scale <- f3c2bj_broad_jump_cv.out_scale$lambda.min
#f3c2bj_broad_jump_bestlam <- 1
f3c2bj_broad_jump_lasso.pred_scale <- predict(f3c2bj_broad_jump_lasso.mod_scale, s = f3c2bj_broad_jump_bestlam_scale,
    newx = f3c2bj_broad_jump_x_scale[f3c2bj_broad_jump_test, ])
mean((f3c2bj_broad_jump_lasso.pred_scale - f3c2bj_broad_jump_y.test_scale)^2)
```

```{r}
forty_three_cone_2_shuttle <- combinecollege %>% select(-player, -vertical, -broad_jump) %>% 
  filter(!is.na(forty) & !is.na(three_cone) & !is.na(shuttle))


f3c2s_shuttle_x <- model.matrix(shuttle ~ ., forty_three_cone_2_shuttle)
f3c2s_shuttle_y <- forty_three_cone_2_shuttle$shuttle
f3c2s_shuttle_x 
mean(f3c2s_shuttle_y)

set.seed(2)
f3c2s_shuttle_train <- sample(1:nrow(f3c2s_shuttle_x), .8*nrow(f3c2s_shuttle_x))
f3c2s_shuttle_test <- (-f3c2s_shuttle_train)
f3c2s_shuttle_y.test <- f3c2s_shuttle_y[f3c2s_shuttle_test]

grid <- 10^seq(-5, 5, length = 100)

f3c2s_shuttle_lasso.mod <- glmnet(f3c2s_shuttle_x[f3c2s_shuttle_train, ], f3c2s_shuttle_y[f3c2s_shuttle_train], alpha = 1,
    lambda = grid,intercept = TRUE ,standardize = TRUE)
plot(f3c2s_shuttle_lasso.mod)

set.seed(1)
f3c2s_shuttle_cv.out <- cv.glmnet(f3c2s_shuttle_x[f3c2s_shuttle_train, ], f3c2s_shuttle_y[f3c2s_shuttle_train], alpha = 1)
#plot(f3c2s_shuttle_cv.out)
f3c2s_shuttle_bestlam <- f3c2s_shuttle_cv.out$lambda.min
#f3c2s_shuttle_bestlam <- 1
f3c2s_shuttle_lasso.pred <- predict(f3c2s_shuttle_lasso.mod, s = f3c2s_shuttle_bestlam,
    newx = f3c2s_shuttle_x[f3c2s_shuttle_test, ])
mean((f3c2s_shuttle_lasso.pred - f3c2s_shuttle_y.test)^2)

f3c2s_shuttle_out <- glmnet(f3c2s_shuttle_x, f3c2s_shuttle_y, alpha = 1, lambda = f3c2s_shuttle_bestlam )
coef(f3c2s_shuttle_out)
f3c2s_shuttle_lasso.coef <- predict(f3c2s_shuttle_out, type = "coefficients",
    s = f3c2s_shuttle_bestlam)[1:(ncol(forty_2_shuttle)+2), ]
f3c2s_shuttle_lasso.coef
f3c2s_shuttle_lasso.coef[f3c2s_shuttle_lasso.coef != 0]

ggplot(forty_three_cone_2_shuttle[-f3c2s_shuttle_train,] %>% mutate(pred = f3c2s_shuttle_lasso.pred),
       aes(x = pred, shuttle)) +
  geom_point()



f3c2s_shuttle_x_scale <- model.matrix(scale(shuttle) ~ scale(forty) + scale(three_cone), forty_three_cone_2_shuttle)
f3c2s_shuttle_y_scale <- (forty_three_cone_2_shuttle %>% mutate(shuttle = scale(shuttle)))$shuttle

set.seed(2)
f3c2s_shuttle_train <- sample(1:nrow(f3c2s_shuttle_x_scale), .8*nrow(f3c2s_shuttle_x_scale))
f3c2s_shuttle_test <- (-f3c2s_shuttle_train)
f3c2s_shuttle_y.test_scale <- f3c2s_shuttle_y_scale[f3c2s_shuttle_test]

f3c2s_shuttle_lasso.mod_scale <- glmnet(f3c2s_shuttle_x_scale[f3c2s_shuttle_train, ], f3c2s_shuttle_y_scale[f3c2s_shuttle_train], alpha = 1,
    lambda = grid,intercept = TRUE ,standardize = TRUE)

set.seed(1)
f3c2s_shuttle_cv.out_scale <- cv.glmnet(f3c2s_shuttle_x_scale[f3c2s_shuttle_train, ], f3c2s_shuttle_y_scale[f3c2s_shuttle_train], alpha = 1)
#plot(f3c2s_shuttle_cv.out)
f3c2s_shuttle_bestlam_scale <- f3c2s_shuttle_cv.out_scale$lambda.min
#f3c2s_shuttle_bestlam <- 1
f3c2s_shuttle_lasso.pred_scale <- predict(f3c2s_shuttle_lasso.mod_scale, s = f3c2s_shuttle_bestlam_scale,
    newx = f3c2s_shuttle_x_scale[f3c2s_shuttle_test, ])
mean((f3c2s_shuttle_lasso.pred_scale - f3c2s_shuttle_y.test_scale)^2)
```

# If player only has forty and three cone predict shuttle
```{r}
update6 <- update5 %>% mutate(shuttle = if_else(
                           !is.na(forty) & is.na(vertical) & is.na(broad_jump) & !is.na(three_cone) & is.na(shuttle),
                           f3c2s_shuttle_lasso.coef[f3c2s_shuttle_lasso.coef != 0][1] +
                             f3c2s_shuttle_lasso.coef[f3c2s_shuttle_lasso.coef != 0][2] * weight +
                             f3c2s_shuttle_lasso.coef[f3c2s_shuttle_lasso.coef != 0][3] * three_cone +
                             f3c2s_shuttle_lasso.coef[f3c2s_shuttle_lasso.coef != 0][4] * G +
                             f3c2s_shuttle_lasso.coef[f3c2s_shuttle_lasso.coef != 0][5] * Rec +
                             f3c2s_shuttle_lasso.coef[f3c2s_shuttle_lasso.coef != 0][6] * RecAvg +
                             f3c2s_shuttle_lasso.coef[f3c2s_shuttle_lasso.coef != 0][7] *  TotTD +
                             f3c2s_shuttle_lasso.coef[f3c2s_shuttle_lasso.coef != 0][8] * as.numeric(ConfIndicator),
                           shuttle
                         )) 
```

# Use forty and shuttle to predict
```{r}
forty_shuttle_2_vertical <- combinecollege %>% select(-player, -broad_jump, -three_cone) %>% 
  filter(!is.na(forty) & !is.na(shuttle) & !is.na(vertical))


fs2v_vertical_x <- model.matrix(vertical ~ ., forty_shuttle_2_vertical)
fs2v_vertical_y <- forty_shuttle_2_vertical$vertical
fs2v_vertical_x 
mean(fs2v_vertical_y)

set.seed(2)
fs2v_vertical_train <- sample(1:nrow(fs2v_vertical_x), .8*nrow(fs2v_vertical_x))
fs2v_vertical_test <- (-fs2v_vertical_train)
fs2v_vertical_y.test <- fs2v_vertical_y[fs2v_vertical_test]

grid <- 10^seq(-5, 5, length = 100)

fs2v_vertical_lasso.mod <- glmnet(fs2v_vertical_x[fs2v_vertical_train, ], fs2v_vertical_y[fs2v_vertical_train], alpha = 1,
    lambda = grid,intercept = TRUE ,standardize = TRUE)
plot(fs2v_vertical_lasso.mod)

set.seed(1)
fs2v_vertical_cv.out <- cv.glmnet(fs2v_vertical_x[fs2v_vertical_train, ], fs2v_vertical_y[fs2v_vertical_train], alpha = 1)
#plot(fs2v_vertical_cv.out)
fs2v_vertical_bestlam <- fs2v_vertical_cv.out$lambda.min
#fs2v_vertical_bestlam <- 1
fs2v_vertical_lasso.pred <- predict(fs2v_vertical_lasso.mod, s = fs2v_vertical_bestlam,
    newx = fs2v_vertical_x[fs2v_vertical_test, ])
mean((fs2v_vertical_lasso.pred - fs2v_vertical_y.test)^2)

fs2v_vertical_out <- glmnet(fs2v_vertical_x, fs2v_vertical_y, alpha = 1, lambda = fs2v_vertical_bestlam )
coef(fs2v_vertical_out)
fs2v_vertical_lasso.coef <- predict(fs2v_vertical_out, type = "coefficients",
    s = fs2v_vertical_bestlam)[1:(ncol(forty_2_vertical)+2), ]
fs2v_vertical_lasso.coef
fs2v_vertical_lasso.coef[fs2v_vertical_lasso.coef != 0]

ggplot(forty_shuttle_2_vertical[-fs2v_vertical_train,] %>% mutate(pred = fs2v_vertical_lasso.pred),
       aes(x = pred, vertical)) +
  geom_point()



fs2v_vertical_x_scale <- model.matrix(scale(vertical) ~ scale(forty) + scale(shuttle), forty_shuttle_2_vertical)
fs2v_vertical_y_scale <- (forty_shuttle_2_vertical %>% mutate(vertical = scale(vertical)))$vertical

set.seed(2)
fs2v_vertical_train <- sample(1:nrow(fs2v_vertical_x_scale), .8*nrow(fs2v_vertical_x_scale))
fs2v_vertical_test <- (-fs2v_vertical_train)
fs2v_vertical_y.test_scale <- fs2v_vertical_y_scale[fs2v_vertical_test]

fs2v_vertical_lasso.mod_scale <- glmnet(fs2v_vertical_x_scale[fs2v_vertical_train, ], fs2v_vertical_y_scale[fs2v_vertical_train], alpha = 1,
    lambda = grid,intercept = TRUE ,standardize = TRUE)

set.seed(1)
fs2v_vertical_cv.out_scale <- cv.glmnet(fs2v_vertical_x_scale[fs2v_vertical_train, ], fs2v_vertical_y_scale[fs2v_vertical_train], alpha = 1)
#plot(fs2v_vertical_cv.out)
fs2v_vertical_bestlam_scale <- fs2v_vertical_cv.out_scale$lambda.min
#fs2v_vertical_bestlam <- 1
fs2v_vertical_lasso.pred_scale <- predict(fs2v_vertical_lasso.mod_scale, s = fs2v_vertical_bestlam_scale,
    newx = fs2v_vertical_x_scale[fs2v_vertical_test, ])
mean((fs2v_vertical_lasso.pred_scale - fs2v_vertical_y.test_scale)^2)
```

```{r}
forty_shuttle_2_broad_jump <- combinecollege %>% select(-player, -vertical, -three_cone) %>% 
  filter(!is.na(forty) & !is.na(shuttle) & !is.na(broad_jump))


fs2bj_broad_jump_x <- model.matrix(broad_jump ~ ., forty_shuttle_2_broad_jump)
fs2bj_broad_jump_y <- forty_shuttle_2_broad_jump$broad_jump
fs2bj_broad_jump_x 
mean(fs2bj_broad_jump_y)

set.seed(2)
fs2bj_broad_jump_train <- sample(1:nrow(fs2bj_broad_jump_x), .8*nrow(fs2bj_broad_jump_x))
fs2bj_broad_jump_test <- (-fs2bj_broad_jump_train)
fs2bj_broad_jump_y.test <- fs2bj_broad_jump_y[fs2bj_broad_jump_test]

grid <- 10^seq(-5, 5, length = 100)

fs2bj_broad_jump_lasso.mod <- glmnet(fs2bj_broad_jump_x[fs2bj_broad_jump_train, ], fs2bj_broad_jump_y[fs2bj_broad_jump_train], alpha = 1,
    lambda = grid,intercept = TRUE ,standardize = TRUE)
plot(fs2bj_broad_jump_lasso.mod)

set.seed(1)
fs2bj_broad_jump_cv.out <- cv.glmnet(fs2bj_broad_jump_x[fs2bj_broad_jump_train, ], fs2bj_broad_jump_y[fs2bj_broad_jump_train], alpha = 1)
#plot(fs2bj_broad_jump_cv.out)
fs2bj_broad_jump_bestlam <- fs2bj_broad_jump_cv.out$lambda.min
#fs2bj_broad_jump_bestlam <- 1
fs2bj_broad_jump_lasso.pred <- predict(fs2bj_broad_jump_lasso.mod, s = fs2bj_broad_jump_bestlam,
    newx = fs2bj_broad_jump_x[fs2bj_broad_jump_test, ])
mean((fs2bj_broad_jump_lasso.pred - fs2bj_broad_jump_y.test)^2)

fs2bj_broad_jump_out <- glmnet(fs2bj_broad_jump_x, fs2bj_broad_jump_y, alpha = 1, lambda = fs2bj_broad_jump_bestlam )
coef(fs2bj_broad_jump_out)
fs2bj_broad_jump_lasso.coef <- predict(fs2bj_broad_jump_out, type = "coefficients",
    s = fs2bj_broad_jump_bestlam)[1:(ncol(forty_2_broad_jump)+2), ]
fs2bj_broad_jump_lasso.coef
fs2bj_broad_jump_lasso.coef[fs2bj_broad_jump_lasso.coef != 0]

ggplot(forty_shuttle_2_broad_jump[-fs2bj_broad_jump_train,] %>% mutate(pred = fs2bj_broad_jump_lasso.pred),
       aes(x = pred, broad_jump)) +
  geom_point()



fs2bj_broad_jump_x_scale <- model.matrix(scale(broad_jump) ~ scale(forty) + scale(shuttle), forty_shuttle_2_broad_jump)
fs2bj_broad_jump_y_scale <- (forty_shuttle_2_broad_jump %>% mutate(broad_jump = scale(broad_jump)))$broad_jump

set.seed(2)
fs2bj_broad_jump_train <- sample(1:nrow(fs2bj_broad_jump_x_scale), .8*nrow(fs2bj_broad_jump_x_scale))
fs2bj_broad_jump_test <- (-fs2bj_broad_jump_train)
fs2bj_broad_jump_y.test_scale <- fs2bj_broad_jump_y_scale[fs2bj_broad_jump_test]

fs2bj_broad_jump_lasso.mod_scale <- glmnet(fs2bj_broad_jump_x_scale[fs2bj_broad_jump_train, ], fs2bj_broad_jump_y_scale[fs2bj_broad_jump_train], alpha = 1,
    lambda = grid,intercept = TRUE ,standardize = TRUE)

set.seed(1)
fs2bj_broad_jump_cv.out_scale <- cv.glmnet(fs2bj_broad_jump_x_scale[fs2bj_broad_jump_train, ], fs2bj_broad_jump_y_scale[fs2bj_broad_jump_train], alpha = 1)
#plot(fs2bj_broad_jump_cv.out)
fs2bj_broad_jump_bestlam_scale <- fs2bj_broad_jump_cv.out_scale$lambda.min
#fs2bj_broad_jump_bestlam <- 1
fs2bj_broad_jump_lasso.pred_scale <- predict(fs2bj_broad_jump_lasso.mod_scale, s = fs2bj_broad_jump_bestlam_scale,
    newx = fs2bj_broad_jump_x_scale[fs2bj_broad_jump_test, ])
mean((fs2bj_broad_jump_lasso.pred_scale - fs2bj_broad_jump_y.test_scale)^2)
```

```{r}
forty_shuttle_2_three_cone <- combinecollege %>% select(-player, -broad_jump, -vertical) %>% 
  filter(!is.na(forty) & !is.na(shuttle) & !is.na(three_cone))


fs23c_three_cone_x <- model.matrix(three_cone ~ ., forty_shuttle_2_three_cone)
fs23c_three_cone_y <- forty_shuttle_2_three_cone$three_cone
fs23c_three_cone_x 
mean(fs23c_three_cone_y)

set.seed(2)
fs23c_three_cone_train <- sample(1:nrow(fs23c_three_cone_x), .8*nrow(fs23c_three_cone_x))
fs23c_three_cone_test <- (-fs23c_three_cone_train)
fs23c_three_cone_y.test <- fs23c_three_cone_y[fs23c_three_cone_test]

grid <- 10^seq(-5, 5, length = 100)

fs23c_three_cone_lasso.mod <- glmnet(fs23c_three_cone_x[fs23c_three_cone_train, ], fs23c_three_cone_y[fs23c_three_cone_train], alpha = 1,
    lambda = grid,intercept = TRUE ,standardize = TRUE)
plot(fs23c_three_cone_lasso.mod)

set.seed(1)
fs23c_three_cone_cv.out <- cv.glmnet(fs23c_three_cone_x[fs23c_three_cone_train, ], fs23c_three_cone_y[fs23c_three_cone_train], alpha = 1)
#plot(fs23c_three_cone_cv.out)
fs23c_three_cone_bestlam <- fs23c_three_cone_cv.out$lambda.min
#fs23c_three_cone_bestlam <- 1
fs23c_three_cone_lasso.pred <- predict(fs23c_three_cone_lasso.mod, s = fs23c_three_cone_bestlam,
    newx = fs23c_three_cone_x[fs23c_three_cone_test, ])
mean((fs23c_three_cone_lasso.pred - fs23c_three_cone_y.test)^2)

fs23c_three_cone_out <- glmnet(fs23c_three_cone_x, fs23c_three_cone_y, alpha = 1, lambda = fs23c_three_cone_bestlam )
coef(fs23c_three_cone_out)
fs23c_three_cone_lasso.coef <- predict(fs23c_three_cone_out, type = "coefficients",
    s = fs23c_three_cone_bestlam)[1:(ncol(forty_2_three_cone)+2), ]
fs23c_three_cone_lasso.coef
fs23c_three_cone_lasso.coef[fs23c_three_cone_lasso.coef != 0]

ggplot(forty_shuttle_2_three_cone[-fs23c_three_cone_train,] %>% mutate(pred = fs23c_three_cone_lasso.pred),
       aes(x = pred, three_cone)) +
  geom_point()



fs23c_three_cone_x_scale <- model.matrix(scale(three_cone) ~ scale(forty) + scale(shuttle), forty_shuttle_2_three_cone)
fs23c_three_cone_y_scale <- (forty_shuttle_2_three_cone %>% mutate(three_cone = scale(three_cone)))$three_cone

set.seed(2)
fs23c_three_cone_train <- sample(1:nrow(fs23c_three_cone_x_scale), .8*nrow(fs23c_three_cone_x_scale))
fs23c_three_cone_test <- (-fs23c_three_cone_train)
fs23c_three_cone_y.test_scale <- fs23c_three_cone_y_scale[fs23c_three_cone_test]

fs23c_three_cone_lasso.mod_scale <- glmnet(fs23c_three_cone_x_scale[fs23c_three_cone_train, ], fs23c_three_cone_y_scale[fs23c_three_cone_train], alpha = 1,
    lambda = grid,intercept = TRUE ,standardize = TRUE)

set.seed(1)
fs23c_three_cone_cv.out_scale <- cv.glmnet(fs23c_three_cone_x_scale[fs23c_three_cone_train, ], fs23c_three_cone_y_scale[fs23c_three_cone_train], alpha = 1)
#plot(fs23c_three_cone_cv.out)
fs23c_three_cone_bestlam_scale <- fs23c_three_cone_cv.out_scale$lambda.min
#fs23c_three_cone_bestlam <- 1
fs23c_three_cone_lasso.pred_scale <- predict(fs23c_three_cone_lasso.mod_scale, s = fs23c_three_cone_bestlam_scale,
    newx = fs23c_three_cone_x_scale[fs23c_three_cone_test, ])
mean((fs23c_three_cone_lasso.pred_scale - fs23c_three_cone_y.test_scale)^2)
```

# If player only has forty and shuttle, predict three cone
```{r}
update7 <- update6 %>% mutate(three_cone = if_else(
                           !is.na(forty) & is.na(vertical) & is.na(broad_jump) & is.na(three_cone) & !is.na(shuttle),
                           fs23c_three_cone_lasso.coef[fs23c_three_cone_lasso.coef != 0][1] +
                             fs23c_three_cone_lasso.coef[fs23c_three_cone_lasso.coef != 0][2] * weight +
                             fs23c_three_cone_lasso.coef[fs23c_three_cone_lasso.coef != 0][3] * forty +
                             fs23c_three_cone_lasso.coef[fs23c_three_cone_lasso.coef != 0][4] * shuttle +
                             fs23c_three_cone_lasso.coef[fs23c_three_cone_lasso.coef != 0][5] * G +
                             fs23c_three_cone_lasso.coef[fs23c_three_cone_lasso.coef != 0][6] * RushYds +
                             fs23c_three_cone_lasso.coef[fs23c_three_cone_lasso.coef != 0][7] * as.numeric(ConfIndicator),
                           three_cone
                         )) 
```

# Use three cone and shuttle to predict
```{r}
three_cone_shuttle_2_forty <- combinecollege %>% select(-player, -broad_jump, -vertical) %>% 
  filter(!is.na(three_cone) & !is.na(shuttle) & !is.na(forty))


tcs2f_forty_x <- model.matrix(forty ~ ., three_cone_shuttle_2_forty)
tcs2f_forty_y <- three_cone_shuttle_2_forty$forty
tcs2f_forty_x 
mean(tcs2f_forty_y)

set.seed(2)
tcs2f_forty_train <- sample(1:nrow(tcs2f_forty_x), .8*nrow(tcs2f_forty_x))
tcs2f_forty_test <- (-tcs2f_forty_train)
tcs2f_forty_y.test <- tcs2f_forty_y[tcs2f_forty_test]

grid <- 10^seq(-5, 5, length = 100)

tcs2f_forty_lasso.mod <- glmnet(tcs2f_forty_x[tcs2f_forty_train, ], tcs2f_forty_y[tcs2f_forty_train], alpha = 1,
    lambda = grid,intercept = TRUE ,standardize = TRUE)
plot(tcs2f_forty_lasso.mod)

set.seed(1)
tcs2f_forty_cv.out <- cv.glmnet(tcs2f_forty_x[tcs2f_forty_train, ], tcs2f_forty_y[tcs2f_forty_train], alpha = 1)
#plot(tcs2f_forty_cv.out)
tcs2f_forty_bestlam <- tcs2f_forty_cv.out$lambda.min
#tcs2f_forty_bestlam <- 1
tcs2f_forty_lasso.pred <- predict(tcs2f_forty_lasso.mod, s = tcs2f_forty_bestlam,
    newx = tcs2f_forty_x[tcs2f_forty_test, ])
mean((tcs2f_forty_lasso.pred - tcs2f_forty_y.test)^2)

tcs2f_forty_out <- glmnet(tcs2f_forty_x, tcs2f_forty_y, alpha = 1, lambda = tcs2f_forty_bestlam )
coef(tcs2f_forty_out)
tcs2f_forty_lasso.coef <- predict(tcs2f_forty_out, type = "coefficients",
    s = tcs2f_forty_bestlam)[1:(ncol(three_cone_2_forty)+2), ]
tcs2f_forty_lasso.coef
tcs2f_forty_lasso.coef[tcs2f_forty_lasso.coef != 0]

ggplot(three_cone_shuttle_2_forty[-tcs2f_forty_train,] %>% mutate(pred = tcs2f_forty_lasso.pred),
       aes(x = pred, forty)) +
  geom_point()



tcs2f_forty_x_scale <- model.matrix(scale(forty) ~ scale(three_cone) + scale(shuttle), three_cone_shuttle_2_forty)
tcs2f_forty_y_scale <- (three_cone_shuttle_2_forty %>% mutate(forty = scale(forty)))$forty

set.seed(2)
tcs2f_forty_train <- sample(1:nrow(tcs2f_forty_x_scale), .8*nrow(tcs2f_forty_x_scale))
tcs2f_forty_test <- (-tcs2f_forty_train)
tcs2f_forty_y.test_scale <- tcs2f_forty_y_scale[tcs2f_forty_test]

tcs2f_forty_lasso.mod_scale <- glmnet(tcs2f_forty_x_scale[tcs2f_forty_train, ], tcs2f_forty_y_scale[tcs2f_forty_train], alpha = 1,
    lambda = grid,intercept = TRUE ,standardize = TRUE)

set.seed(1)
tcs2f_forty_cv.out_scale <- cv.glmnet(tcs2f_forty_x_scale[tcs2f_forty_train, ], tcs2f_forty_y_scale[tcs2f_forty_train], alpha = 1)
#plot(tcs2f_forty_cv.out)
tcs2f_forty_bestlam_scale <- tcs2f_forty_cv.out_scale$lambda.min
#tcs2f_forty_bestlam <- 1
tcs2f_forty_lasso.pred_scale <- predict(tcs2f_forty_lasso.mod_scale, s = tcs2f_forty_bestlam_scale,
    newx = tcs2f_forty_x_scale[tcs2f_forty_test, ])
mean((tcs2f_forty_lasso.pred_scale - tcs2f_forty_y.test_scale)^2)
```

```{r}
three_cone_shuttle_2_vertical <- combinecollege %>% select(-player, -broad_jump, -forty) %>% 
  filter(!is.na(three_cone) & !is.na(shuttle) & !is.na(vertical))


tcs2v_vertical_x <- model.matrix(vertical ~ ., three_cone_shuttle_2_vertical)
tcs2v_vertical_y <- three_cone_shuttle_2_vertical$vertical
tcs2v_vertical_x 
mean(tcs2v_vertical_y)

set.seed(2)
tcs2v_vertical_train <- sample(1:nrow(tcs2v_vertical_x), .8*nrow(tcs2v_vertical_x))
tcs2v_vertical_test <- (-tcs2v_vertical_train)
tcs2v_vertical_y.test <- tcs2v_vertical_y[tcs2v_vertical_test]

grid <- 10^seq(-5, 5, length = 100)

tcs2v_vertical_lasso.mod <- glmnet(tcs2v_vertical_x[tcs2v_vertical_train, ], tcs2v_vertical_y[tcs2v_vertical_train], alpha = 1,
    lambda = grid,intercept = TRUE ,standardize = TRUE)
plot(tcs2v_vertical_lasso.mod)

set.seed(1)
tcs2v_vertical_cv.out <- cv.glmnet(tcs2v_vertical_x[tcs2v_vertical_train, ], tcs2v_vertical_y[tcs2v_vertical_train], alpha = 1)
#plot(tcs2v_vertical_cv.out)
tcs2v_vertical_bestlam <- tcs2v_vertical_cv.out$lambda.min
#tcs2v_vertical_bestlam <- 1
tcs2v_vertical_lasso.pred <- predict(tcs2v_vertical_lasso.mod, s = tcs2v_vertical_bestlam,
    newx = tcs2v_vertical_x[tcs2v_vertical_test, ])
mean((tcs2v_vertical_lasso.pred - tcs2v_vertical_y.test)^2)

tcs2v_vertical_out <- glmnet(tcs2v_vertical_x, tcs2v_vertical_y, alpha = 1, lambda = tcs2v_vertical_bestlam )
coef(tcs2v_vertical_out)
tcs2v_vertical_lasso.coef <- predict(tcs2v_vertical_out, type = "coefficients",
    s = tcs2v_vertical_bestlam)[1:(ncol(three_cone_2_vertical)+2), ]
tcs2v_vertical_lasso.coef
tcs2v_vertical_lasso.coef[tcs2v_vertical_lasso.coef != 0]

ggplot(three_cone_shuttle_2_vertical[-tcs2v_vertical_train,] %>% mutate(pred = tcs2v_vertical_lasso.pred),
       aes(x = pred, vertical)) +
  geom_point()



tcs2v_vertical_x_scale <- model.matrix(scale(vertical) ~ scale(three_cone) + scale(shuttle), three_cone_shuttle_2_vertical)
tcs2v_vertical_y_scale <- (three_cone_shuttle_2_vertical %>% mutate(vertical = scale(vertical)))$vertical

set.seed(2)
tcs2v_vertical_train <- sample(1:nrow(tcs2v_vertical_x_scale), .8*nrow(tcs2v_vertical_x_scale))
tcs2v_vertical_test <- (-tcs2v_vertical_train)
tcs2v_vertical_y.test_scale <- tcs2v_vertical_y_scale[tcs2v_vertical_test]

tcs2v_vertical_lasso.mod_scale <- glmnet(tcs2v_vertical_x_scale[tcs2v_vertical_train, ], tcs2v_vertical_y_scale[tcs2v_vertical_train], alpha = 1,
    lambda = grid,intercept = TRUE ,standardize = TRUE)

set.seed(1)
tcs2v_vertical_cv.out_scale <- cv.glmnet(tcs2v_vertical_x_scale[tcs2v_vertical_train, ], tcs2v_vertical_y_scale[tcs2v_vertical_train], alpha = 1)
#plot(tcs2v_vertical_cv.out)
tcs2v_vertical_bestlam_scale <- tcs2v_vertical_cv.out_scale$lambda.min
#tcs2v_vertical_bestlam <- 1
tcs2v_vertical_lasso.pred_scale <- predict(tcs2v_vertical_lasso.mod_scale, s = tcs2v_vertical_bestlam_scale,
    newx = tcs2v_vertical_x_scale[tcs2v_vertical_test, ])
mean((tcs2v_vertical_lasso.pred_scale - tcs2v_vertical_y.test_scale)^2)
```

```{r}
three_cone_shuttle_2_broad_jump <- combinecollege %>% select(-player, -forty, -vertical) %>% 
  filter(!is.na(three_cone) & !is.na(shuttle) & !is.na(broad_jump))


tcs2bj_broad_jump_x <- model.matrix(broad_jump ~ ., three_cone_shuttle_2_broad_jump)
tcs2bj_broad_jump_y <- three_cone_shuttle_2_broad_jump$broad_jump
tcs2bj_broad_jump_x 
mean(tcs2bj_broad_jump_y)

set.seed(2)
tcs2bj_broad_jump_train <- sample(1:nrow(tcs2bj_broad_jump_x), .8*nrow(tcs2bj_broad_jump_x))
tcs2bj_broad_jump_test <- (-tcs2bj_broad_jump_train)
tcs2bj_broad_jump_y.test <- tcs2bj_broad_jump_y[tcs2bj_broad_jump_test]

grid <- 10^seq(-5, 5, length = 100)

tcs2bj_broad_jump_lasso.mod <- glmnet(tcs2bj_broad_jump_x[tcs2bj_broad_jump_train, ], tcs2bj_broad_jump_y[tcs2bj_broad_jump_train], alpha = 1,
    lambda = grid,intercept = TRUE ,standardize = TRUE)
plot(tcs2bj_broad_jump_lasso.mod)

set.seed(1)
tcs2bj_broad_jump_cv.out <- cv.glmnet(tcs2bj_broad_jump_x[tcs2bj_broad_jump_train, ], tcs2bj_broad_jump_y[tcs2bj_broad_jump_train], alpha = 1)
#plot(tcs2bj_broad_jump_cv.out)
tcs2bj_broad_jump_bestlam <- tcs2bj_broad_jump_cv.out$lambda.min
#tcs2bj_broad_jump_bestlam <- 1
tcs2bj_broad_jump_lasso.pred <- predict(tcs2bj_broad_jump_lasso.mod, s = tcs2bj_broad_jump_bestlam,
    newx = tcs2bj_broad_jump_x[tcs2bj_broad_jump_test, ])
mean((tcs2bj_broad_jump_lasso.pred - tcs2bj_broad_jump_y.test)^2)

tcs2bj_broad_jump_out <- glmnet(tcs2bj_broad_jump_x, tcs2bj_broad_jump_y, alpha = 1, lambda = tcs2bj_broad_jump_bestlam )
coef(tcs2bj_broad_jump_out)
tcs2bj_broad_jump_lasso.coef <- predict(tcs2bj_broad_jump_out, type = "coefficients",
    s = tcs2bj_broad_jump_bestlam)[1:(ncol(three_cone_2_broad_jump)+2), ]
tcs2bj_broad_jump_lasso.coef
tcs2bj_broad_jump_lasso.coef[tcs2bj_broad_jump_lasso.coef != 0]

ggplot(three_cone_shuttle_2_broad_jump[-tcs2bj_broad_jump_train,] %>% mutate(pred = tcs2bj_broad_jump_lasso.pred),
       aes(x = pred, broad_jump)) +
  geom_point()



tcs2bj_broad_jump_x_scale <- model.matrix(scale(broad_jump) ~ scale(three_cone) + scale(shuttle), three_cone_shuttle_2_broad_jump)
tcs2bj_broad_jump_y_scale <- (three_cone_shuttle_2_broad_jump %>% mutate(broad_jump = scale(broad_jump)))$broad_jump

set.seed(2)
tcs2bj_broad_jump_train <- sample(1:nrow(tcs2bj_broad_jump_x_scale), .8*nrow(tcs2bj_broad_jump_x_scale))
tcs2bj_broad_jump_test <- (-tcs2bj_broad_jump_train)
tcs2bj_broad_jump_y.test_scale <- tcs2bj_broad_jump_y_scale[tcs2bj_broad_jump_test]

tcs2bj_broad_jump_lasso.mod_scale <- glmnet(tcs2bj_broad_jump_x_scale[tcs2bj_broad_jump_train, ], tcs2bj_broad_jump_y_scale[tcs2bj_broad_jump_train], alpha = 1,
    lambda = grid,intercept = TRUE ,standardize = TRUE)

set.seed(1)
tcs2bj_broad_jump_cv.out_scale <- cv.glmnet(tcs2bj_broad_jump_x_scale[tcs2bj_broad_jump_train, ], tcs2bj_broad_jump_y_scale[tcs2bj_broad_jump_train], alpha = 1)
#plot(tcs2bj_broad_jump_cv.out)
tcs2bj_broad_jump_bestlam_scale <- tcs2bj_broad_jump_cv.out_scale$lambda.min
#tcs2bj_broad_jump_bestlam <- 1
tcs2bj_broad_jump_lasso.pred_scale <- predict(tcs2bj_broad_jump_lasso.mod_scale, s = tcs2bj_broad_jump_bestlam_scale,
    newx = tcs2bj_broad_jump_x_scale[tcs2bj_broad_jump_test, ])
mean((tcs2bj_broad_jump_lasso.pred_scale - tcs2bj_broad_jump_y.test_scale)^2)
```

# If player only has three cone and shuttle predict broad jump
```{r}
update8 <- update7 %>% mutate(broad_jump = if_else(
                           is.na(forty) & is.na(vertical) & is.na(broad_jump) & !is.na(three_cone) & !is.na(shuttle),
                           tcs2bj_broad_jump_lasso.coef[tcs2bj_broad_jump_lasso.coef != 0][1] +
                             tcs2bj_broad_jump_lasso.coef[tcs2bj_broad_jump_lasso.coef != 0][2] * height +
                             tcs2bj_broad_jump_lasso.coef[tcs2bj_broad_jump_lasso.coef != 0][3] * weight +
                             tcs2bj_broad_jump_lasso.coef[tcs2bj_broad_jump_lasso.coef != 0][4] * three_cone +
                             tcs2bj_broad_jump_lasso.coef[tcs2bj_broad_jump_lasso.coef != 0][5] * G +
                             tcs2bj_broad_jump_lasso.coef[tcs2bj_broad_jump_lasso.coef != 0][6] * Rec +
                             tcs2bj_broad_jump_lasso.coef[tcs2bj_broad_jump_lasso.coef != 0][7] * RushYds +
                             tcs2bj_broad_jump_lasso.coef[tcs2bj_broad_jump_lasso.coef != 0][8] * TotAvg + 
                             tcs2bj_broad_jump_lasso.coef[tcs2bj_broad_jump_lasso.coef != 0][9] * TotTD,
                           broad_jump
                         )) 
```

# Use forty, vertical and three cone to predict
```{r}
forty_three_cone_vertical_2_broad_jump <- combinecollege %>% select(-player, -shuttle) %>% 
  filter(!is.na(forty) & !is.na(three_cone) & !is.na(vertical) & !is.na(broad_jump))


f3cv2bj_broad_jump_x <- model.matrix(broad_jump ~ ., forty_three_cone_vertical_2_broad_jump)
f3cv2bj_broad_jump_y <- forty_three_cone_vertical_2_broad_jump$broad_jump
f3cv2bj_broad_jump_x 
mean(f3cv2bj_broad_jump_y)

set.seed(2)
f3cv2bj_broad_jump_train <- sample(1:nrow(f3cv2bj_broad_jump_x), .8*nrow(f3cv2bj_broad_jump_x))
f3cv2bj_broad_jump_test <- (-f3cv2bj_broad_jump_train)
f3cv2bj_broad_jump_y.test <- f3cv2bj_broad_jump_y[f3cv2bj_broad_jump_test]

grid <- 10^seq(-5, 5, length = 100)

f3cv2bj_broad_jump_lasso.mod <- glmnet(f3cv2bj_broad_jump_x[f3cv2bj_broad_jump_train, ], f3cv2bj_broad_jump_y[f3cv2bj_broad_jump_train], alpha = 1,
    lambda = grid,intercept = TRUE ,standardize = TRUE)
plot(f3cv2bj_broad_jump_lasso.mod)

set.seed(1)
f3cv2bj_broad_jump_cv.out <- cv.glmnet(f3cv2bj_broad_jump_x[f3cv2bj_broad_jump_train, ], f3cv2bj_broad_jump_y[f3cv2bj_broad_jump_train], alpha = 1)
#plot(f3cv2bj_broad_jump_cv.out)
f3cv2bj_broad_jump_bestlam <- f3cv2bj_broad_jump_cv.out$lambda.min
#f3cv2bj_broad_jump_bestlam <- 1
f3cv2bj_broad_jump_lasso.pred <- predict(f3cv2bj_broad_jump_lasso.mod, s = f3cv2bj_broad_jump_bestlam,
    newx = f3cv2bj_broad_jump_x[f3cv2bj_broad_jump_test, ])
mean((f3cv2bj_broad_jump_lasso.pred - f3cv2bj_broad_jump_y.test)^2)

f3cv2bj_broad_jump_out <- glmnet(f3cv2bj_broad_jump_x, f3cv2bj_broad_jump_y, alpha = 1, lambda = f3cv2bj_broad_jump_bestlam )
coef(f3cv2bj_broad_jump_out)
f3cv2bj_broad_jump_lasso.coef <- predict(f3cv2bj_broad_jump_out, type = "coefficients",
    s = f3cv2bj_broad_jump_bestlam)[1:(ncol(forty_three_cone_vertical_2_broad_jump)+1), ]
f3cv2bj_broad_jump_lasso.coef
f3cv2bj_broad_jump_lasso.coef[f3cv2bj_broad_jump_lasso.coef != 0]

ggplot(forty_three_cone_vertical_2_broad_jump[-f3cv2bj_broad_jump_train,] %>% mutate(pred = f3cv2bj_broad_jump_lasso.pred),
       aes(x = pred, broad_jump)) +
  geom_point()



f3cv2bj_broad_jump_x_scale <- model.matrix(scale(broad_jump) ~ scale(three_cone) + scale(vertical), forty_three_cone_vertical_2_broad_jump)
f3cv2bj_broad_jump_y_scale <- (forty_three_cone_vertical_2_broad_jump %>% mutate(broad_jump = scale(broad_jump)))$broad_jump

set.seed(2)
f3cv2bj_broad_jump_train <- sample(1:nrow(f3cv2bj_broad_jump_x_scale), .8*nrow(f3cv2bj_broad_jump_x_scale))
f3cv2bj_broad_jump_test <- (-f3cv2bj_broad_jump_train)
f3cv2bj_broad_jump_y.test_scale <- f3cv2bj_broad_jump_y_scale[f3cv2bj_broad_jump_test]

f3cv2bj_broad_jump_lasso.mod_scale <- glmnet(f3cv2bj_broad_jump_x_scale[f3cv2bj_broad_jump_train, ], f3cv2bj_broad_jump_y_scale[f3cv2bj_broad_jump_train], alpha = 1,
    lambda = grid,intercept = TRUE ,standardize = TRUE)

set.seed(1)
f3cv2bj_broad_jump_cv.out_scale <- cv.glmnet(f3cv2bj_broad_jump_x_scale[f3cv2bj_broad_jump_train, ], f3cv2bj_broad_jump_y_scale[f3cv2bj_broad_jump_train], alpha = 1)
#plot(f3cv2bj_broad_jump_cv.out)
f3cv2bj_broad_jump_bestlam_scale <- f3cv2bj_broad_jump_cv.out_scale$lambda.min
#f3cv2bj_broad_jump_bestlam <- 1
f3cv2bj_broad_jump_lasso.pred_scale <- predict(f3cv2bj_broad_jump_lasso.mod_scale, s = f3cv2bj_broad_jump_bestlam_scale,
    newx = f3cv2bj_broad_jump_x_scale[f3cv2bj_broad_jump_test, ])
mean((f3cv2bj_broad_jump_lasso.pred_scale - f3cv2bj_broad_jump_y.test_scale)^2)
```


```{r}
forty_three_cone_vertical_2_shuttle <- combinecollege %>% select(-player, -broad_jump) %>% 
  filter(!is.na(forty) & !is.na(three_cone) & !is.na(vertical) & !is.na(shuttle))


f3cv2s_shuttle_x <- model.matrix(shuttle ~ ., forty_three_cone_vertical_2_shuttle)
f3cv2s_shuttle_y <- forty_three_cone_vertical_2_shuttle$shuttle
f3cv2s_shuttle_x 
mean(f3cv2s_shuttle_y)

set.seed(2)
f3cv2s_shuttle_train <- sample(1:nrow(f3cv2s_shuttle_x), .8*nrow(f3cv2s_shuttle_x))
f3cv2s_shuttle_test <- (-f3cv2s_shuttle_train)
f3cv2s_shuttle_y.test <- f3cv2s_shuttle_y[f3cv2s_shuttle_test]

grid <- 10^seq(-5, 5, length = 100)

f3cv2s_shuttle_lasso.mod <- glmnet(f3cv2s_shuttle_x[f3cv2s_shuttle_train, ], f3cv2s_shuttle_y[f3cv2s_shuttle_train], alpha = 1,
    lambda = grid,intercept = TRUE ,standardize = TRUE)
plot(f3cv2s_shuttle_lasso.mod)

set.seed(1)
f3cv2s_shuttle_cv.out <- cv.glmnet(f3cv2s_shuttle_x[f3cv2s_shuttle_train, ], f3cv2s_shuttle_y[f3cv2s_shuttle_train], alpha = 1)
#plot(f3cv2s_shuttle_cv.out)
f3cv2s_shuttle_bestlam <- f3cv2s_shuttle_cv.out$lambda.min
#f3cv2s_shuttle_bestlam <- 1
f3cv2s_shuttle_lasso.pred <- predict(f3cv2s_shuttle_lasso.mod, s = f3cv2s_shuttle_bestlam,
    newx = f3cv2s_shuttle_x[f3cv2s_shuttle_test, ])
mean((f3cv2s_shuttle_lasso.pred - f3cv2s_shuttle_y.test)^2)

f3cv2s_shuttle_out <- glmnet(f3cv2s_shuttle_x, f3cv2s_shuttle_y, alpha = 1, lambda = f3cv2s_shuttle_bestlam )
coef(f3cv2s_shuttle_out)
f3cv2s_shuttle_lasso.coef <- predict(f3cv2s_shuttle_out, type = "coefficients",
    s = f3cv2s_shuttle_bestlam)[1:(ncol(forty_three_cone_vertical_2_shuttle)+1), ]
f3cv2s_shuttle_lasso.coef
f3cv2s_shuttle_lasso.coef[f3cv2s_shuttle_lasso.coef != 0]

ggplot(forty_three_cone_vertical_2_shuttle[-f3cv2s_shuttle_train,] %>% mutate(pred = f3cv2s_shuttle_lasso.pred),
       aes(x = pred, shuttle)) +
  geom_point()



f3cv2s_shuttle_x_scale <- model.matrix(scale(shuttle) ~ scale(three_cone) + scale(vertical), forty_three_cone_vertical_2_shuttle)
f3cv2s_shuttle_y_scale <- (forty_three_cone_vertical_2_shuttle %>% mutate(shuttle = scale(shuttle)))$shuttle

set.seed(2)
f3cv2s_shuttle_train <- sample(1:nrow(f3cv2s_shuttle_x_scale), .8*nrow(f3cv2s_shuttle_x_scale))
f3cv2s_shuttle_test <- (-f3cv2s_shuttle_train)
f3cv2s_shuttle_y.test_scale <- f3cv2s_shuttle_y_scale[f3cv2s_shuttle_test]

f3cv2s_shuttle_lasso.mod_scale <- glmnet(f3cv2s_shuttle_x_scale[f3cv2s_shuttle_train, ], f3cv2s_shuttle_y_scale[f3cv2s_shuttle_train], alpha = 1,
    lambda = grid,intercept = TRUE ,standardize = TRUE)

set.seed(1)
f3cv2s_shuttle_cv.out_scale <- cv.glmnet(f3cv2s_shuttle_x_scale[f3cv2s_shuttle_train, ], f3cv2s_shuttle_y_scale[f3cv2s_shuttle_train], alpha = 1)
#plot(f3cv2s_shuttle_cv.out)
f3cv2s_shuttle_bestlam_scale <- f3cv2s_shuttle_cv.out_scale$lambda.min
#f3cv2s_shuttle_bestlam <- 1
f3cv2s_shuttle_lasso.pred_scale <- predict(f3cv2s_shuttle_lasso.mod_scale, s = f3cv2s_shuttle_bestlam_scale,
    newx = f3cv2s_shuttle_x_scale[f3cv2s_shuttle_test, ])
mean((f3cv2s_shuttle_lasso.pred_scale - f3cv2s_shuttle_y.test_scale)^2)
```

# If player only has forty, vertical and three cone predict broad jump
```{r}
update9 <- update8 %>% mutate(shuttle = if_else(
                           !is.na(forty) & !is.na(vertical) & is.na(broad_jump) & !is.na(three_cone) & is.na(shuttle),
                           f3cv2s_shuttle_lasso.coef[f3cv2s_shuttle_lasso.coef != 0][1] +
                             f3cv2s_shuttle_lasso.coef[f3cv2s_shuttle_lasso.coef != 0][2] * weight +
                             f3cv2s_shuttle_lasso.coef[f3cv2s_shuttle_lasso.coef != 0][3] * vertical +
                             f3cv2s_shuttle_lasso.coef[f3cv2s_shuttle_lasso.coef != 0][4] * three_cone + 
                             f3cv2s_shuttle_lasso.coef[f3cv2s_shuttle_lasso.coef != 0][5] * G +
                             f3cv2s_shuttle_lasso.coef[f3cv2s_shuttle_lasso.coef != 0][6] * Rec +
                             f3cv2s_shuttle_lasso.coef[f3cv2s_shuttle_lasso.coef != 0][7] * RecAvg +
                             f3cv2s_shuttle_lasso.coef[f3cv2s_shuttle_lasso.coef != 0][8] * TotTD +
                             f3cv2s_shuttle_lasso.coef[f3cv2s_shuttle_lasso.coef != 0][9] * as.numeric(ConfIndicator),
                           shuttle
                         )) 
```

# Use forty, vertical, broad jump to predict
```{r}
forty_broad_jump_vertical_2_three_cone <- combinecollege %>% select(-player, -shuttle) %>% 
  filter(!is.na(forty) & !is.na(broad_jump) & !is.na(vertical) & !is.na(three_cone))


fbjv23c_three_cone_x <- model.matrix(three_cone ~ ., forty_broad_jump_vertical_2_three_cone)
fbjv23c_three_cone_y <- forty_broad_jump_vertical_2_three_cone$three_cone
fbjv23c_three_cone_x 
mean(fbjv23c_three_cone_y)

set.seed(2)
fbjv23c_three_cone_train <- sample(1:nrow(fbjv23c_three_cone_x), .8*nrow(fbjv23c_three_cone_x))
fbjv23c_three_cone_test <- (-fbjv23c_three_cone_train)
fbjv23c_three_cone_y.test <- fbjv23c_three_cone_y[fbjv23c_three_cone_test]

grid <- 10^seq(-5, 5, length = 100)

fbjv23c_three_cone_lasso.mod <- glmnet(fbjv23c_three_cone_x[fbjv23c_three_cone_train, ], fbjv23c_three_cone_y[fbjv23c_three_cone_train], alpha = 1,
    lambda = grid,intercept = TRUE ,standardize = TRUE)
plot(fbjv23c_three_cone_lasso.mod)

set.seed(1)
fbjv23c_three_cone_cv.out <- cv.glmnet(fbjv23c_three_cone_x[fbjv23c_three_cone_train, ], fbjv23c_three_cone_y[fbjv23c_three_cone_train], alpha = 1)
#plot(fbjv23c_three_cone_cv.out)
fbjv23c_three_cone_bestlam <- fbjv23c_three_cone_cv.out$lambda.min
#fbjv23c_three_cone_bestlam <- 1
fbjv23c_three_cone_lasso.pred <- predict(fbjv23c_three_cone_lasso.mod, s = fbjv23c_three_cone_bestlam,
    newx = fbjv23c_three_cone_x[fbjv23c_three_cone_test, ])
mean((fbjv23c_three_cone_lasso.pred - fbjv23c_three_cone_y.test)^2)

fbjv23c_three_cone_out <- glmnet(fbjv23c_three_cone_x, fbjv23c_three_cone_y, alpha = 1, lambda = fbjv23c_three_cone_bestlam )
coef(fbjv23c_three_cone_out)
fbjv23c_three_cone_lasso.coef <- predict(fbjv23c_three_cone_out, type = "coefficients",
    s = fbjv23c_three_cone_bestlam)[1:(ncol(forty_broad_jump_vertical_2_three_cone)+1), ]
fbjv23c_three_cone_lasso.coef
fbjv23c_three_cone_lasso.coef[fbjv23c_three_cone_lasso.coef != 0]

ggplot(forty_broad_jump_vertical_2_three_cone[-fbjv23c_three_cone_train,] %>% mutate(pred = fbjv23c_three_cone_lasso.pred),
       aes(x = pred, three_cone)) +
  geom_point()



fbjv23c_three_cone_x_scale <- model.matrix(scale(three_cone) ~ scale(broad_jump) + scale(vertical), forty_broad_jump_vertical_2_three_cone)
fbjv23c_three_cone_y_scale <- (forty_broad_jump_vertical_2_three_cone %>% mutate(three_cone = scale(three_cone)))$three_cone

set.seed(2)
fbjv23c_three_cone_train <- sample(1:nrow(fbjv23c_three_cone_x_scale), .8*nrow(fbjv23c_three_cone_x_scale))
fbjv23c_three_cone_test <- (-fbjv23c_three_cone_train)
fbjv23c_three_cone_y.test_scale <- fbjv23c_three_cone_y_scale[fbjv23c_three_cone_test]

fbjv23c_three_cone_lasso.mod_scale <- glmnet(fbjv23c_three_cone_x_scale[fbjv23c_three_cone_train, ], fbjv23c_three_cone_y_scale[fbjv23c_three_cone_train], alpha = 1,
    lambda = grid,intercept = TRUE ,standardize = TRUE)

set.seed(1)
fbjv23c_three_cone_cv.out_scale <- cv.glmnet(fbjv23c_three_cone_x_scale[fbjv23c_three_cone_train, ], fbjv23c_three_cone_y_scale[fbjv23c_three_cone_train], alpha = 1)
#plot(fbjv23c_three_cone_cv.out)
fbjv23c_three_cone_bestlam_scale <- fbjv23c_three_cone_cv.out_scale$lambda.min
#fbjv23c_three_cone_bestlam <- 1
fbjv23c_three_cone_lasso.pred_scale <- predict(fbjv23c_three_cone_lasso.mod_scale, s = fbjv23c_three_cone_bestlam_scale,
    newx = fbjv23c_three_cone_x_scale[fbjv23c_three_cone_test, ])
mean((fbjv23c_three_cone_lasso.pred_scale - fbjv23c_three_cone_y.test_scale)^2)
```

```{r}
forty_broad_jump_vertical_2_shuttle <- combinecollege %>% select(-player, -three_cone) %>% 
  filter(!is.na(forty) & !is.na(broad_jump) & !is.na(vertical) & !is.na(shuttle))


fbjv2s_shuttle_x <- model.matrix(shuttle ~ ., forty_broad_jump_vertical_2_shuttle)
fbjv2s_shuttle_y <- forty_broad_jump_vertical_2_shuttle$shuttle
fbjv2s_shuttle_x 
mean(fbjv2s_shuttle_y)

set.seed(2)
fbjv2s_shuttle_train <- sample(1:nrow(fbjv2s_shuttle_x), .8*nrow(fbjv2s_shuttle_x))
fbjv2s_shuttle_test <- (-fbjv2s_shuttle_train)
fbjv2s_shuttle_y.test <- fbjv2s_shuttle_y[fbjv2s_shuttle_test]

grid <- 10^seq(-5, 5, length = 100)

fbjv2s_shuttle_lasso.mod <- glmnet(fbjv2s_shuttle_x[fbjv2s_shuttle_train, ], fbjv2s_shuttle_y[fbjv2s_shuttle_train], alpha = 1,
    lambda = grid,intercept = TRUE ,standardize = TRUE)
plot(fbjv2s_shuttle_lasso.mod)

set.seed(1)
fbjv2s_shuttle_cv.out <- cv.glmnet(fbjv2s_shuttle_x[fbjv2s_shuttle_train, ], fbjv2s_shuttle_y[fbjv2s_shuttle_train], alpha = 1)
#plot(fbjv2s_shuttle_cv.out)
fbjv2s_shuttle_bestlam <- fbjv2s_shuttle_cv.out$lambda.min
#fbjv2s_shuttle_bestlam <- 1
fbjv2s_shuttle_lasso.pred <- predict(fbjv2s_shuttle_lasso.mod, s = fbjv2s_shuttle_bestlam,
    newx = fbjv2s_shuttle_x[fbjv2s_shuttle_test, ])
mean((fbjv2s_shuttle_lasso.pred - fbjv2s_shuttle_y.test)^2)

fbjv2s_shuttle_out <- glmnet(fbjv2s_shuttle_x, fbjv2s_shuttle_y, alpha = 1, lambda = fbjv2s_shuttle_bestlam )
coef(fbjv2s_shuttle_out)
fbjv2s_shuttle_lasso.coef <- predict(fbjv2s_shuttle_out, type = "coefficients",
    s = fbjv2s_shuttle_bestlam)[1:(ncol(forty_broad_jump_vertical_2_shuttle)+1), ]
fbjv2s_shuttle_lasso.coef
fbjv2s_shuttle_lasso.coef[fbjv2s_shuttle_lasso.coef != 0]

ggplot(forty_broad_jump_vertical_2_shuttle[-fbjv2s_shuttle_train,] %>% mutate(pred = fbjv2s_shuttle_lasso.pred),
       aes(x = pred, shuttle)) +
  geom_point()



fbjv2s_shuttle_x_scale <- model.matrix(scale(shuttle) ~ scale(broad_jump) + scale(vertical), forty_broad_jump_vertical_2_shuttle)
fbjv2s_shuttle_y_scale <- (forty_broad_jump_vertical_2_shuttle %>% mutate(shuttle = scale(shuttle)))$shuttle

set.seed(2)
fbjv2s_shuttle_train <- sample(1:nrow(fbjv2s_shuttle_x_scale), .8*nrow(fbjv2s_shuttle_x_scale))
fbjv2s_shuttle_test <- (-fbjv2s_shuttle_train)
fbjv2s_shuttle_y.test_scale <- fbjv2s_shuttle_y_scale[fbjv2s_shuttle_test]

fbjv2s_shuttle_lasso.mod_scale <- glmnet(fbjv2s_shuttle_x_scale[fbjv2s_shuttle_train, ], fbjv2s_shuttle_y_scale[fbjv2s_shuttle_train], alpha = 1,
    lambda = grid,intercept = TRUE ,standardize = TRUE)

set.seed(1)
fbjv2s_shuttle_cv.out_scale <- cv.glmnet(fbjv2s_shuttle_x_scale[fbjv2s_shuttle_train, ], fbjv2s_shuttle_y_scale[fbjv2s_shuttle_train], alpha = 1)
#plot(fbjv2s_shuttle_cv.out)
fbjv2s_shuttle_bestlam_scale <- fbjv2s_shuttle_cv.out_scale$lambda.min
#fbjv2s_shuttle_bestlam <- 1
fbjv2s_shuttle_lasso.pred_scale <- predict(fbjv2s_shuttle_lasso.mod_scale, s = fbjv2s_shuttle_bestlam_scale,
    newx = fbjv2s_shuttle_x_scale[fbjv2s_shuttle_test, ])
mean((fbjv2s_shuttle_lasso.pred_scale - fbjv2s_shuttle_y.test_scale)^2)
```

# If player only has forty, broad jump and vertical predict shuttle
```{r}
update10 <- update9 %>% mutate(three_cone = if_else(
                           !is.na(forty) & !is.na(vertical) & !is.na(broad_jump) & is.na(three_cone) & is.na(shuttle),
                           fbjv23c_three_cone_lasso.coef[fbjv23c_three_cone_lasso.coef != 0][1] +
                             fbjv23c_three_cone_lasso.coef[fbjv23c_three_cone_lasso.coef != 0][2] * weight +
                             fbjv23c_three_cone_lasso.coef[fbjv23c_three_cone_lasso.coef != 0][3] * forty +
                             fbjv23c_three_cone_lasso.coef[fbjv23c_three_cone_lasso.coef != 0][4] * vertical +
                             fbjv23c_three_cone_lasso.coef[fbjv23c_three_cone_lasso.coef != 0][5] * G +
                             fbjv23c_three_cone_lasso.coef[fbjv23c_three_cone_lasso.coef != 0][6] * Rec +
                             fbjv23c_three_cone_lasso.coef[fbjv23c_three_cone_lasso.coef != 0][7] * RecTD +
                             fbjv23c_three_cone_lasso.coef[fbjv23c_three_cone_lasso.coef != 0][8] * RushAtt +
                             fbjv23c_three_cone_lasso.coef[fbjv23c_three_cone_lasso.coef != 0][9] * as.numeric(ConfIndicator),
                           three_cone
                         )) 
```

# Use forty, three cone, and shuttle to predict
```{r}
forty_three_cone_shuttle_2_vertical <- combinecollege %>% select(-player, -broad_jump) %>% 
  filter(!is.na(forty) & !is.na(three_cone) & !is.na(shuttle) & !is.na(vertical))


f3cs2v_vertical_x <- model.matrix(vertical ~ ., forty_three_cone_shuttle_2_vertical)
f3cs2v_vertical_y <- forty_three_cone_shuttle_2_vertical$vertical
f3cs2v_vertical_x 
mean(f3cs2v_vertical_y)

set.seed(2)
f3cs2v_vertical_train <- sample(1:nrow(f3cs2v_vertical_x), .8*nrow(f3cs2v_vertical_x))
f3cs2v_vertical_test <- (-f3cs2v_vertical_train)
f3cs2v_vertical_y.test <- f3cs2v_vertical_y[f3cs2v_vertical_test]

grid <- 10^seq(-5, 5, length = 100)

f3cs2v_vertical_lasso.mod <- glmnet(f3cs2v_vertical_x[f3cs2v_vertical_train, ], f3cs2v_vertical_y[f3cs2v_vertical_train], alpha = 1,
    lambda = grid,intercept = TRUE ,standardize = TRUE)
plot(f3cs2v_vertical_lasso.mod)

set.seed(1)
f3cs2v_vertical_cv.out <- cv.glmnet(f3cs2v_vertical_x[f3cs2v_vertical_train, ], f3cs2v_vertical_y[f3cs2v_vertical_train], alpha = 1)
#plot(f3cs2v_vertical_cv.out)
f3cs2v_vertical_bestlam <- f3cs2v_vertical_cv.out$lambda.min
#f3cs2v_vertical_bestlam <- 1
f3cs2v_vertical_lasso.pred <- predict(f3cs2v_vertical_lasso.mod, s = f3cs2v_vertical_bestlam,
    newx = f3cs2v_vertical_x[f3cs2v_vertical_test, ])
mean((f3cs2v_vertical_lasso.pred - f3cs2v_vertical_y.test)^2)

f3cs2v_vertical_out <- glmnet(f3cs2v_vertical_x, f3cs2v_vertical_y, alpha = 1, lambda = f3cs2v_vertical_bestlam )
coef(f3cs2v_vertical_out)
f3cs2v_vertical_lasso.coef <- predict(f3cs2v_vertical_out, type = "coefficients",
    s = f3cs2v_vertical_bestlam)[1:(ncol(forty_three_cone_shuttle_2_vertical)+1), ]
f3cs2v_vertical_lasso.coef
f3cs2v_vertical_lasso.coef[f3cs2v_vertical_lasso.coef != 0]

ggplot(forty_three_cone_shuttle_2_vertical[-f3cs2v_vertical_train,] %>% mutate(pred = f3cs2v_vertical_lasso.pred),
       aes(x = pred, vertical)) +
  geom_point()



f3cs2v_vertical_x_scale <- model.matrix(scale(vertical) ~ scale(three_cone) + scale(shuttle), forty_three_cone_shuttle_2_vertical)
f3cs2v_vertical_y_scale <- (forty_three_cone_shuttle_2_vertical %>% mutate(vertical = scale(vertical)))$vertical

set.seed(2)
f3cs2v_vertical_train <- sample(1:nrow(f3cs2v_vertical_x_scale), .8*nrow(f3cs2v_vertical_x_scale))
f3cs2v_vertical_test <- (-f3cs2v_vertical_train)
f3cs2v_vertical_y.test_scale <- f3cs2v_vertical_y_scale[f3cs2v_vertical_test]

f3cs2v_vertical_lasso.mod_scale <- glmnet(f3cs2v_vertical_x_scale[f3cs2v_vertical_train, ], f3cs2v_vertical_y_scale[f3cs2v_vertical_train], alpha = 1,
    lambda = grid,intercept = TRUE ,standardize = TRUE)

set.seed(1)
f3cs2v_vertical_cv.out_scale <- cv.glmnet(f3cs2v_vertical_x_scale[f3cs2v_vertical_train, ], f3cs2v_vertical_y_scale[f3cs2v_vertical_train], alpha = 1)
#plot(f3cs2v_vertical_cv.out)
f3cs2v_vertical_bestlam_scale <- f3cs2v_vertical_cv.out_scale$lambda.min
#f3cs2v_vertical_bestlam <- 1
f3cs2v_vertical_lasso.pred_scale <- predict(f3cs2v_vertical_lasso.mod_scale, s = f3cs2v_vertical_bestlam_scale,
    newx = f3cs2v_vertical_x_scale[f3cs2v_vertical_test, ])
mean((f3cs2v_vertical_lasso.pred_scale - f3cs2v_vertical_y.test_scale)^2)
```

```{r}
forty_three_cone_shuttle_2_broad_jump <- combinecollege %>% select(-player, -vertical) %>% 
  filter(!is.na(forty) & !is.na(three_cone) & !is.na(shuttle) & !is.na(broad_jump))


f3cs2bj_broad_jump_x <- model.matrix(broad_jump ~ ., forty_three_cone_shuttle_2_broad_jump)
f3cs2bj_broad_jump_y <- forty_three_cone_shuttle_2_broad_jump$broad_jump
f3cs2bj_broad_jump_x 
mean(f3cs2bj_broad_jump_y)

set.seed(2)
f3cs2bj_broad_jump_train <- sample(1:nrow(f3cs2bj_broad_jump_x), .8*nrow(f3cs2bj_broad_jump_x))
f3cs2bj_broad_jump_test <- (-f3cs2bj_broad_jump_train)
f3cs2bj_broad_jump_y.test <- f3cs2bj_broad_jump_y[f3cs2bj_broad_jump_test]

grid <- 10^seq(-5, 5, length = 100)

f3cs2bj_broad_jump_lasso.mod <- glmnet(f3cs2bj_broad_jump_x[f3cs2bj_broad_jump_train, ], f3cs2bj_broad_jump_y[f3cs2bj_broad_jump_train], alpha = 1,
    lambda = grid,intercept = TRUE ,standardize = TRUE)
plot(f3cs2bj_broad_jump_lasso.mod)

set.seed(1)
f3cs2bj_broad_jump_cv.out <- cv.glmnet(f3cs2bj_broad_jump_x[f3cs2bj_broad_jump_train, ], f3cs2bj_broad_jump_y[f3cs2bj_broad_jump_train], alpha = 1)
#plot(f3cs2bj_broad_jump_cv.out)
f3cs2bj_broad_jump_bestlam <- f3cs2bj_broad_jump_cv.out$lambda.min
#f3cs2bj_broad_jump_bestlam <- 1
f3cs2bj_broad_jump_lasso.pred <- predict(f3cs2bj_broad_jump_lasso.mod, s = f3cs2bj_broad_jump_bestlam,
    newx = f3cs2bj_broad_jump_x[f3cs2bj_broad_jump_test, ])
mean((f3cs2bj_broad_jump_lasso.pred - f3cs2bj_broad_jump_y.test)^2)

f3cs2bj_broad_jump_out <- glmnet(f3cs2bj_broad_jump_x, f3cs2bj_broad_jump_y, alpha = 1, lambda = f3cs2bj_broad_jump_bestlam )
coef(f3cs2bj_broad_jump_out)
f3cs2bj_broad_jump_lasso.coef <- predict(f3cs2bj_broad_jump_out, type = "coefficients",
    s = f3cs2bj_broad_jump_bestlam)[1:(ncol(forty_three_cone_shuttle_2_broad_jump)+1), ]
f3cs2bj_broad_jump_lasso.coef
f3cs2bj_broad_jump_lasso.coef[f3cs2bj_broad_jump_lasso.coef != 0]

ggplot(forty_three_cone_shuttle_2_broad_jump[-f3cs2bj_broad_jump_train,] %>% mutate(pred = f3cs2bj_broad_jump_lasso.pred),
       aes(x = pred, broad_jump)) +
  geom_point()



f3cs2bj_broad_jump_x_scale <- model.matrix(scale(broad_jump) ~ scale(three_cone) + scale(shuttle), forty_three_cone_shuttle_2_broad_jump)
f3cs2bj_broad_jump_y_scale <- (forty_three_cone_shuttle_2_broad_jump %>% mutate(broad_jump = scale(broad_jump)))$broad_jump

set.seed(2)
f3cs2bj_broad_jump_train <- sample(1:nrow(f3cs2bj_broad_jump_x_scale), .8*nrow(f3cs2bj_broad_jump_x_scale))
f3cs2bj_broad_jump_test <- (-f3cs2bj_broad_jump_train)
f3cs2bj_broad_jump_y.test_scale <- f3cs2bj_broad_jump_y_scale[f3cs2bj_broad_jump_test]

f3cs2bj_broad_jump_lasso.mod_scale <- glmnet(f3cs2bj_broad_jump_x_scale[f3cs2bj_broad_jump_train, ], f3cs2bj_broad_jump_y_scale[f3cs2bj_broad_jump_train], alpha = 1,
    lambda = grid,intercept = TRUE ,standardize = TRUE)

set.seed(1)
f3cs2bj_broad_jump_cv.out_scale <- cv.glmnet(f3cs2bj_broad_jump_x_scale[f3cs2bj_broad_jump_train, ], f3cs2bj_broad_jump_y_scale[f3cs2bj_broad_jump_train], alpha = 1)
#plot(f3cs2bj_broad_jump_cv.out)
f3cs2bj_broad_jump_bestlam_scale <- f3cs2bj_broad_jump_cv.out_scale$lambda.min
#f3cs2bj_broad_jump_bestlam <- 1
f3cs2bj_broad_jump_lasso.pred_scale <- predict(f3cs2bj_broad_jump_lasso.mod_scale, s = f3cs2bj_broad_jump_bestlam_scale,
    newx = f3cs2bj_broad_jump_x_scale[f3cs2bj_broad_jump_test, ])
mean((f3cs2bj_broad_jump_lasso.pred_scale - f3cs2bj_broad_jump_y.test_scale)^2)
```

# Use forty, 3 cone and shuttle to predict broad jump
```{r}
update11 <- update10 %>% mutate(broad_jump = if_else(
                           !is.na(forty) & is.na(vertical) & is.na(broad_jump) & !is.na(three_cone) & !is.na(shuttle),
                           f3cs2bj_broad_jump_lasso.coef[f3cs2bj_broad_jump_lasso.coef != 0][1] +
                             f3cs2bj_broad_jump_lasso.coef[f3cs2bj_broad_jump_lasso.coef != 0][2] * height +
                             f3cs2bj_broad_jump_lasso.coef[f3cs2bj_broad_jump_lasso.coef != 0][3] * weight +
                             f3cs2bj_broad_jump_lasso.coef[f3cs2bj_broad_jump_lasso.coef != 0][4] * forty +
                             f3cs2bj_broad_jump_lasso.coef[f3cs2bj_broad_jump_lasso.coef != 0][5] * three_cone +
                             f3cs2bj_broad_jump_lasso.coef[f3cs2bj_broad_jump_lasso.coef != 0][6] * G +
                             f3cs2bj_broad_jump_lasso.coef[f3cs2bj_broad_jump_lasso.coef != 0][7] * Rec +
                             f3cs2bj_broad_jump_lasso.coef[f3cs2bj_broad_jump_lasso.coef != 0][8] * RushYds +
                             f3cs2bj_broad_jump_lasso.coef[f3cs2bj_broad_jump_lasso.coef != 0][9] * TotAvg +
                             f3cs2bj_broad_jump_lasso.coef[f3cs2bj_broad_jump_lasso.coef != 0][10] * TotTD,
                           broad_jump
                         )) 
```

# Use forty, vertical, and shuttle to predict
```{r}
forty_vertical_shuttle_2_three_cone <- combinecollege %>% select(-player, -broad_jump) %>% 
  filter(!is.na(forty) & !is.na(vertical) & !is.na(shuttle) & !is.na(three_cone))


fvs23c_three_cone_x <- model.matrix(three_cone ~ ., forty_vertical_shuttle_2_three_cone)
fvs23c_three_cone_y <- forty_vertical_shuttle_2_three_cone$three_cone
fvs23c_three_cone_x 
mean(fvs23c_three_cone_y)

set.seed(2)
fvs23c_three_cone_train <- sample(1:nrow(fvs23c_three_cone_x), .8*nrow(fvs23c_three_cone_x))
fvs23c_three_cone_test <- (-fvs23c_three_cone_train)
fvs23c_three_cone_y.test <- fvs23c_three_cone_y[fvs23c_three_cone_test]

grid <- 10^seq(-5, 5, length = 100)

fvs23c_three_cone_lasso.mod <- glmnet(fvs23c_three_cone_x[fvs23c_three_cone_train, ], fvs23c_three_cone_y[fvs23c_three_cone_train], alpha = 1,
    lambda = grid,intercept = TRUE ,standardize = TRUE)
plot(fvs23c_three_cone_lasso.mod)

set.seed(1)
fvs23c_three_cone_cv.out <- cv.glmnet(fvs23c_three_cone_x[fvs23c_three_cone_train, ], fvs23c_three_cone_y[fvs23c_three_cone_train], alpha = 1)
#plot(fvs23c_three_cone_cv.out)
fvs23c_three_cone_bestlam <- fvs23c_three_cone_cv.out$lambda.min
#fvs23c_three_cone_bestlam <- 1
fvs23c_three_cone_lasso.pred <- predict(fvs23c_three_cone_lasso.mod, s = fvs23c_three_cone_bestlam,
    newx = fvs23c_three_cone_x[fvs23c_three_cone_test, ])
mean((fvs23c_three_cone_lasso.pred - fvs23c_three_cone_y.test)^2)

fvs23c_three_cone_out <- glmnet(fvs23c_three_cone_x, fvs23c_three_cone_y, alpha = 1, lambda = fvs23c_three_cone_bestlam )
coef(fvs23c_three_cone_out)
fvs23c_three_cone_lasso.coef <- predict(fvs23c_three_cone_out, type = "coefficients",
    s = fvs23c_three_cone_bestlam)[1:(ncol(forty_vertical_shuttle_2_three_cone)+1), ]
fvs23c_three_cone_lasso.coef
fvs23c_three_cone_lasso.coef[fvs23c_three_cone_lasso.coef != 0]

ggplot(forty_vertical_shuttle_2_three_cone[-fvs23c_three_cone_train,] %>% mutate(pred = fvs23c_three_cone_lasso.pred),
       aes(x = pred, three_cone)) +
  geom_point()



fvs23c_three_cone_x_scale <- model.matrix(scale(three_cone) ~ scale(vertical) + scale(shuttle), forty_vertical_shuttle_2_three_cone)
fvs23c_three_cone_y_scale <- (forty_vertical_shuttle_2_three_cone %>% mutate(three_cone = scale(three_cone)))$three_cone

set.seed(2)
fvs23c_three_cone_train <- sample(1:nrow(fvs23c_three_cone_x_scale), .8*nrow(fvs23c_three_cone_x_scale))
fvs23c_three_cone_test <- (-fvs23c_three_cone_train)
fvs23c_three_cone_y.test_scale <- fvs23c_three_cone_y_scale[fvs23c_three_cone_test]

fvs23c_three_cone_lasso.mod_scale <- glmnet(fvs23c_three_cone_x_scale[fvs23c_three_cone_train, ], fvs23c_three_cone_y_scale[fvs23c_three_cone_train], alpha = 1,
    lambda = grid,intercept = TRUE ,standardize = TRUE)

set.seed(1)
fvs23c_three_cone_cv.out_scale <- cv.glmnet(fvs23c_three_cone_x_scale[fvs23c_three_cone_train, ], fvs23c_three_cone_y_scale[fvs23c_three_cone_train], alpha = 1)
#plot(fvs23c_three_cone_cv.out)
fvs23c_three_cone_bestlam_scale <- fvs23c_three_cone_cv.out_scale$lambda.min
#fvs23c_three_cone_bestlam <- 1
fvs23c_three_cone_lasso.pred_scale <- predict(fvs23c_three_cone_lasso.mod_scale, s = fvs23c_three_cone_bestlam_scale,
    newx = fvs23c_three_cone_x_scale[fvs23c_three_cone_test, ])
mean((fvs23c_three_cone_lasso.pred_scale - fvs23c_three_cone_y.test_scale)^2)
```

```{r}
forty_vertical_shuttle_2_broad_jump <- combinecollege %>% select(-player, -three_cone) %>% 
  filter(!is.na(forty) & !is.na(vertical) & !is.na(shuttle) & !is.na(broad_jump))


fvs2bj_broad_jump_x <- model.matrix(broad_jump ~ ., forty_vertical_shuttle_2_broad_jump)
fvs2bj_broad_jump_y <- forty_vertical_shuttle_2_broad_jump$broad_jump
fvs2bj_broad_jump_x 
mean(fvs2bj_broad_jump_y)

set.seed(2)
fvs2bj_broad_jump_train <- sample(1:nrow(fvs2bj_broad_jump_x), .8*nrow(fvs2bj_broad_jump_x))
fvs2bj_broad_jump_test <- (-fvs2bj_broad_jump_train)
fvs2bj_broad_jump_y.test <- fvs2bj_broad_jump_y[fvs2bj_broad_jump_test]

grid <- 10^seq(-5, 5, length = 100)

fvs2bj_broad_jump_lasso.mod <- glmnet(fvs2bj_broad_jump_x[fvs2bj_broad_jump_train, ], fvs2bj_broad_jump_y[fvs2bj_broad_jump_train], alpha = 1,
    lambda = grid,intercept = TRUE ,standardize = TRUE)
plot(fvs2bj_broad_jump_lasso.mod)

set.seed(1)
fvs2bj_broad_jump_cv.out <- cv.glmnet(fvs2bj_broad_jump_x[fvs2bj_broad_jump_train, ], fvs2bj_broad_jump_y[fvs2bj_broad_jump_train], alpha = 1)
#plot(fvs2bj_broad_jump_cv.out)
fvs2bj_broad_jump_bestlam <- fvs2bj_broad_jump_cv.out$lambda.min
#fvs2bj_broad_jump_bestlam <- 1
fvs2bj_broad_jump_lasso.pred <- predict(fvs2bj_broad_jump_lasso.mod, s = fvs2bj_broad_jump_bestlam,
    newx = fvs2bj_broad_jump_x[fvs2bj_broad_jump_test, ])
mean((fvs2bj_broad_jump_lasso.pred - fvs2bj_broad_jump_y.test)^2)

fvs2bj_broad_jump_out <- glmnet(fvs2bj_broad_jump_x, fvs2bj_broad_jump_y, alpha = 1, lambda = fvs2bj_broad_jump_bestlam )
coef(fvs2bj_broad_jump_out)
fvs2bj_broad_jump_lasso.coef <- predict(fvs2bj_broad_jump_out, type = "coefficients",
    s = fvs2bj_broad_jump_bestlam)[1:(ncol(forty_vertical_shuttle_2_broad_jump)+1), ]
fvs2bj_broad_jump_lasso.coef
fvs2bj_broad_jump_lasso.coef[fvs2bj_broad_jump_lasso.coef != 0]

ggplot(forty_vertical_shuttle_2_broad_jump[-fvs2bj_broad_jump_train,] %>% mutate(pred = fvs2bj_broad_jump_lasso.pred),
       aes(x = pred, broad_jump)) +
  geom_point()



fvs2bj_broad_jump_x_scale <- model.matrix(scale(broad_jump) ~ scale(vertical) + scale(shuttle), forty_vertical_shuttle_2_broad_jump)
fvs2bj_broad_jump_y_scale <- (forty_vertical_shuttle_2_broad_jump %>% mutate(broad_jump = scale(broad_jump)))$broad_jump

set.seed(2)
fvs2bj_broad_jump_train <- sample(1:nrow(fvs2bj_broad_jump_x_scale), .8*nrow(fvs2bj_broad_jump_x_scale))
fvs2bj_broad_jump_test <- (-fvs2bj_broad_jump_train)
fvs2bj_broad_jump_y.test_scale <- fvs2bj_broad_jump_y_scale[fvs2bj_broad_jump_test]

fvs2bj_broad_jump_lasso.mod_scale <- glmnet(fvs2bj_broad_jump_x_scale[fvs2bj_broad_jump_train, ], fvs2bj_broad_jump_y_scale[fvs2bj_broad_jump_train], alpha = 1,
    lambda = grid,intercept = TRUE ,standardize = TRUE)

set.seed(1)
fvs2bj_broad_jump_cv.out_scale <- cv.glmnet(fvs2bj_broad_jump_x_scale[fvs2bj_broad_jump_train, ], fvs2bj_broad_jump_y_scale[fvs2bj_broad_jump_train], alpha = 1)
#plot(fvs2bj_broad_jump_cv.out)
fvs2bj_broad_jump_bestlam_scale <- fvs2bj_broad_jump_cv.out_scale$lambda.min
#fvs2bj_broad_jump_bestlam <- 1
fvs2bj_broad_jump_lasso.pred_scale <- predict(fvs2bj_broad_jump_lasso.mod_scale, s = fvs2bj_broad_jump_bestlam_scale,
    newx = fvs2bj_broad_jump_x_scale[fvs2bj_broad_jump_test, ])
mean((fvs2bj_broad_jump_lasso.pred_scale - fvs2bj_broad_jump_y.test_scale)^2)
```

# Use forty, vertical and shuttle to predict three cone
```{r}
update12 <- update11 %>% mutate(three_cone = if_else(
                           !is.na(forty) & !is.na(vertical) & is.na(broad_jump) & is.na(three_cone) & !is.na(shuttle),
                           fvs23c_three_cone_lasso.coef[fvs23c_three_cone_lasso.coef != 0][1] +
                             fvs23c_three_cone_lasso.coef[fvs23c_three_cone_lasso.coef != 0][2] * weight +
                             fvs23c_three_cone_lasso.coef[fvs23c_three_cone_lasso.coef != 0][3] * forty +
                             fvs23c_three_cone_lasso.coef[fvs23c_three_cone_lasso.coef != 0][4] * vertical +
                             fvs23c_three_cone_lasso.coef[fvs23c_three_cone_lasso.coef != 0][5] * shuttle +
                             fvs23c_three_cone_lasso.coef[fvs23c_three_cone_lasso.coef != 0][6] * G +
                             fvs23c_three_cone_lasso.coef[fvs23c_three_cone_lasso.coef != 0][7] * RushYds +
                             fvs23c_three_cone_lasso.coef[fvs23c_three_cone_lasso.coef != 0][8] * as.numeric(ConfIndicator),
                           three_cone
                         )) 
```

# Vertical, broad jump and three cone to predict
```{r}
vertical_broad_jump_three_cone_2_forty <- combinecollege %>% select(-player, -shuttle) %>% 
  filter(!is.na(vertical) & !is.na(broad_jump) & !is.na(three_cone) & !is.na(forty))


vbj3c2f_forty_x <- model.matrix(forty ~ ., vertical_broad_jump_three_cone_2_forty)
vbj3c2f_forty_y <- vertical_broad_jump_three_cone_2_forty$forty
vbj3c2f_forty_x 
mean(vbj3c2f_forty_y)

set.seed(2)
vbj3c2f_forty_train <- sample(1:nrow(vbj3c2f_forty_x), .8*nrow(vbj3c2f_forty_x))
vbj3c2f_forty_test <- (-vbj3c2f_forty_train)
vbj3c2f_forty_y.test <- vbj3c2f_forty_y[vbj3c2f_forty_test]

grid <- 10^seq(-5, 5, length = 100)

vbj3c2f_forty_lasso.mod <- glmnet(vbj3c2f_forty_x[vbj3c2f_forty_train, ], vbj3c2f_forty_y[vbj3c2f_forty_train], alpha = 1,
    lambda = grid,intercept = TRUE ,standardize = TRUE)
plot(vbj3c2f_forty_lasso.mod)

set.seed(1)
vbj3c2f_forty_cv.out <- cv.glmnet(vbj3c2f_forty_x[vbj3c2f_forty_train, ], vbj3c2f_forty_y[vbj3c2f_forty_train], alpha = 1)
#plot(vbj3c2f_forty_cv.out)
vbj3c2f_forty_bestlam <- vbj3c2f_forty_cv.out$lambda.min
#vbj3c2f_forty_bestlam <- 1
vbj3c2f_forty_lasso.pred <- predict(vbj3c2f_forty_lasso.mod, s = vbj3c2f_forty_bestlam,
    newx = vbj3c2f_forty_x[vbj3c2f_forty_test, ])
mean((vbj3c2f_forty_lasso.pred - vbj3c2f_forty_y.test)^2)

vbj3c2f_forty_out <- glmnet(vbj3c2f_forty_x, vbj3c2f_forty_y, alpha = 1, lambda = vbj3c2f_forty_bestlam )
coef(vbj3c2f_forty_out)
vbj3c2f_forty_lasso.coef <- predict(vbj3c2f_forty_out, type = "coefficients",
    s = vbj3c2f_forty_bestlam)[1:(ncol(vertical_broad_jump_three_cone_2_forty)+1), ]
vbj3c2f_forty_lasso.coef
vbj3c2f_forty_lasso.coef[vbj3c2f_forty_lasso.coef != 0]

ggplot(vertical_broad_jump_three_cone_2_forty[-vbj3c2f_forty_train,] %>% mutate(pred = vbj3c2f_forty_lasso.pred),
       aes(x = pred, forty)) +
  geom_point()



vbj3c2f_forty_x_scale <- model.matrix(scale(forty) ~ scale(broad_jump) + scale(three_cone), vertical_broad_jump_three_cone_2_forty)
vbj3c2f_forty_y_scale <- (vertical_broad_jump_three_cone_2_forty %>% mutate(forty = scale(forty)))$forty

set.seed(2)
vbj3c2f_forty_train <- sample(1:nrow(vbj3c2f_forty_x_scale), .8*nrow(vbj3c2f_forty_x_scale))
vbj3c2f_forty_test <- (-vbj3c2f_forty_train)
vbj3c2f_forty_y.test_scale <- vbj3c2f_forty_y_scale[vbj3c2f_forty_test]

vbj3c2f_forty_lasso.mod_scale <- glmnet(vbj3c2f_forty_x_scale[vbj3c2f_forty_train, ], vbj3c2f_forty_y_scale[vbj3c2f_forty_train], alpha = 1,
    lambda = grid,intercept = TRUE ,standardize = TRUE)

set.seed(1)
vbj3c2f_forty_cv.out_scale <- cv.glmnet(vbj3c2f_forty_x_scale[vbj3c2f_forty_train, ], vbj3c2f_forty_y_scale[vbj3c2f_forty_train], alpha = 1)
#plot(vbj3c2f_forty_cv.out)
vbj3c2f_forty_bestlam_scale <- vbj3c2f_forty_cv.out_scale$lambda.min
#vbj3c2f_forty_bestlam <- 1
vbj3c2f_forty_lasso.pred_scale <- predict(vbj3c2f_forty_lasso.mod_scale, s = vbj3c2f_forty_bestlam_scale,
    newx = vbj3c2f_forty_x_scale[vbj3c2f_forty_test, ])
mean((vbj3c2f_forty_lasso.pred_scale - vbj3c2f_forty_y.test_scale)^2)
```

```{r}
vertical_broad_jump_three_cone_2_shuttle <- combinecollege %>% select(-player, -forty) %>% 
  filter(!is.na(vertical) & !is.na(broad_jump) & !is.na(three_cone) & !is.na(shuttle))


vbj3c2s_shuttle_x <- model.matrix(shuttle ~ ., vertical_broad_jump_three_cone_2_shuttle)
vbj3c2s_shuttle_y <- vertical_broad_jump_three_cone_2_shuttle$shuttle
vbj3c2s_shuttle_x 
mean(vbj3c2s_shuttle_y)

set.seed(2)
vbj3c2s_shuttle_train <- sample(1:nrow(vbj3c2s_shuttle_x), .8*nrow(vbj3c2s_shuttle_x))
vbj3c2s_shuttle_test <- (-vbj3c2s_shuttle_train)
vbj3c2s_shuttle_y.test <- vbj3c2s_shuttle_y[vbj3c2s_shuttle_test]

grid <- 10^seq(-5, 5, length = 100)

vbj3c2s_shuttle_lasso.mod <- glmnet(vbj3c2s_shuttle_x[vbj3c2s_shuttle_train, ], vbj3c2s_shuttle_y[vbj3c2s_shuttle_train], alpha = 1,
    lambda = grid,intercept = TRUE ,standardize = TRUE)
plot(vbj3c2s_shuttle_lasso.mod)

set.seed(1)
vbj3c2s_shuttle_cv.out <- cv.glmnet(vbj3c2s_shuttle_x[vbj3c2s_shuttle_train, ], vbj3c2s_shuttle_y[vbj3c2s_shuttle_train], alpha = 1)
#plot(vbj3c2s_shuttle_cv.out)
vbj3c2s_shuttle_bestlam <- vbj3c2s_shuttle_cv.out$lambda.min
#vbj3c2s_shuttle_bestlam <- 1
vbj3c2s_shuttle_lasso.pred <- predict(vbj3c2s_shuttle_lasso.mod, s = vbj3c2s_shuttle_bestlam,
    newx = vbj3c2s_shuttle_x[vbj3c2s_shuttle_test, ])
mean((vbj3c2s_shuttle_lasso.pred - vbj3c2s_shuttle_y.test)^2)

vbj3c2s_shuttle_out <- glmnet(vbj3c2s_shuttle_x, vbj3c2s_shuttle_y, alpha = 1, lambda = vbj3c2s_shuttle_bestlam )
coef(vbj3c2s_shuttle_out)
vbj3c2s_shuttle_lasso.coef <- predict(vbj3c2s_shuttle_out, type = "coefficients",
    s = vbj3c2s_shuttle_bestlam)[1:(ncol(vertical_broad_jump_three_cone_2_shuttle)+1), ]
vbj3c2s_shuttle_lasso.coef
vbj3c2s_shuttle_lasso.coef[vbj3c2s_shuttle_lasso.coef != 0]

ggplot(vertical_broad_jump_three_cone_2_shuttle[-vbj3c2s_shuttle_train,] %>% mutate(pred = vbj3c2s_shuttle_lasso.pred),
       aes(x = pred, shuttle)) +
  geom_point()



vbj3c2s_shuttle_x_scale <- model.matrix(scale(shuttle) ~ scale(broad_jump) + scale(three_cone), vertical_broad_jump_three_cone_2_shuttle)
vbj3c2s_shuttle_y_scale <- (vertical_broad_jump_three_cone_2_shuttle %>% mutate(shuttle = scale(shuttle)))$shuttle

set.seed(2)
vbj3c2s_shuttle_train <- sample(1:nrow(vbj3c2s_shuttle_x_scale), .8*nrow(vbj3c2s_shuttle_x_scale))
vbj3c2s_shuttle_test <- (-vbj3c2s_shuttle_train)
vbj3c2s_shuttle_y.test_scale <- vbj3c2s_shuttle_y_scale[vbj3c2s_shuttle_test]

vbj3c2s_shuttle_lasso.mod_scale <- glmnet(vbj3c2s_shuttle_x_scale[vbj3c2s_shuttle_train, ], vbj3c2s_shuttle_y_scale[vbj3c2s_shuttle_train], alpha = 1,
    lambda = grid,intercept = TRUE ,standardize = TRUE)

set.seed(1)
vbj3c2s_shuttle_cv.out_scale <- cv.glmnet(vbj3c2s_shuttle_x_scale[vbj3c2s_shuttle_train, ], vbj3c2s_shuttle_y_scale[vbj3c2s_shuttle_train], alpha = 1)
#plot(vbj3c2s_shuttle_cv.out)
vbj3c2s_shuttle_bestlam_scale <- vbj3c2s_shuttle_cv.out_scale$lambda.min
#vbj3c2s_shuttle_bestlam <- 1
vbj3c2s_shuttle_lasso.pred_scale <- predict(vbj3c2s_shuttle_lasso.mod_scale, s = vbj3c2s_shuttle_bestlam_scale,
    newx = vbj3c2s_shuttle_x_scale[vbj3c2s_shuttle_test, ])
mean((vbj3c2s_shuttle_lasso.pred_scale - vbj3c2s_shuttle_y.test_scale)^2)
```

# Use vertical, broad jump and three cone to predict shuttle
```{r}
update13 <- update12 %>% mutate(shuttle = if_else(
                           is.na(forty) & !is.na(vertical) & !is.na(broad_jump) & !is.na(three_cone) & is.na(shuttle),
                           vbj3c2s_shuttle_lasso.coef[vbj3c2s_shuttle_lasso.coef != 0][1] +
                             vbj3c2s_shuttle_lasso.coef[vbj3c2s_shuttle_lasso.coef != 0][2] * weight +
                             vbj3c2s_shuttle_lasso.coef[vbj3c2s_shuttle_lasso.coef != 0][3] * vertical +
                             vbj3c2s_shuttle_lasso.coef[vbj3c2s_shuttle_lasso.coef != 0][4] * three_cone +
                             vbj3c2s_shuttle_lasso.coef[vbj3c2s_shuttle_lasso.coef != 0][5] * Rec + 
                             vbj3c2s_shuttle_lasso.coef[vbj3c2s_shuttle_lasso.coef != 0][6] * RecAvg + 
                             vbj3c2s_shuttle_lasso.coef[vbj3c2s_shuttle_lasso.coef != 0][7] * TotTD +
                             vbj3c2s_shuttle_lasso.coef[vbj3c2s_shuttle_lasso.coef != 0][8] * as.numeric(ConfIndicator),
                           shuttle
                         )) 
```

# Use forty, broad jump, and shuttle to predict
```{r}
forty_broad_jump_shuttle_2_three_cone <- combinecollege %>% select(-player, -vertical) %>% 
  filter(!is.na(forty) & !is.na(broad_jump) & !is.na(shuttle) & !is.na(three_cone))


fbjs23c_three_cone_x <- model.matrix(three_cone ~ ., forty_broad_jump_shuttle_2_three_cone)
fbjs23c_three_cone_y <- forty_broad_jump_shuttle_2_three_cone$three_cone
fbjs23c_three_cone_x 
mean(fbjs23c_three_cone_y)

set.seed(2)
fbjs23c_three_cone_train <- sample(1:nrow(fbjs23c_three_cone_x), .8*nrow(fbjs23c_three_cone_x))
fbjs23c_three_cone_test <- (-fbjs23c_three_cone_train)
fbjs23c_three_cone_y.test <- fbjs23c_three_cone_y[fbjs23c_three_cone_test]

grid <- 10^seq(-5, 5, length = 100)

fbjs23c_three_cone_lasso.mod <- glmnet(fbjs23c_three_cone_x[fbjs23c_three_cone_train, ], fbjs23c_three_cone_y[fbjs23c_three_cone_train], alpha = 1,
    lambda = grid,intercept = TRUE ,standardize = TRUE)
plot(fbjs23c_three_cone_lasso.mod)

set.seed(1)
fbjs23c_three_cone_cv.out <- cv.glmnet(fbjs23c_three_cone_x[fbjs23c_three_cone_train, ], fbjs23c_three_cone_y[fbjs23c_three_cone_train], alpha = 1)
#plot(fbjs23c_three_cone_cv.out)
fbjs23c_three_cone_bestlam <- fbjs23c_three_cone_cv.out$lambda.min
#fbjs23c_three_cone_bestlam <- 1
fbjs23c_three_cone_lasso.pred <- predict(fbjs23c_three_cone_lasso.mod, s = fbjs23c_three_cone_bestlam,
    newx = fbjs23c_three_cone_x[fbjs23c_three_cone_test, ])
mean((fbjs23c_three_cone_lasso.pred - fbjs23c_three_cone_y.test)^2)

fbjs23c_three_cone_out <- glmnet(fbjs23c_three_cone_x, fbjs23c_three_cone_y, alpha = 1, lambda = fbjs23c_three_cone_bestlam )
coef(fbjs23c_three_cone_out)
fbjs23c_three_cone_lasso.coef <- predict(fbjs23c_three_cone_out, type = "coefficients",
    s = fbjs23c_three_cone_bestlam)[1:(ncol(forty_broad_jump_shuttle_2_three_cone)+1), ]
fbjs23c_three_cone_lasso.coef
fbjs23c_three_cone_lasso.coef[fbjs23c_three_cone_lasso.coef != 0]

ggplot(forty_broad_jump_shuttle_2_three_cone[-fbjs23c_three_cone_train,] %>% mutate(pred = fbjs23c_three_cone_lasso.pred),
       aes(x = pred, three_cone)) +
  geom_point()



fbjs23c_three_cone_x_scale <- model.matrix(scale(three_cone) ~ scale(broad_jump) + scale(shuttle), forty_broad_jump_shuttle_2_three_cone)
fbjs23c_three_cone_y_scale <- (forty_broad_jump_shuttle_2_three_cone %>% mutate(three_cone = scale(three_cone)))$three_cone

set.seed(2)
fbjs23c_three_cone_train <- sample(1:nrow(fbjs23c_three_cone_x_scale), .8*nrow(fbjs23c_three_cone_x_scale))
fbjs23c_three_cone_test <- (-fbjs23c_three_cone_train)
fbjs23c_three_cone_y.test_scale <- fbjs23c_three_cone_y_scale[fbjs23c_three_cone_test]

fbjs23c_three_cone_lasso.mod_scale <- glmnet(fbjs23c_three_cone_x_scale[fbjs23c_three_cone_train, ], fbjs23c_three_cone_y_scale[fbjs23c_three_cone_train], alpha = 1,
    lambda = grid,intercept = TRUE ,standardize = TRUE)

set.seed(1)
fbjs23c_three_cone_cv.out_scale <- cv.glmnet(fbjs23c_three_cone_x_scale[fbjs23c_three_cone_train, ], fbjs23c_three_cone_y_scale[fbjs23c_three_cone_train], alpha = 1)
#plot(fbjs23c_three_cone_cv.out)
fbjs23c_three_cone_bestlam_scale <- fbjs23c_three_cone_cv.out_scale$lambda.min
#fbjs23c_three_cone_bestlam <- 1
fbjs23c_three_cone_lasso.pred_scale <- predict(fbjs23c_three_cone_lasso.mod_scale, s = fbjs23c_three_cone_bestlam_scale,
    newx = fbjs23c_three_cone_x_scale[fbjs23c_three_cone_test, ])
mean((fbjs23c_three_cone_lasso.pred_scale - fbjs23c_three_cone_y.test_scale)^2)
```

```{r}
forty_broad_jump_shuttle_2_vertical <- combinecollege %>% select(-player, -three_cone) %>% 
  filter(!is.na(forty) & !is.na(broad_jump) & !is.na(shuttle) & !is.na(vertical))


fbjs2v_vertical_x <- model.matrix(vertical ~ ., forty_broad_jump_shuttle_2_vertical)
fbjs2v_vertical_y <- forty_broad_jump_shuttle_2_vertical$vertical
fbjs2v_vertical_x 
mean(fbjs2v_vertical_y)

set.seed(2)
fbjs2v_vertical_train <- sample(1:nrow(fbjs2v_vertical_x), .8*nrow(fbjs2v_vertical_x))
fbjs2v_vertical_test <- (-fbjs2v_vertical_train)
fbjs2v_vertical_y.test <- fbjs2v_vertical_y[fbjs2v_vertical_test]

grid <- 10^seq(-5, 5, length = 100)

fbjs2v_vertical_lasso.mod <- glmnet(fbjs2v_vertical_x[fbjs2v_vertical_train, ], fbjs2v_vertical_y[fbjs2v_vertical_train], alpha = 1,
    lambda = grid,intercept = TRUE ,standardize = TRUE)
plot(fbjs2v_vertical_lasso.mod)

set.seed(1)
fbjs2v_vertical_cv.out <- cv.glmnet(fbjs2v_vertical_x[fbjs2v_vertical_train, ], fbjs2v_vertical_y[fbjs2v_vertical_train], alpha = 1)
#plot(fbjs2v_vertical_cv.out)
fbjs2v_vertical_bestlam <- fbjs2v_vertical_cv.out$lambda.min
#fbjs2v_vertical_bestlam <- 1
fbjs2v_vertical_lasso.pred <- predict(fbjs2v_vertical_lasso.mod, s = fbjs2v_vertical_bestlam,
    newx = fbjs2v_vertical_x[fbjs2v_vertical_test, ])
mean((fbjs2v_vertical_lasso.pred - fbjs2v_vertical_y.test)^2)

fbjs2v_vertical_out <- glmnet(fbjs2v_vertical_x, fbjs2v_vertical_y, alpha = 1, lambda = fbjs2v_vertical_bestlam )
coef(fbjs2v_vertical_out)
fbjs2v_vertical_lasso.coef <- predict(fbjs2v_vertical_out, type = "coefficients",
    s = fbjs2v_vertical_bestlam)[1:(ncol(forty_broad_jump_shuttle_2_vertical)+1), ]
fbjs2v_vertical_lasso.coef
fbjs2v_vertical_lasso.coef[fbjs2v_vertical_lasso.coef != 0]

ggplot(forty_broad_jump_shuttle_2_vertical[-fbjs2v_vertical_train,] %>% mutate(pred = fbjs2v_vertical_lasso.pred),
       aes(x = pred, vertical)) +
  geom_point()



fbjs2v_vertical_x_scale <- model.matrix(scale(vertical) ~ scale(broad_jump) + scale(shuttle), forty_broad_jump_shuttle_2_vertical)
fbjs2v_vertical_y_scale <- (forty_broad_jump_shuttle_2_vertical %>% mutate(vertical = scale(vertical)))$vertical

set.seed(2)
fbjs2v_vertical_train <- sample(1:nrow(fbjs2v_vertical_x_scale), .8*nrow(fbjs2v_vertical_x_scale))
fbjs2v_vertical_test <- (-fbjs2v_vertical_train)
fbjs2v_vertical_y.test_scale <- fbjs2v_vertical_y_scale[fbjs2v_vertical_test]

fbjs2v_vertical_lasso.mod_scale <- glmnet(fbjs2v_vertical_x_scale[fbjs2v_vertical_train, ], fbjs2v_vertical_y_scale[fbjs2v_vertical_train], alpha = 1,
    lambda = grid,intercept = TRUE ,standardize = TRUE)

set.seed(1)
fbjs2v_vertical_cv.out_scale <- cv.glmnet(fbjs2v_vertical_x_scale[fbjs2v_vertical_train, ], fbjs2v_vertical_y_scale[fbjs2v_vertical_train], alpha = 1)
#plot(fbjs2v_vertical_cv.out)
fbjs2v_vertical_bestlam_scale <- fbjs2v_vertical_cv.out_scale$lambda.min
#fbjs2v_vertical_bestlam <- 1
fbjs2v_vertical_lasso.pred_scale <- predict(fbjs2v_vertical_lasso.mod_scale, s = fbjs2v_vertical_bestlam_scale,
    newx = fbjs2v_vertical_x_scale[fbjs2v_vertical_test, ])
mean((fbjs2v_vertical_lasso.pred_scale - fbjs2v_vertical_y.test_scale)^2)
```


# Use forty, broad jump and shuttle to predict vertical
```{r}
update14 <- update13 %>% mutate(vertical = if_else(
                           !is.na(forty) & is.na(vertical) & !is.na(broad_jump) & is.na(three_cone) & !is.na(shuttle),
                           fbjs2v_vertical_lasso.coef[fbjs2v_vertical_lasso.coef != 0][1] +
                             fbjs2v_vertical_lasso.coef[fbjs2v_vertical_lasso.coef != 0][2] * height +
                             fbjs2v_vertical_lasso.coef[fbjs2v_vertical_lasso.coef != 0][3] * forty +
                             fbjs2v_vertical_lasso.coef[fbjs2v_vertical_lasso.coef != 0][4] * broad_jump + 
                             fbjs2v_vertical_lasso.coef[fbjs2v_vertical_lasso.coef != 0][5] * shuttle +
                             fbjs2v_vertical_lasso.coef[fbjs2v_vertical_lasso.coef != 0][6] * G,
                           vertical
                         )) 
```

# Use vertical, broad jump, and shuttle to predict
```{r}
vertical_broad_jump_shuttle_2_three_cone <- combinecollege %>% select(-player, -forty) %>% 
  filter(!is.na(vertical) & !is.na(broad_jump) & !is.na(shuttle) & !is.na(three_cone))


vbjs23c_three_cone_x <- model.matrix(three_cone ~ ., vertical_broad_jump_shuttle_2_three_cone)
vbjs23c_three_cone_y <- vertical_broad_jump_shuttle_2_three_cone$three_cone
vbjs23c_three_cone_x 
mean(vbjs23c_three_cone_y)

set.seed(2)
vbjs23c_three_cone_train <- sample(1:nrow(vbjs23c_three_cone_x), .8*nrow(vbjs23c_three_cone_x))
vbjs23c_three_cone_test <- (-vbjs23c_three_cone_train)
vbjs23c_three_cone_y.test <- vbjs23c_three_cone_y[vbjs23c_three_cone_test]

grid <- 10^seq(-5, 5, length = 100)

vbjs23c_three_cone_lasso.mod <- glmnet(vbjs23c_three_cone_x[vbjs23c_three_cone_train, ], vbjs23c_three_cone_y[vbjs23c_three_cone_train], alpha = 1,
    lambda = grid,intercept = TRUE ,standardize = TRUE)
plot(vbjs23c_three_cone_lasso.mod)

set.seed(1)
vbjs23c_three_cone_cv.out <- cv.glmnet(vbjs23c_three_cone_x[vbjs23c_three_cone_train, ], vbjs23c_three_cone_y[vbjs23c_three_cone_train], alpha = 1)
#plot(vbjs23c_three_cone_cv.out)
vbjs23c_three_cone_bestlam <- vbjs23c_three_cone_cv.out$lambda.min
#vbjs23c_three_cone_bestlam <- 1
vbjs23c_three_cone_lasso.pred <- predict(vbjs23c_three_cone_lasso.mod, s = vbjs23c_three_cone_bestlam,
    newx = vbjs23c_three_cone_x[vbjs23c_three_cone_test, ])
mean((vbjs23c_three_cone_lasso.pred - vbjs23c_three_cone_y.test)^2)

vbjs23c_three_cone_out <- glmnet(vbjs23c_three_cone_x, vbjs23c_three_cone_y, alpha = 1, lambda = vbjs23c_three_cone_bestlam )
coef(vbjs23c_three_cone_out)
vbjs23c_three_cone_lasso.coef <- predict(vbjs23c_three_cone_out, type = "coefficients",
    s = vbjs23c_three_cone_bestlam)[1:(ncol(vertical_broad_jump_shuttle_2_three_cone)+1), ]
vbjs23c_three_cone_lasso.coef
vbjs23c_three_cone_lasso.coef[vbjs23c_three_cone_lasso.coef != 0]

ggplot(vertical_broad_jump_shuttle_2_three_cone[-vbjs23c_three_cone_train,] %>% mutate(pred = vbjs23c_three_cone_lasso.pred),
       aes(x = pred, three_cone)) +
  geom_point()



vbjs23c_three_cone_x_scale <- model.matrix(scale(three_cone) ~ scale(broad_jump) + scale(shuttle), vertical_broad_jump_shuttle_2_three_cone)
vbjs23c_three_cone_y_scale <- (vertical_broad_jump_shuttle_2_three_cone %>% mutate(three_cone = scale(three_cone)))$three_cone

set.seed(2)
vbjs23c_three_cone_train <- sample(1:nrow(vbjs23c_three_cone_x_scale), .8*nrow(vbjs23c_three_cone_x_scale))
vbjs23c_three_cone_test <- (-vbjs23c_three_cone_train)
vbjs23c_three_cone_y.test_scale <- vbjs23c_three_cone_y_scale[vbjs23c_three_cone_test]

vbjs23c_three_cone_lasso.mod_scale <- glmnet(vbjs23c_three_cone_x_scale[vbjs23c_three_cone_train, ], vbjs23c_three_cone_y_scale[vbjs23c_three_cone_train], alpha = 1,
    lambda = grid,intercept = TRUE ,standardize = TRUE)

set.seed(1)
vbjs23c_three_cone_cv.out_scale <- cv.glmnet(vbjs23c_three_cone_x_scale[vbjs23c_three_cone_train, ], vbjs23c_three_cone_y_scale[vbjs23c_three_cone_train], alpha = 1)
#plot(vbjs23c_three_cone_cv.out)
vbjs23c_three_cone_bestlam_scale <- vbjs23c_three_cone_cv.out_scale$lambda.min
#vbjs23c_three_cone_bestlam <- 1
vbjs23c_three_cone_lasso.pred_scale <- predict(vbjs23c_three_cone_lasso.mod_scale, s = vbjs23c_three_cone_bestlam_scale,
    newx = vbjs23c_three_cone_x_scale[vbjs23c_three_cone_test, ])
mean((vbjs23c_three_cone_lasso.pred_scale - vbjs23c_three_cone_y.test_scale)^2)
```

```{r}
vertical_broad_jump_shuttle_2_forty <- combinecollege %>% select(-player, -three_cone) %>% 
  filter(!is.na(vertical) & !is.na(broad_jump) & !is.na(shuttle) & !is.na(forty))


vbjs2f_forty_x <- model.matrix(forty ~ ., vertical_broad_jump_shuttle_2_forty)
vbjs2f_forty_y <- vertical_broad_jump_shuttle_2_forty$forty
vbjs2f_forty_x 
mean(vbjs2f_forty_y)

set.seed(2)
vbjs2f_forty_train <- sample(1:nrow(vbjs2f_forty_x), .8*nrow(vbjs2f_forty_x))
vbjs2f_forty_test <- (-vbjs2f_forty_train)
vbjs2f_forty_y.test <- vbjs2f_forty_y[vbjs2f_forty_test]

grid <- 10^seq(-5, 5, length = 100)

vbjs2f_forty_lasso.mod <- glmnet(vbjs2f_forty_x[vbjs2f_forty_train, ], vbjs2f_forty_y[vbjs2f_forty_train], alpha = 1,
    lambda = grid,intercept = TRUE ,standardize = TRUE)
plot(vbjs2f_forty_lasso.mod)

set.seed(1)
vbjs2f_forty_cv.out <- cv.glmnet(vbjs2f_forty_x[vbjs2f_forty_train, ], vbjs2f_forty_y[vbjs2f_forty_train], alpha = 1)
#plot(vbjs2f_forty_cv.out)
vbjs2f_forty_bestlam <- vbjs2f_forty_cv.out$lambda.min
#vbjs2f_forty_bestlam <- 1
vbjs2f_forty_lasso.pred <- predict(vbjs2f_forty_lasso.mod, s = vbjs2f_forty_bestlam,
    newx = vbjs2f_forty_x[vbjs2f_forty_test, ])
mean((vbjs2f_forty_lasso.pred - vbjs2f_forty_y.test)^2)

vbjs2f_forty_out <- glmnet(vbjs2f_forty_x, vbjs2f_forty_y, alpha = 1, lambda = vbjs2f_forty_bestlam )
coef(vbjs2f_forty_out)
vbjs2f_forty_lasso.coef <- predict(vbjs2f_forty_out, type = "coefficients",
    s = vbjs2f_forty_bestlam)[1:(ncol(vertical_broad_jump_shuttle_2_forty)+1), ]
vbjs2f_forty_lasso.coef
vbjs2f_forty_lasso.coef[vbjs2f_forty_lasso.coef != 0]

ggplot(vertical_broad_jump_shuttle_2_forty[-vbjs2f_forty_train,] %>% mutate(pred = vbjs2f_forty_lasso.pred),
       aes(x = pred, forty)) +
  geom_point()



vbjs2f_forty_x_scale <- model.matrix(scale(forty) ~ scale(broad_jump) + scale(shuttle), vertical_broad_jump_shuttle_2_forty)
vbjs2f_forty_y_scale <- (vertical_broad_jump_shuttle_2_forty %>% mutate(forty = scale(forty)))$forty

set.seed(2)
vbjs2f_forty_train <- sample(1:nrow(vbjs2f_forty_x_scale), .8*nrow(vbjs2f_forty_x_scale))
vbjs2f_forty_test <- (-vbjs2f_forty_train)
vbjs2f_forty_y.test_scale <- vbjs2f_forty_y_scale[vbjs2f_forty_test]

vbjs2f_forty_lasso.mod_scale <- glmnet(vbjs2f_forty_x_scale[vbjs2f_forty_train, ], vbjs2f_forty_y_scale[vbjs2f_forty_train], alpha = 1,
    lambda = grid,intercept = TRUE ,standardize = TRUE)

set.seed(1)
vbjs2f_forty_cv.out_scale <- cv.glmnet(vbjs2f_forty_x_scale[vbjs2f_forty_train, ], vbjs2f_forty_y_scale[vbjs2f_forty_train], alpha = 1)
#plot(vbjs2f_forty_cv.out)
vbjs2f_forty_bestlam_scale <- vbjs2f_forty_cv.out_scale$lambda.min
#vbjs2f_forty_bestlam <- 1
vbjs2f_forty_lasso.pred_scale <- predict(vbjs2f_forty_lasso.mod_scale, s = vbjs2f_forty_bestlam_scale,
    newx = vbjs2f_forty_x_scale[vbjs2f_forty_test, ])
mean((vbjs2f_forty_lasso.pred_scale - vbjs2f_forty_y.test_scale)^2)
```

# Use vertical, broad jump and shuttle to predict three cone
```{r}
update15 <- update14 %>% mutate(three_cone = if_else(
                           is.na(forty) & !is.na(vertical) & !is.na(broad_jump) & is.na(three_cone) & !is.na(shuttle),
                           vbjs23c_three_cone_lasso.coef[vbjs23c_three_cone_lasso.coef != 0][1] +
                             vbjs23c_three_cone_lasso.coef[vbjs23c_three_cone_lasso.coef != 0][2] * weight +
                             vbjs23c_three_cone_lasso.coef[vbjs23c_three_cone_lasso.coef != 0][3] * vertical +
                             vbjs23c_three_cone_lasso.coef[vbjs23c_three_cone_lasso.coef != 0][4] * shuttle +
                             vbjs23c_three_cone_lasso.coef[vbjs23c_three_cone_lasso.coef != 0][5] * G,
                           three_cone
                         )) 
```

# Use vertical, three cone and shuttle to predict
```{r}
vertical_three_cone_shuttle_2_forty <- combinecollege %>% select(-player, -broad_jump) %>% 
  filter(!is.na(vertical) & !is.na(three_cone) & !is.na(shuttle) & !is.na(forty))


v3cs2f_forty_x <- model.matrix(forty ~ ., vertical_three_cone_shuttle_2_forty)
v3cs2f_forty_y <- vertical_three_cone_shuttle_2_forty$forty
v3cs2f_forty_x 
mean(v3cs2f_forty_y)

set.seed(2)
v3cs2f_forty_train <- sample(1:nrow(v3cs2f_forty_x), .8*nrow(v3cs2f_forty_x))
v3cs2f_forty_test <- (-v3cs2f_forty_train)
v3cs2f_forty_y.test <- v3cs2f_forty_y[v3cs2f_forty_test]

grid <- 10^seq(-5, 5, length = 100)

v3cs2f_forty_lasso.mod <- glmnet(v3cs2f_forty_x[v3cs2f_forty_train, ], v3cs2f_forty_y[v3cs2f_forty_train], alpha = 1,
    lambda = grid,intercept = TRUE ,standardize = TRUE)
plot(v3cs2f_forty_lasso.mod)

set.seed(1)
v3cs2f_forty_cv.out <- cv.glmnet(v3cs2f_forty_x[v3cs2f_forty_train, ], v3cs2f_forty_y[v3cs2f_forty_train], alpha = 1)
#plot(v3cs2f_forty_cv.out)
v3cs2f_forty_bestlam <- v3cs2f_forty_cv.out$lambda.min
#v3cs2f_forty_bestlam <- 1
v3cs2f_forty_lasso.pred <- predict(v3cs2f_forty_lasso.mod, s = v3cs2f_forty_bestlam,
    newx = v3cs2f_forty_x[v3cs2f_forty_test, ])
mean((v3cs2f_forty_lasso.pred - v3cs2f_forty_y.test)^2)

v3cs2f_forty_out <- glmnet(v3cs2f_forty_x, v3cs2f_forty_y, alpha = 1, lambda = v3cs2f_forty_bestlam )
coef(v3cs2f_forty_out)
v3cs2f_forty_lasso.coef <- predict(v3cs2f_forty_out, type = "coefficients",
    s = v3cs2f_forty_bestlam)[1:(ncol(vertical_three_cone_shuttle_2_forty)+1), ]
v3cs2f_forty_lasso.coef
v3cs2f_forty_lasso.coef[v3cs2f_forty_lasso.coef != 0]

ggplot(vertical_three_cone_shuttle_2_forty[-v3cs2f_forty_train,] %>% mutate(pred = v3cs2f_forty_lasso.pred),
       aes(x = pred, forty)) +
  geom_point()



v3cs2f_forty_x_scale <- model.matrix(scale(forty) ~ scale(three_cone) + scale(shuttle), vertical_three_cone_shuttle_2_forty)
v3cs2f_forty_y_scale <- (vertical_three_cone_shuttle_2_forty %>% mutate(forty = scale(forty)))$forty

set.seed(2)
v3cs2f_forty_train <- sample(1:nrow(v3cs2f_forty_x_scale), .8*nrow(v3cs2f_forty_x_scale))
v3cs2f_forty_test <- (-v3cs2f_forty_train)
v3cs2f_forty_y.test_scale <- v3cs2f_forty_y_scale[v3cs2f_forty_test]

v3cs2f_forty_lasso.mod_scale <- glmnet(v3cs2f_forty_x_scale[v3cs2f_forty_train, ], v3cs2f_forty_y_scale[v3cs2f_forty_train], alpha = 1,
    lambda = grid,intercept = TRUE ,standardize = TRUE)

set.seed(1)
v3cs2f_forty_cv.out_scale <- cv.glmnet(v3cs2f_forty_x_scale[v3cs2f_forty_train, ], v3cs2f_forty_y_scale[v3cs2f_forty_train], alpha = 1)
#plot(v3cs2f_forty_cv.out)
v3cs2f_forty_bestlam_scale <- v3cs2f_forty_cv.out_scale$lambda.min
#v3cs2f_forty_bestlam <- 1
v3cs2f_forty_lasso.pred_scale <- predict(v3cs2f_forty_lasso.mod_scale, s = v3cs2f_forty_bestlam_scale,
    newx = v3cs2f_forty_x_scale[v3cs2f_forty_test, ])
mean((v3cs2f_forty_lasso.pred_scale - v3cs2f_forty_y.test_scale)^2)
```

```{r}
vertical_three_cone_shuttle_2_broad_jump <- combinecollege %>% select(-player, -forty) %>% 
  filter(!is.na(vertical) & !is.na(three_cone) & !is.na(shuttle) & !is.na(broad_jump))


v3cs2bj_broad_jump_x <- model.matrix(broad_jump ~ ., vertical_three_cone_shuttle_2_broad_jump)
v3cs2bj_broad_jump_y <- vertical_three_cone_shuttle_2_broad_jump$broad_jump
v3cs2bj_broad_jump_x 
mean(v3cs2bj_broad_jump_y)

set.seed(2)
v3cs2bj_broad_jump_train <- sample(1:nrow(v3cs2bj_broad_jump_x), .8*nrow(v3cs2bj_broad_jump_x))
v3cs2bj_broad_jump_test <- (-v3cs2bj_broad_jump_train)
v3cs2bj_broad_jump_y.test <- v3cs2bj_broad_jump_y[v3cs2bj_broad_jump_test]

grid <- 10^seq(-5, 5, length = 100)

v3cs2bj_broad_jump_lasso.mod <- glmnet(v3cs2bj_broad_jump_x[v3cs2bj_broad_jump_train, ], v3cs2bj_broad_jump_y[v3cs2bj_broad_jump_train], alpha = 1,
    lambda = grid,intercept = TRUE ,standardize = TRUE)
plot(v3cs2bj_broad_jump_lasso.mod)

set.seed(1)
v3cs2bj_broad_jump_cv.out <- cv.glmnet(v3cs2bj_broad_jump_x[v3cs2bj_broad_jump_train, ], v3cs2bj_broad_jump_y[v3cs2bj_broad_jump_train], alpha = 1)
#plot(v3cs2bj_broad_jump_cv.out)
v3cs2bj_broad_jump_bestlam <- v3cs2bj_broad_jump_cv.out$lambda.min
#v3cs2bj_broad_jump_bestlam <- 1
v3cs2bj_broad_jump_lasso.pred <- predict(v3cs2bj_broad_jump_lasso.mod, s = v3cs2bj_broad_jump_bestlam,
    newx = v3cs2bj_broad_jump_x[v3cs2bj_broad_jump_test, ])
mean((v3cs2bj_broad_jump_lasso.pred - v3cs2bj_broad_jump_y.test)^2)

v3cs2bj_broad_jump_out <- glmnet(v3cs2bj_broad_jump_x, v3cs2bj_broad_jump_y, alpha = 1, lambda = v3cs2bj_broad_jump_bestlam )
coef(v3cs2bj_broad_jump_out)
v3cs2bj_broad_jump_lasso.coef <- predict(v3cs2bj_broad_jump_out, type = "coefficients",
    s = v3cs2bj_broad_jump_bestlam)[1:(ncol(vertical_three_cone_shuttle_2_broad_jump)+1), ]
v3cs2bj_broad_jump_lasso.coef
v3cs2bj_broad_jump_lasso.coef[v3cs2bj_broad_jump_lasso.coef != 0]

ggplot(vertical_three_cone_shuttle_2_broad_jump[-v3cs2bj_broad_jump_train,] %>% mutate(pred = v3cs2bj_broad_jump_lasso.pred),
       aes(x = pred, broad_jump)) +
  geom_point()



v3cs2bj_broad_jump_x_scale <- model.matrix(scale(broad_jump) ~ scale(three_cone) + scale(shuttle), vertical_three_cone_shuttle_2_broad_jump)
v3cs2bj_broad_jump_y_scale <- (vertical_three_cone_shuttle_2_broad_jump %>% mutate(broad_jump = scale(broad_jump)))$broad_jump

set.seed(2)
v3cs2bj_broad_jump_train <- sample(1:nrow(v3cs2bj_broad_jump_x_scale), .8*nrow(v3cs2bj_broad_jump_x_scale))
v3cs2bj_broad_jump_test <- (-v3cs2bj_broad_jump_train)
v3cs2bj_broad_jump_y.test_scale <- v3cs2bj_broad_jump_y_scale[v3cs2bj_broad_jump_test]

v3cs2bj_broad_jump_lasso.mod_scale <- glmnet(v3cs2bj_broad_jump_x_scale[v3cs2bj_broad_jump_train, ], v3cs2bj_broad_jump_y_scale[v3cs2bj_broad_jump_train], alpha = 1,
    lambda = grid,intercept = TRUE ,standardize = TRUE)

set.seed(1)
v3cs2bj_broad_jump_cv.out_scale <- cv.glmnet(v3cs2bj_broad_jump_x_scale[v3cs2bj_broad_jump_train, ], v3cs2bj_broad_jump_y_scale[v3cs2bj_broad_jump_train], alpha = 1)
#plot(v3cs2bj_broad_jump_cv.out)
v3cs2bj_broad_jump_bestlam_scale <- v3cs2bj_broad_jump_cv.out_scale$lambda.min
#v3cs2bj_broad_jump_bestlam <- 1
v3cs2bj_broad_jump_lasso.pred_scale <- predict(v3cs2bj_broad_jump_lasso.mod_scale, s = v3cs2bj_broad_jump_bestlam_scale,
    newx = v3cs2bj_broad_jump_x_scale[v3cs2bj_broad_jump_test, ])
mean((v3cs2bj_broad_jump_lasso.pred_scale - v3cs2bj_broad_jump_y.test_scale)^2)
```

# If player only has vertical, three cone and shuttle predict broad jump
```{r}
update16 <- update15 %>% mutate(broad_jump = if_else(
                           is.na(forty) & !is.na(vertical) & is.na(broad_jump) & !is.na(three_cone) & !is.na(shuttle),
                           v3cs2bj_broad_jump_lasso.coef[v3cs2bj_broad_jump_lasso.coef != 0][1] +
                             v3cs2bj_broad_jump_lasso.coef[v3cs2bj_broad_jump_lasso.coef != 0][2] * height +
                             v3cs2bj_broad_jump_lasso.coef[v3cs2bj_broad_jump_lasso.coef != 0][3] * vertical +
                             v3cs2bj_broad_jump_lasso.coef[v3cs2bj_broad_jump_lasso.coef != 0][4] * shuttle +
                             v3cs2bj_broad_jump_lasso.coef[v3cs2bj_broad_jump_lasso.coef != 0][5] * G +
                             v3cs2bj_broad_jump_lasso.coef[v3cs2bj_broad_jump_lasso.coef != 0][6] * Rec +
                             v3cs2bj_broad_jump_lasso.coef[v3cs2bj_broad_jump_lasso.coef != 0][7] * TotAvg,
                           broad_jump
                         )) 
```

# Use forty, vertical, broad jump and three cone to predict shuttle
```{r}
forty_vertical_broad_jump_three_cone_2_shuttle <- combinecollege %>% select(-player) %>% 
  filter(!is.na(forty) & !is.na(vertical) & !is.na(broad_jump) & !is.na(three_cone) & !is.na(shuttle))


fvbj3c2s_shuttle_x <- model.matrix(shuttle ~ ., forty_vertical_broad_jump_three_cone_2_shuttle)
fvbj3c2s_shuttle_y <- forty_vertical_broad_jump_three_cone_2_shuttle$shuttle
fvbj3c2s_shuttle_x 
mean(fvbj3c2s_shuttle_y)

set.seed(2)
fvbj3c2s_shuttle_train <- sample(1:nrow(fvbj3c2s_shuttle_x), .8*nrow(fvbj3c2s_shuttle_x))
fvbj3c2s_shuttle_test <- (-fvbj3c2s_shuttle_train)
fvbj3c2s_shuttle_y.test <- fvbj3c2s_shuttle_y[fvbj3c2s_shuttle_test]

grid <- 10^seq(-5, 5, length = 100)

fvbj3c2s_shuttle_lasso.mod <- glmnet(fvbj3c2s_shuttle_x[fvbj3c2s_shuttle_train, ], fvbj3c2s_shuttle_y[fvbj3c2s_shuttle_train], alpha = 1,
    lambda = grid,intercept = TRUE ,standardize = TRUE)
plot(fvbj3c2s_shuttle_lasso.mod)

set.seed(1)
fvbj3c2s_shuttle_cv.out <- cv.glmnet(fvbj3c2s_shuttle_x[fvbj3c2s_shuttle_train, ], fvbj3c2s_shuttle_y[fvbj3c2s_shuttle_train], alpha = 1)
#plot(fvbj3c2s_shuttle_cv.out)
fvbj3c2s_shuttle_bestlam <- fvbj3c2s_shuttle_cv.out$lambda.min
#fvbj3c2s_shuttle_bestlam <- 1
fvbj3c2s_shuttle_lasso.pred <- predict(fvbj3c2s_shuttle_lasso.mod, s = fvbj3c2s_shuttle_bestlam,
    newx = fvbj3c2s_shuttle_x[fvbj3c2s_shuttle_test, ])
mean((fvbj3c2s_shuttle_lasso.pred - fvbj3c2s_shuttle_y.test)^2)

fvbj3c2s_shuttle_out <- glmnet(fvbj3c2s_shuttle_x, fvbj3c2s_shuttle_y, alpha = 1, lambda = fvbj3c2s_shuttle_bestlam )
coef(fvbj3c2s_shuttle_out)
fvbj3c2s_shuttle_lasso.coef <- predict(fvbj3c2s_shuttle_out, type = "coefficients",
    s = fvbj3c2s_shuttle_bestlam)[1:(ncol(forty_vertical_broad_jump_three_cone_2_shuttle)+1), ]
fvbj3c2s_shuttle_lasso.coef
fvbj3c2s_shuttle_lasso.coef[fvbj3c2s_shuttle_lasso.coef != 0]

ggplot(forty_vertical_broad_jump_three_cone_2_shuttle[-fvbj3c2s_shuttle_train,] %>% mutate(pred = fvbj3c2s_shuttle_lasso.pred),
       aes(x = pred, shuttle)) +
  geom_point()



fvbj3c2s_shuttle_x_scale <- model.matrix(scale(shuttle) ~ scale(broad_jump) + scale(three_cone), forty_vertical_broad_jump_three_cone_2_shuttle)
fvbj3c2s_shuttle_y_scale <- (forty_vertical_broad_jump_three_cone_2_shuttle %>% mutate(shuttle = scale(shuttle)))$shuttle

set.seed(2)
fvbj3c2s_shuttle_train <- sample(1:nrow(fvbj3c2s_shuttle_x_scale), .8*nrow(fvbj3c2s_shuttle_x_scale))
fvbj3c2s_shuttle_test <- (-fvbj3c2s_shuttle_train)
fvbj3c2s_shuttle_y.test_scale <- fvbj3c2s_shuttle_y_scale[fvbj3c2s_shuttle_test]

fvbj3c2s_shuttle_lasso.mod_scale <- glmnet(fvbj3c2s_shuttle_x_scale[fvbj3c2s_shuttle_train, ], fvbj3c2s_shuttle_y_scale[fvbj3c2s_shuttle_train], alpha = 1,
    lambda = grid,intercept = TRUE ,standardize = TRUE)

set.seed(1)
fvbj3c2s_shuttle_cv.out_scale <- cv.glmnet(fvbj3c2s_shuttle_x_scale[fvbj3c2s_shuttle_train, ], fvbj3c2s_shuttle_y_scale[fvbj3c2s_shuttle_train], alpha = 1)
#plot(fvbj3c2s_shuttle_cv.out)
fvbj3c2s_shuttle_bestlam_scale <- fvbj3c2s_shuttle_cv.out_scale$lambda.min
#fvbj3c2s_shuttle_bestlam <- 1
fvbj3c2s_shuttle_lasso.pred_scale <- predict(fvbj3c2s_shuttle_lasso.mod_scale, s = fvbj3c2s_shuttle_bestlam_scale,
    newx = fvbj3c2s_shuttle_x_scale[fvbj3c2s_shuttle_test, ])
mean((fvbj3c2s_shuttle_lasso.pred_scale - fvbj3c2s_shuttle_y.test_scale)^2)
```

# Use vertical, broad jump and three cone to predict shuttle
```{r}
update17 <- update16 %>% mutate(shuttle = if_else(
                           !is.na(forty) & !is.na(vertical) & !is.na(broad_jump) & !is.na(three_cone) & is.na(shuttle),
                           fvbj3c2s_shuttle_lasso.coef[fvbj3c2s_shuttle_lasso.coef != 0][1] +
                             fvbj3c2s_shuttle_lasso.coef[fvbj3c2s_shuttle_lasso.coef != 0][2] * weight +
                             fvbj3c2s_shuttle_lasso.coef[fvbj3c2s_shuttle_lasso.coef != 0][3] * vertical +
                             fvbj3c2s_shuttle_lasso.coef[fvbj3c2s_shuttle_lasso.coef != 0][4] * broad_jump +
                             fvbj3c2s_shuttle_lasso.coef[fvbj3c2s_shuttle_lasso.coef != 0][5] * three_cone +
                             fvbj3c2s_shuttle_lasso.coef[fvbj3c2s_shuttle_lasso.coef != 0][6] * G +
                            fvbj3c2s_shuttle_lasso.coef[fvbj3c2s_shuttle_lasso.coef != 0][7] * Rec +
                             fvbj3c2s_shuttle_lasso.coef[fvbj3c2s_shuttle_lasso.coef != 0][8] * RecAvg +
                             fvbj3c2s_shuttle_lasso.coef[fvbj3c2s_shuttle_lasso.coef != 0][9] * RushAtt +
                             fvbj3c2s_shuttle_lasso.coef[fvbj3c2s_shuttle_lasso.coef != 0][10] * TotTD +
                             fvbj3c2s_shuttle_lasso.coef[fvbj3c2s_shuttle_lasso.coef != 0][11] * as.numeric(ConfIndicator),
                           shuttle
                         )) 
```

# Use forty, vertical, broad jump and three_cone to predict three cone
```{r}
forty_vertical_broad_jump_shuttle_2_three_cone <- combinecollege %>% select(-player) %>% 
  filter(!is.na(forty) & !is.na(vertical) & !is.na(broad_jump) & !is.na(shuttle) & !is.na(three_cone))


fvbjs23c_three_cone_x <- model.matrix(three_cone ~ ., forty_vertical_broad_jump_shuttle_2_three_cone)
fvbjs23c_three_cone_y <- forty_vertical_broad_jump_shuttle_2_three_cone$three_cone
fvbjs23c_three_cone_x 
mean(fvbjs23c_three_cone_y)

set.seed(2)
fvbjs23c_three_cone_train <- sample(1:nrow(fvbjs23c_three_cone_x), .8*nrow(fvbjs23c_three_cone_x))
fvbjs23c_three_cone_test <- (-fvbjs23c_three_cone_train)
fvbjs23c_three_cone_y.test <- fvbjs23c_three_cone_y[fvbjs23c_three_cone_test]

grid <- 10^seq(-5, 5, length = 100)

fvbjs23c_three_cone_lasso.mod <- glmnet(fvbjs23c_three_cone_x[fvbjs23c_three_cone_train, ], fvbjs23c_three_cone_y[fvbjs23c_three_cone_train], alpha = 1,
    lambda = grid,intercept = TRUE ,standardize = TRUE)
plot(fvbjs23c_three_cone_lasso.mod)

set.seed(1)
fvbjs23c_three_cone_cv.out <- cv.glmnet(fvbjs23c_three_cone_x[fvbjs23c_three_cone_train, ], fvbjs23c_three_cone_y[fvbjs23c_three_cone_train], alpha = 1)
#plot(fvbjs23c_three_cone_cv.out)
fvbjs23c_three_cone_bestlam <- fvbjs23c_three_cone_cv.out$lambda.min
#fvbjs23c_three_cone_bestlam <- 1
fvbjs23c_three_cone_lasso.pred <- predict(fvbjs23c_three_cone_lasso.mod, s = fvbjs23c_three_cone_bestlam,
    newx = fvbjs23c_three_cone_x[fvbjs23c_three_cone_test, ])
mean((fvbjs23c_three_cone_lasso.pred - fvbjs23c_three_cone_y.test)^2)

fvbjs23c_three_cone_out <- glmnet(fvbjs23c_three_cone_x, fvbjs23c_three_cone_y, alpha = 1, lambda = fvbjs23c_three_cone_bestlam )
coef(fvbjs23c_three_cone_out)
fvbjs23c_three_cone_lasso.coef <- predict(fvbjs23c_three_cone_out, type = "coefficients",
    s = fvbjs23c_three_cone_bestlam)[1:(ncol(forty_vertical_broad_jump_shuttle_2_three_cone)+1), ]
fvbjs23c_three_cone_lasso.coef
fvbjs23c_three_cone_lasso.coef[fvbjs23c_three_cone_lasso.coef != 0]

ggplot(forty_vertical_broad_jump_shuttle_2_three_cone[-fvbjs23c_three_cone_train,] %>% mutate(pred = fvbjs23c_three_cone_lasso.pred),
       aes(x = pred, three_cone)) +
  geom_point()



fvbjs23c_three_cone_x_scale <- model.matrix(scale(three_cone) ~ scale(broad_jump) + scale(shuttle), forty_vertical_broad_jump_shuttle_2_three_cone)
fvbjs23c_three_cone_y_scale <- (forty_vertical_broad_jump_shuttle_2_three_cone %>% mutate(three_cone = scale(three_cone)))$three_cone

set.seed(2)
fvbjs23c_three_cone_train <- sample(1:nrow(fvbjs23c_three_cone_x_scale), .8*nrow(fvbjs23c_three_cone_x_scale))
fvbjs23c_three_cone_test <- (-fvbjs23c_three_cone_train)
fvbjs23c_three_cone_y.test_scale <- fvbjs23c_three_cone_y_scale[fvbjs23c_three_cone_test]

fvbjs23c_three_cone_lasso.mod_scale <- glmnet(fvbjs23c_three_cone_x_scale[fvbjs23c_three_cone_train, ], fvbjs23c_three_cone_y_scale[fvbjs23c_three_cone_train], alpha = 1,
    lambda = grid,intercept = TRUE ,standardize = TRUE)

set.seed(1)
fvbjs23c_three_cone_cv.out_scale <- cv.glmnet(fvbjs23c_three_cone_x_scale[fvbjs23c_three_cone_train, ], fvbjs23c_three_cone_y_scale[fvbjs23c_three_cone_train], alpha = 1)
#plot(fvbjs23c_three_cone_cv.out)
fvbjs23c_three_cone_bestlam_scale <- fvbjs23c_three_cone_cv.out_scale$lambda.min
#fvbjs23c_three_cone_bestlam <- 1
fvbjs23c_three_cone_lasso.pred_scale <- predict(fvbjs23c_three_cone_lasso.mod_scale, s = fvbjs23c_three_cone_bestlam_scale,
    newx = fvbjs23c_three_cone_x_scale[fvbjs23c_three_cone_test, ])
mean((fvbjs23c_three_cone_lasso.pred_scale - fvbjs23c_three_cone_y.test_scale)^2)
```

# Use vertical, broad jump and three cone to predict three_cone
```{r}
update18 <- update17 %>% mutate(three_cone = if_else(
                           !is.na(forty) & !is.na(vertical) & !is.na(broad_jump) & !is.na(shuttle) & is.na(three_cone),
                           fvbjs23c_three_cone_lasso.coef[fvbjs23c_three_cone_lasso.coef != 0][1] +
                             fvbjs23c_three_cone_lasso.coef[fvbjs23c_three_cone_lasso.coef != 0][2] * weight +
                             fvbjs23c_three_cone_lasso.coef[fvbjs23c_three_cone_lasso.coef != 0][3] * forty +
                             fvbjs23c_three_cone_lasso.coef[fvbjs23c_three_cone_lasso.coef != 0][4] * vertical +
                             fvbjs23c_three_cone_lasso.coef[fvbjs23c_three_cone_lasso.coef != 0][5] * shuttle +
                             fvbjs23c_three_cone_lasso.coef[fvbjs23c_three_cone_lasso.coef != 0][6] * G +
                             fvbjs23c_three_cone_lasso.coef[fvbjs23c_three_cone_lasso.coef != 0][7] * RushYds +
                             fvbjs23c_three_cone_lasso.coef[fvbjs23c_three_cone_lasso.coef != 0][8] * as.numeric(ConfIndicator),
                           three_cone
                         )) 
```

# Use forty, vertical, three_cone and shuttle to predict broad jump
```{r}
forty_vertical_three_cone_shuttle_2_broad_jump <- combinecollege %>% select(-player) %>% 
  filter(!is.na(forty) & !is.na(vertical) & !is.na(three_cone) & !is.na(shuttle) & !is.na(broad_jump))


f2v3cs2bj_broad_jump_x <- model.matrix(broad_jump ~ ., forty_vertical_three_cone_shuttle_2_broad_jump)
f2v3cs2bj_broad_jump_y <- forty_vertical_three_cone_shuttle_2_broad_jump$broad_jump
f2v3cs2bj_broad_jump_x 
mean(f2v3cs2bj_broad_jump_y)

set.seed(2)
f2v3cs2bj_broad_jump_train <- sample(1:nrow(f2v3cs2bj_broad_jump_x), .8*nrow(f2v3cs2bj_broad_jump_x))
f2v3cs2bj_broad_jump_test <- (-f2v3cs2bj_broad_jump_train)
f2v3cs2bj_broad_jump_y.test <- f2v3cs2bj_broad_jump_y[f2v3cs2bj_broad_jump_test]

grid <- 10^seq(-5, 5, length = 100)

f2v3cs2bj_broad_jump_lasso.mod <- glmnet(f2v3cs2bj_broad_jump_x[f2v3cs2bj_broad_jump_train, ], f2v3cs2bj_broad_jump_y[f2v3cs2bj_broad_jump_train], alpha = 1,
    lambda = grid,intercept = TRUE ,standardize = TRUE)
plot(f2v3cs2bj_broad_jump_lasso.mod)

set.seed(1)
f2v3cs2bj_broad_jump_cv.out <- cv.glmnet(f2v3cs2bj_broad_jump_x[f2v3cs2bj_broad_jump_train, ], f2v3cs2bj_broad_jump_y[f2v3cs2bj_broad_jump_train], alpha = 1)
#plot(f2v3cs2bj_broad_jump_cv.out)
f2v3cs2bj_broad_jump_bestlam <- f2v3cs2bj_broad_jump_cv.out$lambda.min
#f2v3cs2bj_broad_jump_bestlam <- 1
f2v3cs2bj_broad_jump_lasso.pred <- predict(f2v3cs2bj_broad_jump_lasso.mod, s = f2v3cs2bj_broad_jump_bestlam,
    newx = f2v3cs2bj_broad_jump_x[f2v3cs2bj_broad_jump_test, ])
mean((f2v3cs2bj_broad_jump_lasso.pred - f2v3cs2bj_broad_jump_y.test)^2)

f2v3cs2bj_broad_jump_out <- glmnet(f2v3cs2bj_broad_jump_x, f2v3cs2bj_broad_jump_y, alpha = 1, lambda = f2v3cs2bj_broad_jump_bestlam )
coef(f2v3cs2bj_broad_jump_out)
f2v3cs2bj_broad_jump_lasso.coef <- predict(f2v3cs2bj_broad_jump_out, type = "coefficients",
    s = f2v3cs2bj_broad_jump_bestlam)[1:(ncol(forty_vertical_three_cone_shuttle_2_broad_jump)+1), ]
f2v3cs2bj_broad_jump_lasso.coef
f2v3cs2bj_broad_jump_lasso.coef[f2v3cs2bj_broad_jump_lasso.coef != 0]

ggplot(forty_vertical_three_cone_shuttle_2_broad_jump[-f2v3cs2bj_broad_jump_train,] %>% mutate(pred = f2v3cs2bj_broad_jump_lasso.pred),
       aes(x = pred, broad_jump)) +
  geom_point()



f2v3cs2bj_broad_jump_x_scale <- model.matrix(scale(broad_jump) ~ scale(three_cone) + scale(shuttle), forty_vertical_three_cone_shuttle_2_broad_jump)
f2v3cs2bj_broad_jump_y_scale <- (forty_vertical_three_cone_shuttle_2_broad_jump %>% mutate(broad_jump = scale(broad_jump)))$broad_jump

set.seed(2)
f2v3cs2bj_broad_jump_train <- sample(1:nrow(f2v3cs2bj_broad_jump_x_scale), .8*nrow(f2v3cs2bj_broad_jump_x_scale))
f2v3cs2bj_broad_jump_test <- (-f2v3cs2bj_broad_jump_train)
f2v3cs2bj_broad_jump_y.test_scale <- f2v3cs2bj_broad_jump_y_scale[f2v3cs2bj_broad_jump_test]

f2v3cs2bj_broad_jump_lasso.mod_scale <- glmnet(f2v3cs2bj_broad_jump_x_scale[f2v3cs2bj_broad_jump_train, ], f2v3cs2bj_broad_jump_y_scale[f2v3cs2bj_broad_jump_train], alpha = 1,
    lambda = grid,intercept = TRUE ,standardize = TRUE)

set.seed(1)
f2v3cs2bj_broad_jump_cv.out_scale <- cv.glmnet(f2v3cs2bj_broad_jump_x_scale[f2v3cs2bj_broad_jump_train, ], f2v3cs2bj_broad_jump_y_scale[f2v3cs2bj_broad_jump_train], alpha = 1)
#plot(f2v3cs2bj_broad_jump_cv.out)
f2v3cs2bj_broad_jump_bestlam_scale <- f2v3cs2bj_broad_jump_cv.out_scale$lambda.min
#f2v3cs2bj_broad_jump_bestlam <- 1
f2v3cs2bj_broad_jump_lasso.pred_scale <- predict(f2v3cs2bj_broad_jump_lasso.mod_scale, s = f2v3cs2bj_broad_jump_bestlam_scale,
    newx = f2v3cs2bj_broad_jump_x_scale[f2v3cs2bj_broad_jump_test, ])
mean((f2v3cs2bj_broad_jump_lasso.pred_scale - f2v3cs2bj_broad_jump_y.test_scale)^2)
```

# Use forty, vertical, three cone and shuttle to predict broad jump
```{r}
update19 <- update18 %>% mutate(broad_jump = if_else(
                           !is.na(forty) & !is.na(vertical) & !is.na(three_cone) & !is.na(shuttle) & is.na(broad_jump),
                           f2v3cs2bj_broad_jump_lasso.coef[f2v3cs2bj_broad_jump_lasso.coef != 0][1] +
                             f2v3cs2bj_broad_jump_lasso.coef[f2v3cs2bj_broad_jump_lasso.coef != 0][2] * height +
                             f2v3cs2bj_broad_jump_lasso.coef[f2v3cs2bj_broad_jump_lasso.coef != 0][3] * forty +
                             f2v3cs2bj_broad_jump_lasso.coef[f2v3cs2bj_broad_jump_lasso.coef != 0][4] * vertical +
                             f2v3cs2bj_broad_jump_lasso.coef[f2v3cs2bj_broad_jump_lasso.coef != 0][5] * shuttle +
                             f2v3cs2bj_broad_jump_lasso.coef[f2v3cs2bj_broad_jump_lasso.coef != 0][6] * G +
                             f2v3cs2bj_broad_jump_lasso.coef[f2v3cs2bj_broad_jump_lasso.coef != 0][7] * Rec +
                             f2v3cs2bj_broad_jump_lasso.coef[f2v3cs2bj_broad_jump_lasso.coef != 0][8] * TotAvg,
                           broad_jump
                         )) 
```


# Use forty, broad jump, three_cone and shuttle to predict vertical
```{r}
forty_broad_jump_three_cone_shuttle_2_vertical <- combinecollege %>% select(-player) %>% 
  filter(!is.na(forty) & !is.na(broad_jump) & !is.na(three_cone) & !is.na(shuttle) & !is.na(vertical))


fbj3cs2v_vertical_x <- model.matrix(vertical ~ ., forty_broad_jump_three_cone_shuttle_2_vertical)
fbj3cs2v_vertical_y <- forty_broad_jump_three_cone_shuttle_2_vertical$vertical
fbj3cs2v_vertical_x 
mean(fbj3cs2v_vertical_y)

set.seed(2)
fbj3cs2v_vertical_train <- sample(1:nrow(fbj3cs2v_vertical_x), .8*nrow(fbj3cs2v_vertical_x))
fbj3cs2v_vertical_test <- (-fbj3cs2v_vertical_train)
fbj3cs2v_vertical_y.test <- fbj3cs2v_vertical_y[fbj3cs2v_vertical_test]

grid <- 10^seq(-5, 5, length = 100)

fbj3cs2v_vertical_lasso.mod <- glmnet(fbj3cs2v_vertical_x[fbj3cs2v_vertical_train, ], fbj3cs2v_vertical_y[fbj3cs2v_vertical_train], alpha = 1,
    lambda = grid,intercept = TRUE ,standardize = TRUE)
plot(fbj3cs2v_vertical_lasso.mod)

set.seed(1)
fbj3cs2v_vertical_cv.out <- cv.glmnet(fbj3cs2v_vertical_x[fbj3cs2v_vertical_train, ], fbj3cs2v_vertical_y[fbj3cs2v_vertical_train], alpha = 1)
#plot(fbj3cs2v_vertical_cv.out)
fbj3cs2v_vertical_bestlam <- fbj3cs2v_vertical_cv.out$lambda.min
#fbj3cs2v_vertical_bestlam <- 1
fbj3cs2v_vertical_lasso.pred <- predict(fbj3cs2v_vertical_lasso.mod, s = fbj3cs2v_vertical_bestlam,
    newx = fbj3cs2v_vertical_x[fbj3cs2v_vertical_test, ])
mean((fbj3cs2v_vertical_lasso.pred - fbj3cs2v_vertical_y.test)^2)

fbj3cs2v_vertical_out <- glmnet(fbj3cs2v_vertical_x, fbj3cs2v_vertical_y, alpha = 1, lambda = fbj3cs2v_vertical_bestlam )
coef(fbj3cs2v_vertical_out)
fbj3cs2v_vertical_lasso.coef <- predict(fbj3cs2v_vertical_out, type = "coefficients",
    s = fbj3cs2v_vertical_bestlam)[1:(ncol(forty_broad_jump_three_cone_shuttle_2_vertical)+1), ]
fbj3cs2v_vertical_lasso.coef
fbj3cs2v_vertical_lasso.coef[fbj3cs2v_vertical_lasso.coef != 0]

ggplot(forty_broad_jump_three_cone_shuttle_2_vertical[-fbj3cs2v_vertical_train,] %>% mutate(pred = fbj3cs2v_vertical_lasso.pred),
       aes(x = pred, vertical)) +
  geom_point()



fbj3cs2v_vertical_x_scale <- model.matrix(scale(vertical) ~ scale(three_cone) + scale(shuttle), forty_broad_jump_three_cone_shuttle_2_vertical)
fbj3cs2v_vertical_y_scale <- (forty_broad_jump_three_cone_shuttle_2_vertical %>% mutate(vertical = scale(vertical)))$vertical

set.seed(2)
fbj3cs2v_vertical_train <- sample(1:nrow(fbj3cs2v_vertical_x_scale), .8*nrow(fbj3cs2v_vertical_x_scale))
fbj3cs2v_vertical_test <- (-fbj3cs2v_vertical_train)
fbj3cs2v_vertical_y.test_scale <- fbj3cs2v_vertical_y_scale[fbj3cs2v_vertical_test]

fbj3cs2v_vertical_lasso.mod_scale <- glmnet(fbj3cs2v_vertical_x_scale[fbj3cs2v_vertical_train, ], fbj3cs2v_vertical_y_scale[fbj3cs2v_vertical_train], alpha = 1,
    lambda = grid,intercept = TRUE ,standardize = TRUE)

set.seed(1)
fbj3cs2v_vertical_cv.out_scale <- cv.glmnet(fbj3cs2v_vertical_x_scale[fbj3cs2v_vertical_train, ], fbj3cs2v_vertical_y_scale[fbj3cs2v_vertical_train], alpha = 1)
#plot(fbj3cs2v_vertical_cv.out)
fbj3cs2v_vertical_bestlam_scale <- fbj3cs2v_vertical_cv.out_scale$lambda.min
#fbj3cs2v_vertical_bestlam <- 1
fbj3cs2v_vertical_lasso.pred_scale <- predict(fbj3cs2v_vertical_lasso.mod_scale, s = fbj3cs2v_vertical_bestlam_scale,
    newx = fbj3cs2v_vertical_x_scale[fbj3cs2v_vertical_test, ])
mean((fbj3cs2v_vertical_lasso.pred_scale - fbj3cs2v_vertical_y.test_scale)^2)
```

# Use forty, broad jump, three cone and shuttle to predict vertical
```{r}
update20 <- update19 %>% mutate(vertical = if_else(
                           !is.na(forty) & is.na(vertical) & !is.na(three_cone) & !is.na(shuttle) & !is.na(broad_jump),
                           fbj3cs2v_vertical_lasso.coef[fbj3cs2v_vertical_lasso.coef != 0][1] +
                             fbj3cs2v_vertical_lasso.coef[fbj3cs2v_vertical_lasso.coef != 0][2] * height +
                             fbj3cs2v_vertical_lasso.coef[fbj3cs2v_vertical_lasso.coef != 0][3] * forty +
                             fbj3cs2v_vertical_lasso.coef[fbj3cs2v_vertical_lasso.coef != 0][4] * broad_jump +
                             fbj3cs2v_vertical_lasso.coef[fbj3cs2v_vertical_lasso.coef != 0][5] * three_cone +
                             fbj3cs2v_vertical_lasso.coef[fbj3cs2v_vertical_lasso.coef != 0][6] * shuttle,
                           vertical
                         )) 
```

# Use vertical, broad jump, three_cone and shuttle to predict forty
```{r}
vertical_broad_jump_three_cone_shuttle_2_forty <- combinecollege %>% select(-player) %>% 
  filter(!is.na(vertical) & !is.na(broad_jump) & !is.na(three_cone) & !is.na(shuttle) & !is.na(forty))


vbj3cs2f_forty_x <- model.matrix(forty ~ ., vertical_broad_jump_three_cone_shuttle_2_forty)
vbj3cs2f_forty_y <- vertical_broad_jump_three_cone_shuttle_2_forty$forty
vbj3cs2f_forty_x 
mean(vbj3cs2f_forty_y)

set.seed(2)
vbj3cs2f_forty_train <- sample(1:nrow(vbj3cs2f_forty_x), .8*nrow(vbj3cs2f_forty_x))
vbj3cs2f_forty_test <- (-vbj3cs2f_forty_train)
vbj3cs2f_forty_y.test <- vbj3cs2f_forty_y[vbj3cs2f_forty_test]

grid <- 10^seq(-5, 5, length = 100)

vbj3cs2f_forty_lasso.mod <- glmnet(vbj3cs2f_forty_x[vbj3cs2f_forty_train, ], vbj3cs2f_forty_y[vbj3cs2f_forty_train], alpha = 1,
    lambda = grid,intercept = TRUE ,standardize = TRUE)
plot(vbj3cs2f_forty_lasso.mod)

set.seed(1)
vbj3cs2f_forty_cv.out <- cv.glmnet(vbj3cs2f_forty_x[vbj3cs2f_forty_train, ], vbj3cs2f_forty_y[vbj3cs2f_forty_train], alpha = 1)
#plot(vbj3cs2f_forty_cv.out)
vbj3cs2f_forty_bestlam <- vbj3cs2f_forty_cv.out$lambda.min
#vbj3cs2f_forty_bestlam <- 1
vbj3cs2f_forty_lasso.pred <- predict(vbj3cs2f_forty_lasso.mod, s = vbj3cs2f_forty_bestlam,
    newx = vbj3cs2f_forty_x[vbj3cs2f_forty_test, ])
mean((vbj3cs2f_forty_lasso.pred - vbj3cs2f_forty_y.test)^2)

vbj3cs2f_forty_out <- glmnet(vbj3cs2f_forty_x, vbj3cs2f_forty_y, alpha = 1, lambda = vbj3cs2f_forty_bestlam )
coef(vbj3cs2f_forty_out)
vbj3cs2f_forty_lasso.coef <- predict(vbj3cs2f_forty_out, type = "coefficients",
    s = vbj3cs2f_forty_bestlam)[1:(ncol(vertical_broad_jump_three_cone_shuttle_2_forty)+1), ]
vbj3cs2f_forty_lasso.coef
vbj3cs2f_forty_lasso.coef[vbj3cs2f_forty_lasso.coef != 0]

ggplot(vertical_broad_jump_three_cone_shuttle_2_forty[-vbj3cs2f_forty_train,] %>% mutate(pred = vbj3cs2f_forty_lasso.pred),
       aes(x = pred, forty)) +
  geom_point()



vbj3cs2f_forty_x_scale <- model.matrix(scale(forty) ~ scale(three_cone) + scale(shuttle), vertical_broad_jump_three_cone_shuttle_2_forty)
vbj3cs2f_forty_y_scale <- (vertical_broad_jump_three_cone_shuttle_2_forty %>% mutate(forty = scale(forty)))$forty

set.seed(2)
vbj3cs2f_forty_train <- sample(1:nrow(vbj3cs2f_forty_x_scale), .8*nrow(vbj3cs2f_forty_x_scale))
vbj3cs2f_forty_test <- (-vbj3cs2f_forty_train)
vbj3cs2f_forty_y.test_scale <- vbj3cs2f_forty_y_scale[vbj3cs2f_forty_test]

vbj3cs2f_forty_lasso.mod_scale <- glmnet(vbj3cs2f_forty_x_scale[vbj3cs2f_forty_train, ], vbj3cs2f_forty_y_scale[vbj3cs2f_forty_train], alpha = 1,
    lambda = grid,intercept = TRUE ,standardize = TRUE)

set.seed(1)
vbj3cs2f_forty_cv.out_scale <- cv.glmnet(vbj3cs2f_forty_x_scale[vbj3cs2f_forty_train, ], vbj3cs2f_forty_y_scale[vbj3cs2f_forty_train], alpha = 1)
#plot(vbj3cs2f_forty_cv.out)
vbj3cs2f_forty_bestlam_scale <- vbj3cs2f_forty_cv.out_scale$lambda.min
#vbj3cs2f_forty_bestlam <- 1
vbj3cs2f_forty_lasso.pred_scale <- predict(vbj3cs2f_forty_lasso.mod_scale, s = vbj3cs2f_forty_bestlam_scale,
    newx = vbj3cs2f_forty_x_scale[vbj3cs2f_forty_test, ])
mean((vbj3cs2f_forty_lasso.pred_scale - vbj3cs2f_forty_y.test_scale)^2)
```

# Use vertical, broad jump, three cone and shuttle to predict forty
```{r}
allpredicted <- update20 %>% mutate(forty = if_else(
                           is.na(forty) & !is.na(vertical) & !is.na(three_cone) & !is.na(shuttle) & !is.na(broad_jump),
                           vbj3cs2f_forty_lasso.coef[vbj3cs2f_forty_lasso.coef != 0][1] +
                             vbj3cs2f_forty_lasso.coef[vbj3cs2f_forty_lasso.coef != 0][2] * height +
                             vbj3cs2f_forty_lasso.coef[vbj3cs2f_forty_lasso.coef != 0][3] * weight +
                             vbj3cs2f_forty_lasso.coef[vbj3cs2f_forty_lasso.coef != 0][4] * vertical +
                             vbj3cs2f_forty_lasso.coef[vbj3cs2f_forty_lasso.coef != 0][5] * broad_jump +
                             vbj3cs2f_forty_lasso.coef[vbj3cs2f_forty_lasso.coef != 0][6] * three_cone +
                             vbj3cs2f_forty_lasso.coef[vbj3cs2f_forty_lasso.coef != 0][7] * Rec +
                             vbj3cs2f_forty_lasso.coef[vbj3cs2f_forty_lasso.coef != 0][8] * RecAvg +
                             vbj3cs2f_forty_lasso.coef[vbj3cs2f_forty_lasso.coef != 0][9] * RushYds +
                             vbj3cs2f_forty_lasso.coef[vbj3cs2f_forty_lasso.coef != 0][10] * RushTD +
                             vbj3cs2f_forty_lasso.coef[vbj3cs2f_forty_lasso.coef != 0][11] * as.numeric(ConfIndicator),
                           forty
                         )) 
```


```{r}
view(allpredicted[rowSums(is.na(allpredicted)) > 0, ])
```

